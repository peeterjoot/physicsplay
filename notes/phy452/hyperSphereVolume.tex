%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{hyperSphereVolume}
%\renewcommand{\dirname}{notes/phy452/}
%%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{hypersphere, volume, Jacobian, Euclidean space, Minkowski space, Geometric Algebra, Gamma function}
%
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{Hypersphere volume calculation the easy way}
\label{chap:hyperSphereVolume}
\paragraph{Motivation}

In \cref{basicStatMech:problemSet3:1} I solved the hypersphere volume problem the hard way.  I did it the way that I thought was obvious, starting with the spherical coordinate hypervolume element for an Euclidean space.  That build on the volume element calculation I'd previously done for four dimensional Euclidean and Hyperbolic spaces in \citep{gabookI:nvolume}.  This time I avoided any use of Geometric Algebra and wrote out the volume element directly using a Jacobian transformation instead of a wedge product (that leads to the same Jacobian).  I then proceeded to integrate the volume element, come up with a recurrence relation for the volume, solve that for even and odd powers, and find a common expression using Gamma functions that was correct for even and odd powers.  It was a laborious process, but satisfying since I'd previously tried this calculation and not succeeded.

As and after I did this calculation, I figured there had to have been an easier way.  In the midterm prep reading of \S 5.5 of \citep{ma1985statistical} I found just that method.  It's done there in about six lines, using a trick that seemed really sneaky!  I was left with a frustrated feeling, wondering how on earth somebody figured out to do it that way.

After a bit of reflection, I see that the trick is a very sensible approach.  I'll outline that here for 2 and 3 dimensions to show the technique, and the reader can generalize if desired.

\paragraph{The trick}

Switching to spherical or circular coordinates when there is radial symmetry isn't anything that we could describe as trickery.  For example, with \(r^2 = x^2 + y^2\) in a two dimensional problem or \(r^2 = x^2 + y^2 + z^2\) in a three dimensional problem, it's clear that we'd do the following respectively if we were evaluating an integral

\begin{subequations}
\label{eqn:hyperSphereVolume:10}
\begin{equation}\label{eqn:hyperSphereVolume:20}
\iint f(r) dx dy = \iint f(r) r dr d\theta = 2 \pi \int f(r) r dr
\end{equation}
\begin{equation}\label{eqn:hyperSphereVolume:40}
\iiint f(r) dx dy = \iiint f(r) r^2 dr \sin d\theta d\theta d\phi = 4 \pi \int f(r) r^2 dr
\end{equation}
\end{subequations}

In fact, for \(f(r) = 1\) these give us the area and volume of the circle and sphere respectively.

So, what's the trick?  The first part is the observation that the ``area'' of a ``volume'' for the circle and the sphere are found by the derivatives of the ``volumes''

\begin{subequations}
\begin{equation}\label{eqn:hyperSphereVolume:60}
\frac{d}{dr} \pi r^2 = 2 \pi r
\end{equation}
\begin{equation}\label{eqn:hyperSphereVolume:80}
\frac{d}{dr} \frac{4 \pi}{3} r^3 = 4 \pi r^2.
\end{equation}
\end{subequations}

I recall being surprised that this is the case back in high school calculus.  When I lost marks for not having the formula for the surface area of a sphere memorized on some test, my calculus teacher told me this title tidbit.

Back then this wasn't obvious to me, and I complained that it was true only for the perfect symmetry of a sphere.  For example, the derivative of an volume of a cube doesn't give the surface area of a cube (\(d x^3/dx = 3 x^2 \ne 6 x^2\)).

Once we believe or assume that the surface ``area'' of a hypervolume is the derivative of the volume, we can proceed with the trick.  That trick is to express the volume in terms of an unknown constant.  For example, for the circle and sphere the generalized ``volume''s are respectively

\begin{subequations}
\begin{equation}\label{eqn:hyperSphereVolume:100}
V_2 = B r^2
\end{equation}
\begin{equation}\label{eqn:hyperSphereVolume:120}
V_3 = C r^3
\end{equation}
\end{subequations}

The perimeter of the circle and surface area of the sphere are then

\begin{subequations}
\begin{equation}\label{eqn:hyperSphereVolume:140}
A_2 = 2 B r
\end{equation}
\begin{equation}\label{eqn:hyperSphereVolume:160}
A_3 = 3 C r^2
\end{equation}
\end{subequations}

So, if we want to calculate integrals of the form \eqnref{eqn:hyperSphereVolume:10} we can write

\begin{subequations}
\begin{equation}\label{eqn:hyperSphereVolume:20a}
\iint f(r) dx dy = 2 B \int f(r) r dr
\end{equation}
\begin{equation}\label{eqn:hyperSphereVolume:40b}
\iiint f(r) dx dy = 3 C \int f(r) r^2 dr.
\end{equation}
\end{subequations}

The essence of the trick is to do such an integral in both Cartesian coordinates to get the left hand sides, and then do the radial right hand side integrals.  Comparing these provides the constants \(B\) and \(C\) and thus completes the ``volume'' formulas for the circle and sphere.

The function chosen for this integral in the text was a Gaussian exponential \(f(r) = e^{-r^2/2}\), something that is strictly radial, and can be integrated over all space.  For the 2D case, we'll integrate

\begin{dmath}\label{eqn:hyperSphereVolume:180}
\iint e^{-(x^2 +y^2)/2} dx dy = (\sqrt{2 \pi})^2
= 2 B \int_0^\infty dr r e^{-r^2/2}
= -2 B 
\evalrange{e^{-r^2/2}}{0}{\infty}
= 2 B.
\end{dmath}

We find that \(B = \pi\), so the 2D spherical ``volume'' (the area of the circle) is \(V = \pi r^2\).

For the 3D sphere, we have

\begin{equation}\label{eqn:hyperSphereVolume:200}
\begin{aligned}
\iiint e^{-(x^2 +y^2 + z^2)/2} dx dy  
&= (\sqrt{2 \pi})^3 \\
&= 3 C \int_0^\infty dr r^2 e^{-r^2/2} \\
&= 3 C \int_0^\infty dr e^{-r^2/2} \\
&= 3 C \sqrt{2 \pi}.
\end{aligned}
\end{equation}

So we have for the volume of the 3D sphere, \(V = 4 \pi r^3/3\) as expected.  

It's also clear that the exponential integral isn't a requirement for this trick.  It's just convienent because boundary value conditions aren't required.  For example, suppose we want to calculate the area of a circle using this trick.  We can do so by integrating

\begin{dmath}\label{eqn:hyperSphereVolume:240}
4 \int_0^r dx \int_0^{\sqrt{r^2 - x^2}} dy (x^2 + y^2) = \int_0^r r^2 2 B r dr
\end{dmath}

The LHS can be integrated using a sine or cosine substitution and then integrating by parts (or by Mathematica as in \nbref{nVolumeTrickToCalculateAreaOfCircle.nb}).  Comparison of the two gives

\begin{dmath}\label{eqn:hyperSphereVolume:260}
4 r^4 \frac{\pi}{8} = 2 B \frac{r^4}{4},
\end{dmath}

So that \(B = \pi\) and \(V_2 = \pi r^2\) as expected.

The same idea can be extended to higher dimensional spheres.  The text does the even values of \(N\).  Treating both even and odd values, this would have to yield the result calculated using the Jacobian volume element method

\begin{dmath}\label{eqn:hyperSphereVolume:220}
V_{m} 
= 
\frac{ \pi^{m/2} R^{m} }
{
   \Gamma\left( m/2 + 1 \right)
}.
\end{dmath}

%\EndArticle
