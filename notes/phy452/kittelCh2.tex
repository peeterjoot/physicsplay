%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
% pick one:
%\input{../assignment.tex}
%\input{../blogpost.tex}
%\renewcommand{\basename}{kittelCh2}
%\renewcommand{\dirname}{notes/phy452/}
%%\newcommand{\dateintitle}{}
%%\newcommand{\keywords}{}
%
%\input{../peeter_prologue_print2.tex}
%
%\renewcommand{\QuestionNB}{\alph{Question}.\ }
%\renewcommand{\theQuestion}{\alph{Question}}
%
%\beginArtNoToc
%
%\generatetitle{Some problems from Kittel Thermal Physics, chapter II}
\label{chap:kittelCh2}
%\section{Motivation}
%
%Some review from the ancient second (or third?) year thermal physics course I took.
%
%\section{Guts}

\makeoproblem{Energy and temperature}{pr:kittelCh2:1}{\citep{kittel1980thermal} problem 2.1}{
Suppose \(g(U) = C U^{3N/2}\), where \(C\) is a constant and \(N\) is the number of particles.  This form of \(g(U)\) actually applies to an ideal gas.

\makesubproblem{Show that \(U = 3 N \tau/2\)}{pr:kittelCh2:1:a}
\makesubproblem{Show that \((\partial^2 \sigma/\partial U^2)_N\) is negative.}{pr:kittelCh2:1:b}

} % makeoproblem

\makeanswer{pr:kittelCh2:1}{

\makeSubAnswer{Temperature}{pr:kittelCh2:1:a}

We've got

\begin{dmath}\label{eqn:kittelCh2:20}
\inv{\tau}
= \PD{U}{\sigma}
= \PD{U}{} \left( \ln C + \frac{3N}{2} \ln U \right)
= \frac{3N}{2} \inv{U},
\end{dmath}

or

\begin{equation}\label{eqn:kittelCh2:40}
U = \frac{3N}{2} \tau.
\end{equation}

\makeSubAnswer{Second derivative of entropy}{pr:kittelCh2:1:b}

From above

\begin{equation}\label{eqn:kittelCh2:60}
\frac{\partial^2 \sigma}{\partial U^2}
= -\frac{3N}{2} \inv{U^2}.
\end{equation}

This doesn't seem particularly surprising if we look at the plots.  For example for \(C = 1\) and \(3N/2 = 1\) we have \cref{fig:kittelCh2:kittelCh2Fig1}.

\imageFigure{../../figures/phy452/kittelCh2Fig1}{Plots of entropy and its derivatives for this multiplicity function}{fig:kittelCh2:kittelCh2Fig1}{0.3}

The rate of change of entropy with energy decreases monotonically and is always positive, but always has a negative slope.

} % makeanswer

\makeoproblem{Paramagnetism}{pr:kittelCh2:2}{\citep{kittel1980thermal} problem 2.2}{
Find the equilibrium value at temperature \(\tau\) of the fractional magnetization

\begin{equation}\label{eqn:kittelCh2:200}
\frac{M}{N m} = \frac{2 \expectation{s}}{N}
\end{equation}

of the system of \(N\) spins each of magnetic moment \(m\) in a magnetic field \(B\).  The spin excess is \(2 s\).  Take the entropy as the logarithm of the multiplicity \(g(N, s)\) as given in (1.35):

\begin{equation}\label{eqn:kittelCh2:220}
\sigma(s) \approx \ln g(N, 0) - \frac{2 s^2}{N},
\end{equation}

for \(\Abs{s} \ll N\).  Hint: Show that in this approximation

\begin{equation}\label{eqn:kittelCh2:240}
\sigma(U) = \sigma_0 - \frac{U^2}{2 m^2 B^2 N},
\end{equation}

with \(\sigma_0 = \ln g(N, 0)\).  Further, show that \(1/\tau = - U/ (m^2 B^2 N)\), where \(U\) denotes \(\expectation{U}\), the thermal average energy.
} % makeoproblem

\makeanswer{pr:kittelCh2:2}{

I found this problem very hard to interpret.  What exactly is being asked for?  Equation (1.35) in the text was

\begin{subequations}
\begin{equation}\label{eqn:kittelCh2:260}
g(N, s) \approx g(N, 0) e^{-\frac{2s^2}{N}}
\end{equation}
\begin{equation}\label{eqn:kittelCh2:280}
g(N, 0) \approx \sqrt{ \frac{2}{\pi N}} 2^N,
\end{equation}
\end{subequations}

from which we find the entropy \eqnref{eqn:kittelCh2:220} directly after taking logarithms.  The temperature is found directly

The magnetization, for a system that has spin excess \(2 s\) was defined as

\begin{equation}\label{eqn:kittelCh2:300}
U = -2 s m B \equiv - M B
\end{equation}

and we can substitute that for \(s\)

\begin{equation}\label{eqn:kittelCh2:320}
\sigma(U) = \sigma_0 - \frac{U^2}{2 m^2 B^2 N},
\end{equation}

and take derivatives for the temperature

\begin{dmath}\label{eqn:kittelCh2:340}
\inv{\tau}
= \PD{U}{\sigma}
= \PD{U}{}
\left(
\sigma_0 - \frac{U^2}{2 m^2 B^2 N} \right)
=
- \frac{U}{m^2 B^2 N}
\end{dmath}

This gives us a relation between temperature and the energy of the system with spin excess \(2 s\), and we could write

\begin{equation}\label{eqn:kittelCh2:360}
\frac{M}{N m} = -\frac{U}{B N m} = \frac{m B}{\tau}.
\end{equation}

Is this the relation that this problem was asking for?

Two things I don't understand from this problem:

\begin{enumerate}
\item Where does \(2 \expectation{s}/N\) come from?  If we calculate the expectation of the spin excess, we find that it is zero

\begin{dmath}\label{eqn:kittelCh2:380}
\expectation{2 s} = \frac{ \sqrt{ \frac{2}{\pi N}} 2^N \int_{-\infty}^\infty
ds 2 s
e^{-\frac{2s^2}{N}}
}
{
2^N
}
=0.
\end{dmath}

\item If \(2 \expectation{s}\) has a non-zero value, then doesn't that make \(\expectation{U}\) also zero?  It seems to me that \(U\) in \eqnref{eqn:kittelCh2:340} is the energy of a system with spin excess \(s\), and not any sort of average energy?
\end{enumerate}

} % makeanswer

\makeoproblem{Quantum harmonic oscillator}{pr:kittelCh2:3}{\citep{kittel1980thermal} problem 2.3}{

\makesubproblem{Entropy.}{pr:kittelCh2:3a}  Find the entropy of a set of \(N\) oscillators of frequency \(\omega\) as a function of the total quantum number \(n\).  Use the multiplicity function (1.55) and make the Stirling approximation \(\ln N! \approx N \ln N - N\).  Replace \(N - 1\) by \(N\).

\makesubproblem{Planck Energy.}{pr:kittelCh2:3b}  Let \(U\) denote the total energy \(n \Hbar \omega\) of the oscillators.  Express the entropy as \(\sigma(U, N)\).  Show that the total energy at temperature \(\tau\) is

\begin{equation}\label{eqn:kittelCh2:80}
U = \frac{N \Hbar \omega}{\exp\left( \Hbar \omega/\tau \right) -1}
\end{equation}

This is the Planck result;  it is derived again in Chapter \(4\) by a powerful method that does not require us to find the multiplicity function.

} % makeoproblem

\makeanswer{pr:kittelCh2:3}{
\makeSubAnswer{Entropy}{pr:kittelCh2:3a}

The multiplicity was found in the text to be

\begin{equation}\label{eqn:kittelCh2:100}
g(N, n) = \frac{(N + n -1)!}{n! (N-1)!}
\end{equation}

I wasn't actually able to follow the argument in the text, and found the purely combinatoric wikipedia argument \citep{wiki:einsteinSolid} much clearer.  A similar diagram and argument can also be found in \citep{pathriastatistical} \S 3.8.

Taking logarithms and applying the Stirling approximation, our entropy is

\begin{dmath}\label{eqn:kittelCh2:120}
\sigma
= \ln g
= \ln (N + n - 1)!  - \ln (N - 1)!  - \ln n!
\approx
(N + n - 1) \ln (N + n - 1) - (N + n - 1)
- (N  - 1) \ln (N  - 1) + (N  - 1)
- n \ln n + n
=
(N - 1) \ln \frac{N + n - 1}{N - 1}
+ n \ln \frac{N + n - 1}{n}
\end{dmath}

\makeSubAnswer{Planck Energy}{pr:kittelCh2:3b}

Now we make the \(N - 1 \rightarrow N\) replacement suggested in the problem (ie. assuming \(N \gg 1\)), for

\begin{dmath}\label{eqn:kittelCh2:140}
\sigma
\approx
N \ln \frac{N + n}{N}
+ n \ln \frac{N + n}{n}
=
(N + n)\ln (N + n) - N \ln N - n \ln n
=
\left(N + \frac{U}{\Hbar\omega} \right)\ln \left(N + \frac{U}{\Hbar\omega} \right) - N \ln N - \frac{U}{\Hbar\omega} \ln \frac{U}{\Hbar\omega}
\end{dmath}

With \((x \ln x)' = \ln x + 1\), we have

\begin{dmath}\label{eqn:kittelCh2:160}
\inv{\tau}
= \PD{U}{\sigma}
=
\inv{\Hbar\omega} \left( \ln \left(N + \frac{U}{\Hbar\omega} \right) - 1 -\ln \frac{U}{\Hbar\omega} + 1 \right),
\end{dmath}

or
\begin{equation}\label{eqn:kittelCh2:180}
U e^{\frac{\Hbar \omega}{\tau}} = N \Hbar \omega + U.
\end{equation}

A final rearrangement gives us the Planck result \eqnref{eqn:kittelCh2:80}.
} % makeanswer

% this is to produce the sites.google url and version info and so forth (for blog posts)
%\vcsinfo
%\EndArticle
