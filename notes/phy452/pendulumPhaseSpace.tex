%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{pendulumPhaseSpace}
%\renewcommand{\dirname}{notes/phy452/}
%\newcommand{\keywords}{Statistical mechanics, PHY452H1S, phase space, trajectory, pendulum, small angle, Hamiltonian, conjugate momentum, angular momentum}
%
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{1D pendulum problem in phase space}
%\chapter{1D pendulum problem in phase space}
%\label{chap:pendulumPhaseSpace}

\makeoproblem{Small angle pendulum phase space}{pr:pendulumPhaseSpace:1}{\citep{pathriastatistical} problem 2.6}
{ 
Analyze the (presumably small angle) pendulum problem in phase space.  Also show that the phase space area \(A\) contained in the trajectory relates the energy and period of the system.
} % makeoproblem

\makeanswer{pr:pendulumPhaseSpace:1}{ 
With coordinates as in \cref{fig:pendulumPhaseSpace:pendulumPhaseSpaceFig1}, our Lagrangian is

\imageFigure{../../figures/phy452/pendulumPhaseSpaceFig1}{1d pendulum}{fig:pendulumPhaseSpace:pendulumPhaseSpaceFig1}{0.3}

\begin{equation}\label{eqn:pendulumPhaseSpace:20}
\LL = \inv{2} m l^2 \thetadot^2 - g m l ( 1 - \cos\theta ).
\end{equation}

As a sign check we find for small \(\theta\) from the Euler-Lagrange equations \(\ddot{\theta} = -(g/l) \theta\) as expected.  For the Hamiltonian, we need the canonical momentum

\begin{equation}\label{eqn:pendulumPhaseSpace:40}
p_\theta = \PD{\thetadot}{\LL} = m l^2 \thetadot.
\end{equation}

Observe that this canonical momentum does not have dimensions of momentum, but that of angular momentum (\(m l \thetadot \times l\)).

Our Hamiltonian is

\begin{equation}\label{eqn:pendulumPhaseSpace:60}
H = \inv{2 m l^2} p_\theta^2 + g m l ( 1 - \cos\theta ).
\end{equation}

Hamilton's equations for this system, in matrix form are

\begin{equation}\label{eqn:pendulumPhaseSpace:80}
\ddt{}
\begin{bmatrix}
\theta \\
p_\theta
\end{bmatrix}
=
\begin{bmatrix}
\PD{p_\theta}{H} \\
-\PD{\theta}{H} 
\end{bmatrix}
=
\begin{bmatrix}
p_\theta/m l^2 \\
- g m l \sin\theta
\end{bmatrix}
\end{equation}

With \(\omega = g/l\), it is convenient to non-dimensionalize this

\begin{equation}\label{eqn:pendulumPhaseSpace:100}
\ddt{}
\begin{bmatrix}
\theta \\
p_\theta/ \omega m l^2
\end{bmatrix}
=
\omega
\begin{bmatrix}
p_\theta/\omega m l^2 \\
- \sin\theta
\end{bmatrix}.
\end{equation}

Now we can make the small angle approximation.  Writing

\begin{subequations}
\begin{equation}\label{eqn:pendulumPhaseSpace:120}
\Bu = \begin{bmatrix}
\theta \\
p_\theta/ \omega m l^2
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:pendulumPhaseSpace:140}
i = 
\begin{bmatrix}
0 & 1 \\
-1 & 0
\end{bmatrix}
\end{equation}
\end{subequations}

Our pendulum equation is reduced to

\begin{equation}\label{eqn:pendulumPhaseSpace:160}
\Bu' = i \omega \Bu,
\end{equation}

With a solution that we can read off by inspection

\begin{equation}\label{eqn:pendulumPhaseSpace:180}
\Bu 
= e^{i \omega t} \Bu_0
=
\begin{bmatrix}
\cos\omega t & \sin\omega t \\
-\sin\omega t & \cos \omega t
\end{bmatrix}
\Bu_0
\end{equation}

Let's put the initial phase space point into polar form

\begin{dmath}\label{eqn:pendulumPhaseSpace:200}
\Bu_0^2
= \theta_0^2 + \frac{p_0^2}{\omega^2 m^2 l^4}
= 
\frac{2}{\omega^2 m l^2}
\lr{ \frac{p_0^2}{2 m l^2} + \inv{2} \omega^2 m l^2 \theta_0^2 }
=
\frac{2}{g m l}
\lr{ \frac{p_0^2}{2 m l^2} + \inv{2} g m l \theta_0^2 }
\end{dmath}

This doesn't appear to be an exact match for \eqnref{eqn:pendulumPhaseSpace:60}, but we can write for small \(\theta_0\)

\begin{dmath}\label{eqn:pendulumPhaseSpace:220}
1 - \cos\theta_0
=
2 \sin^2 \lr{ \frac{\theta_0}{2} }
\approx
2 \lr{ \frac{\theta_0}{2} }^2
=
\frac{\theta_0^2}{2}.
\end{dmath}

This shows that we can rewrite our initial conditions as

\begin{equation}\label{eqn:pendulumPhaseSpace:240}
\Bu_0 = 
\sqrt{ \frac{2 E}{g m l} }
e^{i \phi }
\begin{bmatrix}
1 \\ 
0
\end{bmatrix},
\end{equation}

where 

\begin{equation}\label{eqn:pendulumPhaseSpace:260}
\tan \phi =
\lr{ \omega m l^2 \theta_0/ p_0 }.
\end{equation}

Our time evolution in phase space is given by

\begin{equation}\label{eqn:pendulumPhaseSpace:280b}
\begin{bmatrix}
\theta(t) \\
p_\theta(t)
\end{bmatrix}
=
\sqrt{ \frac{2 E}{g m l} }
\begin{bmatrix}
\cos(\omega t + \phi) \\
-
 \omega m l^2
\sin(\omega t + \phi)
\end{bmatrix},
\end{equation}

or

\boxedEquation{eqn:pendulumPhaseSpace:280}{
\begin{bmatrix}
\theta(t) \\
p_\theta(t)
\end{bmatrix}
=
\inv{\omega l}
\sqrt{ \frac{2 E}{m} }
\begin{bmatrix}
\cos(\omega t + \phi) \\
-
 \omega m l^2
\sin(\omega t + \phi)
\end{bmatrix}.
}

This is plotted in \cref{fig:pendulumPhaseSpace:pendulumPhaseSpaceFig2}.

\imageFigure{../../figures/phy452/pendulumPhaseSpaceFig2}{Phase space trajectory for small angle pendulum}{fig:pendulumPhaseSpace:pendulumPhaseSpaceFig2}{0.2}

The area of this ellipse is

\begin{dmath}\label{eqn:pendulumPhaseSpace:300}
A = \pi \inv{\omega^2 l^2} \frac{2 E}{m} \omega m l^2 
= \frac{2 \pi}{\omega} E.
\end{dmath}

With \(\tau\) for the period of the trajectory, this is 

\begin{equation}\label{eqn:pendulumPhaseSpace:320}
A = \tau E.
\end{equation}

As a final note, observe that the oriented integral from problem 2.5 of the text \(\oint p_\theta d\theta\), is also this area.  This is a general property, which can be seen geometrically in \cref{fig:pendulumPhaseSpace:pendulumPhaseSpaceFig3}, where we see that the counterclockwise oriented integral of \(\oint p dq\) would give the negative area.  The integrals along the \(c_4, c_1\) paths give the area under the blob, whereas the integrals along the other paths where the sense is opposite, give the complete area under the top boundary.  Since they are oppositely sensed, adding them gives just the area of the blob.

\imageFigure{../../figures/phy452/pendulumPhaseSpaceFig3}{Area from oriented integral along path}{fig:pendulumPhaseSpace:pendulumPhaseSpaceFig3}{0.3}

Let's do this \(\oint p_\theta d\theta\) integral for the pendulum phase trajectories.  With

\begin{subequations}
\begin{equation}\label{eqn:pendulumPhaseSpace:340}
\theta = \inv{\omega l} \sqrt{\frac{2 E}{m}} \cos(\omega t + \phi)
\end{equation}
\begin{equation}\label{eqn:pendulumPhaseSpace:360}
p_\theta = -m l \sqrt{\frac{2 E}{m}} \sin(\omega t + \phi)
\end{equation}
\end{subequations}

We have

\begin{dmath}\label{eqn:pendulumPhaseSpace:380}
\oint p_\theta d\theta 
= \frac{m l}{\omega l} \frac{2 E}{m} \int_0^{2\pi/\omega} \sin^2( \omega t + \phi) \omega dt
= 2 E \int_0^{2\pi/\omega} \frac{ 1 - \cos\lr{ 2(\omega t + \phi) } }{2} dt
= E \frac{2 \pi}{\omega} 
= E \tau.
\end{dmath}
} % makeanswer

%\EndArticle
