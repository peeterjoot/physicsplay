%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Diffraction patterns}
{modernOptics:problemSet2:1}
{2012 Problem Set2, Problem 1}
{
Give the intensity pattern at the back plane of a lens of focal length \(f\) for the following aperture distributions. Assume a point source that is infinitely far away, on-axis, and quasimonochromatic with wavelength \(\lambda\).

This geometry is illustrated in \cref{fig:modernOpticsProblemSet2Problem1:modernOpticsProblemSet2Problem1Fig1}.

\imageFigure{../../figures/phy485/modernOpticsProblemSet2Problem1Fig1}{Geometry for the masked diffraction problems}{fig:modernOpticsProblemSet2Problem1:modernOpticsProblemSet2Problem1Fig1}{0.4}

\makesubproblem{A rectangular aperture of size \(L\) by \(W\)}{modernOptics:problemSet2:1a}
\makesubproblem{
Three slits, each \(a\) wide, spaced by \(b\). \{Do this part in 1D, ignoring the other axis.\}
}{modernOptics:problemSet2:1b}
\makesubproblem{
A mask whose transmission function is \(\exp{(-x^2/\sigma_x^2 - y^2/\sigma_y^2)}\).
}{modernOptics:problemSet2:1c}
} % makeoproblem

\makeanswer{modernOptics:problemSet2:1}{

Let's first consider the geometrical optics of the lens and transmission to the focal plane.  With an ABCD matrix of \(M_1\) for the lens and \(M_2\) for the transmission we have for the composite operation

\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P1:10}
M
= M_2 M_1
=
\begin{bmatrix}
1 & f \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
-1/f & 0
\end{bmatrix}
=
\begin{bmatrix}
0 & f \\
-1/f & 1
\end{bmatrix}.
\end{dmath}

So an initial position and angle pair is transformed as

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:30}
\begin{bmatrix}
y \\
\alpha
\end{bmatrix}
\rightarrow
\begin{bmatrix}
0 & f \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
y \\
\alpha
\end{bmatrix}
=
\begin{bmatrix}
f \alpha \\
-y/f + \alpha
\end{bmatrix}
\end{equation}

The new position \(y' = f \alpha\) is strictly a function of the output angle at the mask, or the input to the lens.

Now consider the geometry of the aperture and the position of the ray on the focal plane as illustrated in \cref{fig:modernOpticsProblemSet2Problem1:modernOpticsProblemSet2Problem1Fig2}.

\imageFigure{../../figures/phy485/modernOpticsProblemSet2Problem1Fig2}{Diffraction geometry with lens}{fig:modernOpticsProblemSet2Problem1:modernOpticsProblemSet2Problem1Fig2}{0.4}

The position \(\Br'\) of the area element in the diffraction integral is

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:50}
\Br' =
\begin{bmatrix}
x' \\
y' \\
0
\end{bmatrix},
\end{equation}

and the position \(P\) of the ray on the focal plane is

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:70}
\Br = f
\begin{bmatrix}
\alpha \\
\beta \\
1
\end{bmatrix}.
\end{equation}

Our diffraction integral is of the form

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:90}
\Psi(\Br) = \frac{A}{i \lambda} \frac{e^{i k R_s}}{R_s} \iint_A \frac{e^{i k R}}{R} da'
\end{equation}

Writing for the incident wavefunction

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:110}
\Psi_s = A \frac{e^{i k R_s}}{R_s},
\end{equation}

which we will consider to be approximately plane wave anyhow, we calculate our approximation for the distance from the area element to the point on the focal plane

\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P1:130}
k R
= k \sqrt{ (\Br - \Br')^2 }
= k r \sqrt{ 1 + \frac{{r'}^2}{r^2} - \frac{2}{r^2} \Br \cdot \Br' }
\approx
= k r \left( 1 + \inv{2} \frac{{r'}^2}{r^2} - \frac{1}{r^2} \Br \cdot \Br' \right)
= k r + \frac{k}{2} \frac{{r'}^2}{r} - \rcap \cdot \Br' .
\end{dmath}

With an assumption that \(r \approx f \gg {r'}^2/\lambda\), and noting that \(R \approx f\) in the denominator of the integrand where any variation will not matter as much we have

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:150}
\Psi(\Br) = \frac{\Psi_s}{i \lambda} \frac{e^{i k f}}{f} \iint_A e^{-i k \Br' \cdot \rcap } da'
\end{equation}

Noting from \eqnref{eqn:modernOptics:ProblemSet2:P1:70} that \(\Br^2 \approx f^2\) if \(\alpha\) and \(\beta\) are small, then we have

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:170}
\rcap \sim
\begin{bmatrix}
\alpha \\
\beta \\
1
\end{bmatrix},
\end{equation}

so that our diffraction integral becomes

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:190}
\Psi(\Br) = \frac{\Psi_s}{i \lambda} \frac{e^{i k f}}{f} \iint_A e^{-i k ( \alpha x' + \beta y' ) } da'.
\end{equation}

We are now ready to consider the specific geometries of this problem.

% not working? :
%\makesubanswer{TODO.}{modernOptics:problemSet2:1a}
%\paragraph{Single rectangular slit \cref{modernOptics:problemSet2:1a}}
\paragraph{Part \ref{modernOptics:problemSet2:1a}.  Single rectangular slit.}

Let's setup our coordinates as in \cref{fig:modernOpticsProblemSet2Problem1:modernOpticsProblemSet2Problem1Fig3}.

\imageFigure{../../figures/phy485/modernOpticsProblemSet2Problem1Fig3}{Single rectangular slit}{fig:modernOpticsProblemSet2Problem1:modernOpticsProblemSet2Problem1Fig3}{0.4}

Let's write \(\mu = -i k \alpha\) and \(\nu = -i k \beta\) so that we want to compute

\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P1:210}
\iint e^{-i k ( x' \alpha + y' \beta ) } dx' dy'
=
\int_{-W/2}^{W/2} dx' e^{i \mu x'}
\int_{-L/2}^{L/2} dy' e^{i \nu y'}
=
\evalrange{ \frac{e^{i \mu x'}}{i \mu} }{-W/2}{W/2}
\evalrange{ \frac{e^{i \nu y'}}{i \nu} }{-L/2}{L/2}
=
\frac{4}{\mu\nu}
\sin\left( \mu W/2 \right)
\sin\left( \nu L/2 \right)
=
L W
\sinc\left( \mu W/2 \right)
\sinc\left( \nu L/2 \right).
\end{dmath}

So our wave function is

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:230}
\Psi(\Br) = \frac{L W \Psi_s}{i \lambda} \frac{e^{i k f}}{f}
\sinc\left( \mu W/2 \right)
\sinc\left( \nu L/2 \right).
\end{equation}

With the time averaged intensity at the aperture of

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:250}
I_s = \expectation{ \Psi_s } = \frac{A^2}{2 R_s^2},
\end{equation}

We have for the time averaged intensity at the focal plane position \(\Br = f( \alpha, \beta, 1)\)

\boxedEquation{eqn:modernOptics:ProblemSet2:P1:270}{
I(\Br) =
\Psi(\Br) = I_s \left( \frac{L W}{\lambda f} \right)^2
\sinc^2\left( \frac{\pi \alpha W}{\lambda} \right)
\sinc^2\left( \frac{\pi \beta L}{\lambda} \right).
%\sinc^2\left( k \alpha W/2 \right)
%\sinc^2\left( k \beta L/2 \right).
}

%\makesubanswer{TODO.}{modernOptics:problemSet2:1b}
\paragraph{Part \ref{modernOptics:problemSet2:1b}.  Three slits}

We now consider the geometry of a three slit setup \cref{fig:modernOpticsProblemSet2Problem1:modernOpticsProblemSet2Problem1Fig4}.

\imageFigure{../../figures/phy485/modernOpticsProblemSet2Problem1Fig4}{Three slit diffraction aperture}{fig:modernOpticsProblemSet2Problem1:modernOpticsProblemSet2Problem1Fig4}{0.3}

We form the integral

\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P1:290}
\iint_A e^{-i k (\alpha x' + \beta y') } dx' dy'
=
\int_{-L/2}^{L/2} dy' e^{-i k \beta y' }
\left(
\left(
\int_{-b - a/2}^{-b + a/2}
+\int_{- a/2}^{a/2}
+\int_{b - a/2}^{b + a/2}
\right)
 dx' e^{-i k \alpha x' }
\right)
=
L \sinc\left( \frac{\beta k L}{2} \right)
\sum_{n=-1}^{n=1}
\evalrange{
\frac{ e^{-i k \alpha x'} }{-i k \alpha}
}
{n b -a/2}
{n b +a/2}
=
L \sinc\left( \frac{\beta k L}{2} \right)
\frac{2}{k \alpha}
\sum_{n=-1}^{n=1}
\left(
\frac{e^{-i k \alpha (n b -a/2)} -e^{-i k \alpha (n b +a/2)} }{2 i}
\right)
=
L \sinc\left( \frac{\beta k L}{2} \right)
\frac{2}{k \alpha}
\sin( k \alpha a/2 )
\sum_{n=-1}^{n=1}
e^{-i k \alpha n b}
=
L a
\sinc\left( \frac{\beta k L}{2} \right)
\sinc\left( \frac{\alpha k a}{2} \right)
\sum_{n=-1}^{n=1}
e^{-i k \alpha n b}.
\end{dmath}

With \(a = e^{i k \alpha b}\), and noting that

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:310}
\inv{a} + 1 + a = \frac{a^3 - 1}{a - 1},
\end{equation}

we have

\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P1:330}
\sum_{n=-1}^{n=1}
e^{-i k \alpha n b}
=
\frac{ e^{3 i k \alpha b} - 1 }{ e^{i k \alpha b} - 1 }
=
\frac{ e^{3 i k \alpha b/2} }{ e^{i k \alpha b/2} }
\frac{ \sin( 3 k \alpha b/2 ) }{ \sin( k \alpha b/2 ) }
=
e^{i k \alpha b}
\frac{ \sin( 3 k \alpha b/2 ) }{ \sin( k \alpha b/2 ) }
\end{dmath}

We can now write our wavefunction

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:350}
\Psi(\Br) = \frac{L a \Psi_s}{i \lambda} \frac{e^{i k f}}{f}
\sinc\left( \frac{\beta k L}{2} \right)
\sinc\left( \frac{\alpha k a}{2} \right)
e^{i k \alpha b}
\frac{ \sin \left( \frac{3 k \alpha b}{2} \right) }{ \sin\left( \frac{k \alpha b}{2} \right) }.
\end{equation}

We see our single slit terms become an envelope for the resulting waveform, with faster frequency terms due to the ratio of sinusoidal terms.

Our time averaged intensity, again in terms of the time averaged intensity of the plane waves at the aperture \(I_s\), is

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:370}
I = I_s \left( \frac{L a}{\lambda f} \right)^2
\sinc^2\left( \frac{\beta k L}{2} \right)
\sinc^2\left( \frac{\alpha k a}{2} \right)
\frac{ \sin^2 \left( \frac{3 k \alpha b}{2} \right) }{ \sin^2\left( \frac{k \alpha b}{2} \right) }.
\end{equation}

We were asked to consider this as a 1D problem, but it was no harder as a 2D problem.  For a 1D only result, looking say at the horizon where \(\beta = 0\), we have

\boxedEquation{eqn:modernOptics:ProblemSet2:P1:390}{
I = I_s \left( \frac{L a}{\lambda f} \right)^2
\sinc^2\left( \frac{\alpha k a}{2} \right)
\frac{ \sin^2 \left( \frac{3 k \alpha b}{2} \right) }{ \sin^2\left( \frac{k \alpha b}{2} \right) }.
}

%\makesubanswer{TODO.}{modernOptics:problemSet2:1c}
\paragraph{Part \ref{modernOptics:problemSet2:1c}.  Transmission function}

We've been implicitly evaluating diffraction integrals of the form

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:410}
\iint_A e^{-i k( x'\alpha + y' \beta) } dx' dy'
= \iint_{-\infty}^\infty g(x', y') e^{-i k( x'\alpha + y' \beta) } dx' dy'
\end{equation}

where

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:430}
g(x', y') =
\left\{
\begin{array}{l l}
1 & \quad \mbox{if \(x'\) and \(y'\) lie within the aperture} \\
0 & \quad \mbox{otherwise}
\end{array}
\right.
\end{equation}

We are now asked to consider a more general aperture function

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:450}
g(x', y') = e^{-{x'}^2/\sigma_x^2 - {y'}^2/\sigma_y^2}
\end{equation}

which fully allows transmission at the origin where \(g(0, 0) = 1\), and then gradually lets less and less light through the aperture as illustrated in \cref{fig:modernOpticsProblemSet2Problem1:modernOpticsProblemSet2Problem1Fig5}.

\imageFigure{../../figures/phy485/modernOpticsProblemSet2Problem1Fig5}{Gaussian transmission function aperture}{fig:modernOpticsProblemSet2Problem1:modernOpticsProblemSet2Problem1Fig5}{0.3}

Our task is to evaluate the integral

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:470}
\iint_{-\infty}^\infty g(x', y') e^{-i k( x'\alpha + y' \beta) } dx' dy'
=
\int dx' e^{-{x'}^2/\sigma_x^2 -i k x' \alpha}
\int dy' e^{-{y'}^2/\sigma_y^2 -i k y' \beta}.
\end{equation}

Since these have the same form, it is sufficient to just look at one of them.

\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P1:490}
\int dx' e^{-{x'}^2/\sigma_x^2 -i k x' \alpha}
=
\sigma_x \int dx' e^{-{x'}^2/\sigma_x^2 -i k \alpha \sigma_x x'/\sigma_x}
=
\sigma_x \int dx' e^{-u^2 -i k \alpha \sigma_x u}.
\end{dmath}

With \(2 b = k \alpha \sigma_x\) we have

\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P1:510}
\int dx' e^{-{x'}^2/\sigma_x^2 -i k x' \alpha}
=
\sigma_x \int dx' e^{-u^2 - 2 i b u}
=
\sigma_x \int du e^{ -(u + i b)^2 + (ib)^2 }
=
\sigma_x e^{-b^2} \int dv e^{ -v^2 }
=
\sigma_x e^{-b^2} \sqrt{\pi}.
\end{dmath}

Our aperture integral is

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:530}
\iint_{-\infty}^\infty g(x', y') e^{-i k( x'\alpha + y' \beta) } dx' dy'
=
\pi \sigma_x \sigma_y
e^{
- (k \alpha \sigma_x/2)^2
- (k \beta \sigma_y/2)^2
},
\end{equation}

and our wave function evaluated at point \(\Br = f(\alpha, \beta, 1)\), given plane wave function \(\Psi_s\) at the aperture is

\begin{equation}\label{eqn:modernOptics:ProblemSet2:P1:350b}
\Psi(\Br) =
\frac{\pi \sigma_x \sigma_y \Psi_s}{i \lambda} \frac{e^{i k f}}{f}
e^{
- (k \alpha \sigma_x/2)^2
- (k \beta \sigma_y/2)^2
},
\end{equation}

with time averaged intensity

\boxedEquation{eqn:modernOptics:ProblemSet2:P1:550}{
I(\Br) = I_s
\left( \frac{\pi \sigma_x \sigma_y }{ \lambda f} \right)^2
e^{
- (k \alpha \sigma_x)^2/2
- (k \beta \sigma_y)^2/2
}.
}

} % makeanswer
