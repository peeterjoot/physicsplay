%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{modernOpticsLecture1}
%\renewcommand{\dirname}{notes/phy485/}
%\newcommand{\keywords}{Optics, PHY485H1F, ABCD matrix, lens-makers formula, transfer matrix}
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc

%\generatetitle{PHY485H1F Modern Optics.  Lecture 1: Matrix methods in Geometric Optics.  Taught by Prof.\ Joseph Thywissen}
\label{chap:modernOpticsLecture1}

%\section{Disclaimer}
%
%Peeter's lecture notes from class.  May not be entirely coherent.

\section{Missing content}

I was late.  Glancing at somebody else's notes very quickly, it looked like I missed

\begin{itemize}
\item A derivation of Snell's law from Fermat's principle.
\item The focal point formula
\begin{equation}\label{eqn:modernOpticsLecture1:411}
\inv{f} = \inv{s} + \inv{s'}
\end{equation}
\item The paraxial approximation was defined (small angles only, looking only near the center of a lens).
\end{itemize}

I was going to scrounge for notes to scan from somebody else so I can fill in missing content, but instead think I'll fill in with some self assigned problems.

Suggested reading for this lecture is \S 5 from \citep{hecht1998hecht}.

\section{Matrix methods}

Referring to \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig1}

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig1}{Matrix method}{fig:modernOpticsLecture1:modernOpticsLecture1Fig1}{0.4}

we can define a transfer out matrix, or \(A B C D\) matrix taking pairs of coordinates describing rays

\begin{dmath}\label{eqn:modernOpticsLecture1:10}
\begin{bmatrix}
y \\
\alpha
\end{bmatrix}
\end{dmath}

so that the transition of the ray through the interface is described as
\begin{dmath}\label{eqn:modernOpticsLecture1:30}
\begin{bmatrix}
y_f \\
\alpha_f
\end{bmatrix}
=
\begin{bmatrix}
A & B \\
C & D
\end{bmatrix}
\begin{bmatrix}
y_i \\
\alpha_i
\end{bmatrix}
\end{dmath}

\subsection{Free propagation}
Referring to \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig2} we see that

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig2}{Free propagation}{fig:modernOpticsLecture1:modernOpticsLecture1Fig2}{0.4}

\begin{dmath}\label{eqn:modernOpticsLecture1:35}
\tan \alpha = \frac{\Delta y}{L} \approx \alpha,
\end{dmath}

so that

\begin{dmath}\label{eqn:modernOpticsLecture1:45}
y' = y + \Delta y \approx y + L \alpha,
\end{dmath}

so that our matrix describing free propagation is

\begin{dmath}\label{eqn:modernOpticsLecture1:50}
\begin{bmatrix}
y_f \\
\alpha_f
\end{bmatrix}
=
\begin{bmatrix}
1 & L \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
y_i \\
\alpha_i
\end{bmatrix}
\end{dmath}

\subsection{Refraction off of a flat lens}

Referring to \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig3}

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig3}{Refraction at flat surface}{fig:modernOpticsLecture1:modernOpticsLecture1Fig3}{0.4}

where

\begin{dmath}\label{eqn:modernOpticsLecture1:70}
n \sin\alpha = n' \sin\alpha'.
\end{dmath}

We employ the paraxial approximation

\begin{dmath}\label{eqn:modernOpticsLecture1:90}
n \alpha \sim n' \alpha',
\end{dmath}

or

\begin{dmath}\label{eqn:modernOpticsLecture1:110}
\alpha' = \frac{n'}{n} \alpha,
\end{dmath}

allowing for the description of refraction off of a flat lens by

\begin{dmath}\label{eqn:modernOpticsLecture1:130}
\begin{bmatrix}
y_f \\
\alpha_f
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 \\
0 & \frac{n'}{n}
\end{bmatrix}
\begin{bmatrix}
y_i \\
\alpha_i
\end{bmatrix}
\end{dmath}

\subsection{Refraction of a curved surface}

\subsubsection{Convex refraction}

Referring to \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig4}

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig4}{Refraction of convex surface}{fig:modernOpticsLecture1:modernOpticsLecture1Fig4}{0.4}

we see that

\begin{dmath}\label{eqn:modernOpticsLecture1:150}
\phi \approx \frac{y}{R},
\end{dmath}

and can also employ Snell's law in the approximation

\begin{dmath}\label{eqn:modernOpticsLecture1:370}
n \theta = n' \theta'.
\end{dmath}

From the figure we see that

\begin{subequations}
\begin{equation}\label{eqn:modernOpticsLecture1:410}
\theta = \alpha + \phi
\end{equation}
\begin{equation}\label{eqn:modernOpticsLecture1:430}
\theta' = \alpha + \phi'
\end{equation}
\end{subequations}

or
\begin{dmath}\label{eqn:modernOpticsLecture1:390}
n(\alpha + \phi) = n' (\alpha' + \phi).
\end{dmath}

Using \eqnref{eqn:modernOpticsLecture1:150} this is
\begin{dmath}\label{eqn:modernOpticsLecture1:390b}
n\left( \alpha + \frac{y}{R} \right) = n' \left( \alpha' + \frac{y}{R} \right),
\end{dmath}

which we can rearrange to find

\begin{equation}\label{eqn:modernOpticsLecture1:450}
\alpha' = \frac{y}{R}\left( \frac{n}{n'} - 1 \right) + \frac{n}{n'} \alpha.
\end{equation}

This can now be put into matrix form, yielding

\begin{dmath}\label{eqn:modernOpticsLecture1:170}
\begin{bmatrix}
y_f \\
\alpha_f
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 \\
\inv{R}\left( \frac{n}{n'} -1 \right) & \frac{n}{n'}
\end{bmatrix}
\begin{bmatrix}
y_i \\
\alpha_i
\end{bmatrix}
\end{dmath}

Observe that for \(R \rightarrow \infty\) we have the same result as a flat surface.

\subsubsection{Concave refraction}

Now, let's consider an input ray against a concave surface.  We have just to flip around some of the labels as in \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig4b}.

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig4b}{Refraction against concave surface}{fig:modernOpticsLecture1:modernOpticsLecture1Fig4b}{0.4}

From the figure the only difference is that the coordinate of the focus is now at \((-R, 0)\) whereas it was \((R, 0)\) before.  So if we write \(R' = -R\), with \(R\) being positive we find for a ray incident on a concave lens

\begin{dmath}\label{eqn:modernOpticsLecture1:170b}
\begin{bmatrix}
y_f \\
\alpha_f
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 \\
\inv{R'}\left( \frac{n}{n'} -1 \right) & \frac{n}{n'}
\end{bmatrix}
\begin{bmatrix}
y_i \\
\alpha_i
\end{bmatrix}
\end{dmath}

Alternatively, and this is what we do, is that we allow for \(R\) to be signed, in which case this formula is true for both \(R > 0\) (convex) and \(R < 0\) (concave).  We employ the following sign convention \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig5}

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig5}{Concave curvature}{fig:modernOpticsLecture1:modernOpticsLecture1Fig5}{0.4}

where \(-R\) is used for concave, and \(+R\) is used for convex.

\subsection{Curvature sign convention}

The sign conventions are illustrated in \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig6}

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig6}{Sign convention}{fig:modernOpticsLecture1:modernOpticsLecture1Fig6}{0.4}

and \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig7}.
\imageFigure{../../figures/phy485/modernOpticsLecture1Fig7}{Convex curvature}{fig:modernOpticsLecture1:modernOpticsLecture1Fig7}{0.4}

\subsection{\(ABCD\) matrix for a lens}

Consider the lens illustrated in \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig8}

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig8}{matrix for lens}{fig:modernOpticsLecture1:modernOpticsLecture1Fig8}{0.4}

where once again we use the paraxial approximation, assuming we are considering only close enough to the middle that we can neglect any variation in thickness.  In this approximation we have a geometry of the form \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig9}

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig9}{Lens paraxial approximation}{fig:modernOpticsLecture1:modernOpticsLecture1Fig9}{0.4}

where \(y \ll R_1, R_2\).

Our complete transfer matrix is then given by

\begin{dmath}\label{eqn:modernOpticsLecture1:190}
\begin{bmatrix}
y_f \\
\alpha_f
\end{bmatrix}
=
M_3 M_2 M_1
\begin{bmatrix}
y_i \\
\alpha_i
\end{bmatrix}
= M
\begin{bmatrix}
y_i \\
\alpha_i
\end{bmatrix}
.
\end{dmath}

We've described \(M_1, M_2, M_3\) individually above, and they are

\begin{subequations}
\begin{equation}\label{eqn:modernOpticsLecture1:470}
M_1 =
\begin{bmatrix}
1 & 0 \\
\inv{R_1}\left( \frac{n}{n'} -1 \right) & \frac{n}{n'}
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:modernOpticsLecture1:490}
M_2 =
\begin{bmatrix}
1 & t \\
0 & 1
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:modernOpticsLecture1:510}
M_3 =
\begin{bmatrix}
1 & 0 \\
\inv{R_2}\left( \frac{n'}{n} -1 \right) & \frac{n'}{n}
\end{bmatrix}
\end{equation}
\end{subequations}

The matrix \(M\) is the mess

\begin{dmath}\label{eqn:modernOpticsLecture1:530}
M
=
\begin{bmatrix}
1 & 0 \\
\inv{R_2}\left( \frac{n'}{n} -1 \right) & \frac{n'}{n}
\end{bmatrix}
\begin{bmatrix}
1 & t \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
\inv{R_1}\left( \frac{n}{n'} -1 \right) & \frac{n}{n'}
\end{bmatrix}
\end{dmath}

With only the ratio \(n'/n\) showing up, let's make the substitution

\begin{dmath}\label{eqn:modernOpticsLecture1:550}
\frac{n'}{n} \rightarrow n,
\end{dmath}

effectively working with \(n = 1\) outside of the lens.  This gives us

\begin{dmath}\label{eqn:modernOpticsLecture1:570}
M
=
\begin{bmatrix}
1 & 0 \\
\inv{R_2}\left( n -1 \right) & n
\end{bmatrix}
\begin{bmatrix}
1 & t \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
\inv{R_1}\left( \inv{n} -1 \right) & \inv{n}
\end{bmatrix}
=
\begin{bmatrix}
1 & t \\
\inv{R_2}\left( n -1 \right) &
\frac{t}{R_2}\left( n -1 \right) + n
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
\inv{R_1}\left( \inv{n} -1 \right) & \inv{n}
\end{bmatrix}
=
\begin{bmatrix}
1 + \frac{t}{R_1}\left( \inv{n} -1 \right) & \frac{t}{n} \\
\inv{R_2}\left( n -1 \right)
- \inv{R_1}\left( n -1 \right)
+
\frac{t}{R_1 R_2}\left( n -1 \right) \left( \inv{n} -1 \right) &
\frac{t}{R_2}\left( -\inv{n} + 1 \right) + 1
\end{bmatrix}
=
\begin{bmatrix}
1 + \frac{t}{R_1}\left( \inv{n} -1 \right) & t \inv{n} \\
-\left( n - 1 \right)
\left(
\inv{R_1} -\inv{R_2}
+
\frac{t}{n R_1 R_2}\left( n - 1 \right)
\right)
&
1 - \frac{t}{R_2}\left( \inv{n} - 1 \right)
\end{bmatrix}
\end{dmath}

Writing the \(C\) term as \(-1/f\) we have what's called the \underlineAndIndex{Lens makers formula} (for a thick lens in this case), and putting back in \(n\) and \(n'\) we have

\begin{dmath}\label{eqn:modernOpticsLecture1:590}
\inv{f} =
\left( \frac{n'}{n} - 1 \right)
\left(
\inv{R_1} -\inv{R_2}
+
\frac{n t}{n' R_1 R_2}\left( \frac{n'}{n} - 1 \right)
\right)
\end{dmath}

Observe that for a thin lens where \(t \rightarrow 0\) we have the approximation

\begin{dmath}\label{eqn:modernOpticsLecture1:210}
M =
\begin{bmatrix}
1 & 0 \\
- 1/f & 1
\end{bmatrix}.
\end{dmath}

For our focus in \eqnref{eqn:modernOpticsLecture1:590} we get

\begin{dmath}\label{eqn:modernOpticsLecture1:230}
\inv{f} = \frac{n' - n}{n} \left( \inv{R_1} - \inv{R_2} \right).
\end{dmath}

This is called the (thin lens) Lens makers formula.  This, and \(n \approx 1.5\) is enough to construct many lens designs.  Our sign conventions for \(f\) are illustrated by \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig10}.
\imageFigure{../../figures/phy485/modernOpticsLecture1Fig10}{Lens}{fig:modernOpticsLecture1:modernOpticsLecture1Fig10}{0.4}

where \(f > 0\) is convex and \(f < 0\) is concave.

\subsection{Properties of the transfer matrix}

\begin{enumerate}
\item The determinant of the transfer matrix is described by index of refraction of just the initial and final media, and \(\Det M = n_0/n_f\).

\fxwarning{Demonstrate, matrix optics}{demonstrate.}

Examples
\begin{enumerate}
\item Thin lens
\begin{dmath}\label{eqn:modernOpticsLecture1:250}
M =
\begin{bmatrix}
1 & 0 \\
- 1/f & 1
\end{bmatrix}
\end{dmath}
\item Free propagation
\begin{dmath}\label{eqn:modernOpticsLecture1:270}
M =
\begin{bmatrix}
1 & L \\
0 & 1
\end{bmatrix}
\end{dmath}
\end{enumerate}

In particular, if imaging something in air, where we have \(n_0 = n_f\) we have \(\Abs{M} = 1\).
\item How about \(\Abs{M} = 0\).  There are a couple of cases.  One is \(D = 0\) where

\begin{dmath}\label{eqn:modernOpticsLecture1:290}
\alpha_f = C y_i + \cancel{ D \alpha_i}
\end{dmath}

output \(\rightarrow\) input is focus, as illustrated in \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig11}.
\imageFigure{../../figures/phy485/modernOpticsLecture1Fig11}{\(D = 0\)}{fig:modernOpticsLecture1:modernOpticsLecture1Fig11}{0.4}

\fxwarning{Review matrix optics figures}{Understand this.}

\item We also have zero determinant when \(A = 0\), in which case we have

\begin{dmath}\label{eqn:modernOpticsLecture1:310}
y_f = \cancel{ A y_i } + B \alpha_i,
\end{dmath}

The output location is only a function of the input angle as illustrated in \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig12}.

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig12}{\(A = 0\)}{fig:modernOpticsLecture1:modernOpticsLecture1Fig12}{0.4}

\item How about if \(B = 0\).  Now we have

\begin{dmath}\label{eqn:modernOpticsLecture1:330}
\alpha_f = \cancel{B y_i} + C \alpha_i,
\end{dmath}

so that we see that the output is an image of the input, but scaled (a magnifier or reducer).  This is illustrated in \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig13}.

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig13}{\(B = 0\)}{fig:modernOpticsLecture1:modernOpticsLecture1Fig13}{0.4}

\item And finally if \(C = 0\) we have

\begin{dmath}\label{eqn:modernOpticsLecture1:350}
\alpha_f = \cancel{C y_i} + D \alpha_i,
\end{dmath}

and we find out system is telescopic, magnifying the angle, as illustrated in \cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig14}.

\imageFigure{../../figures/phy485/modernOpticsLecture1Fig14}{\(C = 0\)}{fig:modernOpticsLecture1:modernOpticsLecture1Fig14}{0.4}
\end{enumerate}

% had F15, but no description?
%\cref{fig:modernOpticsLecture1:modernOpticsLecture1Fig15}.
%\imageFigure{../../figures/phy485/modernOpticsLecture1Fig15}{?}{fig:modernOpticsLecture1:modernOpticsLecture1Fig15}{0.4}

\section{Problems}
\input{snellsFermat.tex}
   %\shipoutAnswer

\input{modernOpticsProblemSet1Attempt1.tex}
%   \shipoutAnswer

\input{convexNonParaxial.tex}
   %\shipoutAnswer

\input{concaveReflection.tex}
   %\shipoutAnswer

\input{modernOpticsProblemSet1Problem1.tex}
   %\shipoutAnswer

%\vcsinfo
%\EndArticle
