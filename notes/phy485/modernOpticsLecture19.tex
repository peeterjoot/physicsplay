%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{modernOpticsLecture19}
%\renewcommand{\dirname}{notes/phy485/}
%\newcommand{\keywords}{Optics, PHY485H1F}
%\input{../peeter_prologue_print2.tex}
%
%\usepackage[draft]{fixme}
%\fxusetheme{color}
%
%\beginArtNoToc
%\generatetitle{PHY485H1F Modern Optics.  Lecture 19: Solving the homogeneous paraxial wave equation.  Taught by Prof.\ Joseph Thywissen}
\label{chap:modernOpticsLecture19}

%\section{Disclaimer}
%
%Peeter's lecture notes from class.  May not be entirely coherent.

\section{Solving the homogeneous paraxial wave equation}
\index{paraxial wave equation}

We are going to start with the paraxial wave equation for a quadratic index profile

\begin{dmath}\label{eqn:modernOpticsLecture19:20}
\spacegrad_{\mathrm{T}}^2 u + 2 i k \PD{z}{u}
- k_0 k_2 r^2 u
= 0,
\end{dmath}

as derived from the Helmholtz equation, assuming a wave function of the form

\begin{dmath}\label{eqn:modernOpticsLecture19:520}
\Psi = \Psi_0 u(x, y, z) e^{i k_0 z}.
\end{dmath}

% missed what this rough plot was about:
%FIXME: \cref{fig:modernOpticsLecture19:modernOpticsLecture19Fig0}.
%\imageFigure{../../figures/phy485/modernOpticsLecture19Fig0}{CAPTION}{fig:modernOpticsLecture19:modernOpticsLecture19Fig0}{0.3}
%
We now want to try to find approximate solutions for \(u\).  We'll ignore the fact that we know the solutions from QM, but use that knowledge try to pick a Gaussian as a trial function

\begin{dmath}\label{eqn:modernOpticsLecture19:40}
u = \exp\left( i p(z) + i \frac{ k_0 r^2}{2 q(z)} \right).
\end{dmath}

This is a strange choice for a trial function, seemingly motivated by trying it at least once and then picking more tractable functions for the exponential argument.  Perhaps try later without knowing the answer and see what motivates this strange selection.

With only \(z\) dependence in the functions \(q = q(z)\), \(p = p(z)\), we apply the operator equation to find

\begin{dmath}\label{eqn:modernOpticsLecture19:60}
0
= \spacegrad_T^2 u - k_0 k_2 r^2 u + 2 i k_0 \PD{z}{u}
=
\left( \PD{r}{} + \inv{r} \right) \frac{i k_0 r}{q} u
- k_0 k_2 r^2 u + 2 i k_0 \left(
i p' - \frac{i k_0 r^2}{2 q^2} q'
\right) u
=
u
\left(
\frac{i k_0}{q}
-
\frac{k_0^2 r^2}{q^2}
+\frac{i k_0 }{q}
- k_0 k_2 r^2
+ 2 i k_0 \left(
i p' - \frac{i k_0 r^2}{2 q^2} q'
\right)
\right)
=
u r^2 k_0^2
\left(
-\frac{1}{q^2}
- \frac{k_2 }{k_0}
+ \frac{ 1 }{q^2} q'
\right)
+ 2 k_0 u
\left(
\frac{i }{q}
- p'
\right)
\end{dmath}
%-\frac{k^2}{q^2} r^2 + 2 i \frac{k}{q} - k^2 r^2 \left( \inv{q} \right)' - 2 k r' - k k_2 r^2 = 0.

%\begin{dmath}\label{eqn:modernOpticsLecture19:80}
%\inv{q^2} + \frac{d}{dz} \left( \inv{q} \right) + \frac{k_2}{k} = 0
%\end{dmath}
%
Requiring equality for \(r = 0\) gives us

\begin{dmath}\label{eqn:modernOpticsLecture19:100}
\frac{dp}{dz} = \frac{i}{q}.
\end{dmath}

Now killing off the \(k_2\) term (to be revisited in a subsequent lecture), we have

\begin{dmath}\label{eqn:modernOpticsLecture19:120}
0
%=
%\inv{q^2} + \frac{d}{dz} \left( \inv{q} \right)
%+ \cancel{\frac{k_2}{k}}
=
\inv{q^2} - \inv{q^2} q' + \cancel{\frac{k_2}{k_0}}
=
\inv{q^2}( 1 - q')
\end{dmath}

so that

\begin{dmath}\label{eqn:modernOpticsLecture19:140}
q = z + \text{constant} \equiv z + q_0 \equiv z - i z_0.
\end{dmath}

Integrating for \(p(z)\) we have

\begin{dmath}\label{eqn:modernOpticsLecture19:540}
p
= i \int \frac{dz}{z + q_0}
= i \ln\left( \frac{z + q_0}{q_0} \right) + p(0),
\end{dmath}

so that

\begin{dmath}\label{eqn:modernOpticsLecture19:560}
e^{i p(z)}
=
e^{i p(0)} \frac{q_0}{z + q_0}
=
e^{i p(0)} \frac{z_0}{i q}
\end{dmath}

Since \(p(0)\) contributes only a constant phase term (that can be incorporated into our multiplicative constant phasor \(\BE_0\)), we can set \(p(0) = 1\).  This gives us

\boxedEquation{eqn:modernOpticsLecture19:580}{
u(r, z)
= \frac{z_0}{i q} \exp\left( i \frac{ k_0 r^2}{2 q(z)} \right)
%=
%\frac{z_0}{iq}
%\exp\left( i \frac{ k_0 r^2}{2 (z - i z_0)} \right)
.
}

At \(z = 0\) we have

\begin{dmath}\label{eqn:modernOpticsLecture19:600}
u(r, 0)
=
\exp\left( -\frac{ k_0 r^2}{2 z_0} \right)
=
\exp\left( -\frac{ \pi r^2}{\lambda z_0} \right)
\equiv
\exp\left( -\frac{ r^2}{\omega_0^2} \right)
\end{dmath}

We call \(w_0\) the ``waist'' or the \underlineAndIndex{beam waist}, equivalently defining \(q_0\) and \(z_0\) in terms of the beam waist

\begin{dmath}\label{eqn:modernOpticsLecture19:180}
q_0 = -i \frac{w_0^2 k_0}{2} = -i \pi \frac{w_0^2}{\lambda} = -i z_0.
\end{dmath}

Inverting this last for \(z_0\) gives

\boxedEquation{eqn:modernOpticsLecture19:200}{
z_0 = \frac{\pi w_0^2}{\lambda},
}

which is called the \underlineAndIndex{Raleigh range}.

%\begin{dmath}\label{eqn:modernOpticsLecture19:160}
%u_{00}(x, y, z = 0) = \exp \left( -\frac{r^2}{w_0^2} \right)
%\end{dmath}
%Observe that \(p(z)\) can be written
%
%\begin{dmath}\label{eqn:modernOpticsLecture19:220}
%p(z)
%= i \ln \left( 1 + i \frac{z}{z_0} \right)
%= i \ln \left( 1 + i \frac{q + i z_0}{z_0} \right)
%= i \ln \left( i \frac{q}{z_0} \right)
%\end{dmath}

%Our trial solution is found to be
%
%\begin{dmath}\label{eqn:modernOpticsLecture19:240}
%u
%= \exp\left( i p(z) + i \frac{ k r^2}{2 q(z)} \right)
%= \exp\left( i i \ln \left( i \frac{q}{z_0} \right) + i \frac{ k r^2}{2 q(z)} \right)
%\end{dmath}
%
%or
%\begin{dmath}\label{eqn:modernOpticsLecture19:260}
%u
%= \frac{z_0}{iq} \exp\left( i \frac{ k r^2}{2 q(z)} \right)
%\end{dmath}

\paragraph{Real value normalization}

We've got a bit of a mess of mixed up real and imaginary parts here.  We can write this out instead as

\boxedEquation{eqn:modernOpticsLecture19:280}{
u
= \frac{w_0}{w(z)} \exp\left(
-\frac{r^2}{w^2(z)}
% HAD:
%+i \frac{ k_0 R^2(z)}{2 q(z)}
+i \frac{ k_0 r^2 }{2 R(z)}
- i \phi(z)
\right)
}

where

\begin{dmath}\label{eqn:modernOpticsLecture19:300}
\phi(z) = \Atan \left( \frac{z}{z_0} \right).
\end{dmath}

\begin{dmath}\label{eqn:modernOpticsLecture19:320}
w^2(z) = w_0^2 \left( 1  + \frac{z^2}{z_0^2} \right)
\end{dmath}

The quantity \(w(z)\) is called the \underlineAndIndex{beam radius}.

\begin{dmath}\label{eqn:modernOpticsLecture19:340}
\inv{R(z)} = \frac{z}{z^2 + z_0^2}.
\end{dmath}

The quantity \(1/R(z)\) is the \underlineAndIndex{phase curvature}.  Let's verify that this is correct.  Starting with the multiplicative term we have

\begin{dmath}\label{eqn:modernOpticsLecture19:620}
\frac{z_0}{i q(z)}
=
\frac{z_0}{i (z - i z_0)}
=
\frac{z_0}{i z + z_0}
=
\frac{1}{1 + i z/z_0 }
=
\frac{1}{\sqrt{1 + (z/z_0)^2} } e^{-i \Atan(z/z_0)}
=
\frac{w_0}{w(z)} e^{-i \phi(z)}.
\end{dmath}

Now for the rest
\begin{dmath}\label{eqn:modernOpticsLecture19:640}
e^{ \frac{i k_0 r^2}{2 (z - i z_0)} }
=
e^{ i r^2 \frac{k_0}{z_0} \frac{1}{2 (z/z_0 - i )} }
=
e^{ i r^2 \frac{k_0}{z_0} \frac{z/z_0 + i}{2 ((z/z_0)^2 +1 )} }
=
e^{ - r^2 \frac{k_0}{z_0} \frac{1}{2 ((z/z_0)^2 +1 )} }
e^{ i r^2 \frac{k_0}{z_0} \frac{z/z_0}{2 ((z/z_0)^2 +1 )} }
=
e^{ - r^2 \frac{1}{\omega^2} \frac{1}{(z/z_0)^2 +1} }
e^{ i r^2 \frac{k_0}{2} \frac{z}{z^2 + z_0^2} }
=
e^{ - \frac{k_0 r^2}{\omega^2(z)} }
e^{ i \frac{r^2}{2 R(z)} }.
\end{dmath}

This demonstrates the claimed identity \eqnref{eqn:modernOpticsLecture19:280}.

%Note that in the process of writing this out in terms of non-complex stuff we used
%
%\begin{dmath}\label{eqn:modernOpticsLecture19:360}
%\inv{q(z)} = \inv{R(z)} + \frac{i \lambda}{\pi w(z)}
%\end{dmath}

\paragraph{Plotting the envelope}

The real portion of the exponential determines the envelope.  It's pointed out in the handouts that the constant surfaces

\begin{dmath}\label{eqn:modernOpticsLecture19:660}
-k_0 \frac{r^2 }{w_0^2 \left( 1 + \frac{z^2}{z_0^2} \right)} = -k_0 C^2 = \text{constant},
\end{dmath}

or

\begin{dmath}\label{eqn:modernOpticsLecture19:680}
\frac{ x^2}{w_0^2 C^2}
+\frac{ y^2}{w_0^2 C^2}
- \frac{z^2}{z_0^2} = 1
\end{dmath}

With \(u = x/w_0 C, v = y/w_0 C, w = z/z_0\), this is plotted in \cref{fig:modernOpticsLecture19:modernOpticsLecture19Fig5}.  Playing around with this a bit \nbref{gaussianBeamHandoutNotes.nb} shows that increasing \(w_0\) reduces the pinch off in the center, and increasing \(z_0\) narrows the beam.
% This one was generated also by mathematica, but it produces a 3M file that both summatrapdf and adobe had trouble with.
%\cref{fig:modernOpticsLecture19:modernOpticsLecture19Fig4}.
%\imageFigure{../../figures/phy485/modernOpticsLecture19Fig4}{Gaussian beam envelope}{fig:modernOpticsLecture19:modernOpticsLecture19Fig4}{0.3}

\imageFigure{../../figures/phy485/modernOpticsLecture19Fig5}{Gaussian beam envelope}{fig:modernOpticsLecture19:modernOpticsLecture19Fig5}{0.4}

\paragraph{Some observations}

For \(z \gg z_0\), \(R \rightarrow z\), \(w(z) \rightarrow \frac{w_0 z}{z_0}\).   We see that

\begin{dmath}\label{eqn:modernOpticsLecture19:380}
% HAD: z/z_0 ?
u e^{i k_0 z} \rightarrow \frac{z_0}{z} \exp \left(
i k_0 z
-\frac{r^2}{w^2} + i \frac{k_0}{2 z} r^2
\right)
\end{dmath}

Compare to wave emitted by a point source as in \cref{fig:modernOpticsLecture19:modernOpticsLecture19Fig1}.

\imageFigure{../../figures/phy485/modernOpticsLecture19Fig1}{Point source}{fig:modernOpticsLecture19:modernOpticsLecture19Fig1}{0.3}

\begin{dmath}\label{eqn:modernOpticsLecture19:400}
\Psi \sim \inv{R} e^{i k R}
\end{dmath}

but

\begin{dmath}\label{eqn:modernOpticsLecture19:420}
R^2 = z^2 + r^2
\end{dmath}

Taylor expanding to first order

\begin{dmath}\label{eqn:modernOpticsLecture19:440}
R \approx z + \inv{2 z} r^2
\end{dmath}

we've got

\begin{dmath}\label{eqn:modernOpticsLecture19:460}
\Psi \sim \inv{z} \exp\left( i k z + i k \frac{r^2}{2z} \right)
\end{dmath}

So if we are looking at a point source slightly off axis, we have what looks like a Gaussian beam.

It looks like the Gaussian beam has an additional damping factor (with radius) that the point source does not.

\paragraph{Waste angular dependence}

%FIXME: \cref{fig:modernOpticsLecture19:modernOpticsLecture19Fig2}.
%\imageFigure{../../figures/phy485/modernOpticsLecture19Fig2}{CAPTION}{fig:modernOpticsLecture19:modernOpticsLecture19Fig2}{0.3}
Waste angular dependence is roughly illustrated in \cref{fig:modernOpticsLecture19:modernOpticsLecture19Fig3}.

\imageFigure{../../figures/phy485/modernOpticsLecture19Fig3}{Waste angular dependence}{fig:modernOpticsLecture19:modernOpticsLecture19Fig3}{0.3}

With

\begin{dmath}\label{eqn:modernOpticsLecture19:480}
w(z)
= w_0 \sqrt{ 1 + \frac{z^2}{z_0^2} }
\approx \frac{w_0}{z_0} z
= \Theta_{\mathrm{div}} z
\end{dmath}

Using \eqnref{eqn:modernOpticsLecture19:200} we can write this as

\begin{equation}\label{eqn:modernOpticsLecture19:500}
\Theta_{\mathrm{div}}
=
\frac{w_0}{\pi w_0^2} \lambda
=
\frac{1}{\pi w_0} \lambda.
\end{equation}

%\EndArticle
%\EndNoBibArticle
