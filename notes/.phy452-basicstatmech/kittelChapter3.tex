%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{kittelChapter3}
%\renewcommand{\dirname}{notes/phy452/}
%%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{Partition function, entropy, free energy, ideal gas, harmonic oscillator}
%
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{Some problems from Kittel chapter 3}
\label{chap:kittelChapter3}

\makeproblem{Classical gas partition function}{pr:kittelChapter3:0}{
\citep{kittel1980thermal} expresses the classical gas partition function (3.77) as

\begin{equation}\label{eqn:kittelChapter3:20}
Z_1 \propto \int \exp\left( - \frac{p_x^2 + p_y^2 + p_z^2 }{2 M \tau}
\right) dp_x dp_y dp_z
\end{equation}

Show that this leads to the expected \(3 \tau/2\) result for the thermal average energy.
} % makeproblem

\makeanswer{pr:kittelChapter3:0}{

Let's use the adjustment technique from the text for the \(N\) partition case and write

\begin{equation}\label{eqn:kittelChapter3:40}
Z_N = \inv{N!} Z_1^N,
\end{equation}

with \(Z_1\) as above.  This gives us

\begin{dmath}\label{eqn:kittelChapter3:60}
U
= \tau^2 \PD{\tau}{} \ln Z_N
= \tau^2 \PD{\tau}{} \left(
N \ln Z_1 - \ln N!
\right)
= N \tau^2 \PD{\tau}{\ln Z_1 }
= N \tau^2 \PD{\tau}{} \sum_{k = 1}^{3} \ln
\int \exp\left( - \frac{p_k^2 }{2 M \tau}
\right) dp_k
= N \tau^2
\sum_{k = 1}^{3}
\frac{
\PD{\tau}{} \int \exp\left( - \frac{p_k^2 }{2 M \tau} \right) dp_k
}
{
\int \exp\left( - \frac{p_k^2 }{2 M \tau} \right) dp_k
}
= N \tau^2
\sum_{k = 1}^{3}
\frac{
\PD{\tau}{} \sqrt{ 2 \pi M \tau }
}
{
\sqrt{ 2 \pi M \tau}
}
= 3 N \tau^2
\frac{
\inv{2} \tau^{-1/2}
}
{
\sqrt{ \tau}
}
= \frac{3}{2} N \tau
= \frac{3}{2} N \kB T
\end{dmath}

} % makeanswer

\makeoproblem{Two state system}{pr:kittelChapter3:1}{\citep{kittel1980thermal} problem 3.1}{
Find an expression for the free energy as a function of \(\tau\) of a system with two states, one at energy \(0\) and one at energy \(\epsilon\).  From the free energy, find expressions for the energy and entropy of the system.
 } % makeoproblem

\makeanswer{pr:kittelChapter3:1}{

Our partition function is

\begin{equation}\label{eqn:kittelChapter3:80}
Z = 1 + e^{-\epsilon /\tau}
\end{equation}

The free energy is just
\begin{dmath}\label{eqn:kittelChapter3:100}
F = -\tau \ln Z = -\tau \ln (1 + e^{-\epsilon/\tau})
\end{dmath}

The entropy follows immediately

\begin{dmath}\label{eqn:kittelChapter3:120}
\sigma
= -\PD{\tau}{F}
= \PD{\tau}{}
\lr{ \tau
\ln \lr{1 + e^{-\epsilon/\tau}}
}
=
\ln \lr{1 + e^{-\epsilon/\tau}}
-
\tau \epsilon \frac{-1}{\tau^2} \inv{1 + e^{-\epsilon/\tau}}
=
\ln \lr{1 + e^{-\epsilon/\tau}}
+
\frac{\epsilon}{\tau} \frac{e^{-\epsilon/\tau}}{1 + e^{-\epsilon/\tau}}
\end{dmath}

The energy is

\begin{dmath}\label{eqn:kittelChapter3:140}
U
= F + \tau \sigma
=
-\tau \ln (1 + e^{-\epsilon/\tau}) + \tau \sigma
=
\tau
\lr{
\cancel{\ln \lr{1 + e^{-\epsilon/\tau}}}
+
\frac{\epsilon}{\tau} \frac{e^{-\epsilon/\tau}}{1 + e^{-\epsilon/\tau}}
-\cancel{\ln (1 + e^{-\epsilon/\tau}) }
}
\end{dmath}

This is

\begin{equation}\label{eqn:kittelChapter3:160}
U
=
\frac{
\epsilon e^{-\epsilon/\tau}
}{1 + e^{-\epsilon/\tau}}
=
\frac{
\epsilon
}{1 + e^{\epsilon/\tau}}.
\end{equation}

% kittelCh3Problem1Plots.nb
These are all plotted in \cref{fig:kittelCh3Problem1Plots:kittelCh3Problem1PlotsFig1}.

\imageFigure{../../figures/phy452/kittelCh3Problem1PlotsFig1}{Plots for two state system}{fig:kittelCh3Problem1Plots:kittelCh3Problem1PlotsFig1}{0.2}

} % makeanswer

\makeoproblem{Magnetic susceptibility}{pr:kittelChapter3:2}{\citep{kittel1980thermal} problem 3.2}{

Use the partition function to find an exact expression for the magnetization \(M\) and the susceptibility \(\chi = dM/dB\) as a function of temperature and magnetic field for the model system of magnetic moments in a magnetic field.  The result for the magnetization, found by other means, was \(M = n m \tanh( m B/\tau)\), where \(n\) is the particle concentration.  Find the free energy and express the result as a function only of \(\tau\) and the parameter \(x = M/nm\).  Show that the susceptibility is \(\chi = n m^2/\tau\) in the limit \(m B \ll \tau\).

} % makeoproblem

\makeanswer{pr:kittelChapter3:2}{

Our partition function for a unit volume containing \(n\) spins is

\begin{equation}\label{eqn:kittelChapter3:180}
Z
=
\frac{
\lr{
e^{-m B/\tau}
+e^{m B/\tau}
}^n
}{
n!
}
=
2 \frac{
\lr{
\cosh\lr{m B/\tau}
}^n
}{
n!
}
,
\end{equation}

so that the Free energy is

\begin{equation}\label{eqn:kittelChapter3:200}
F = -\tau
\lr{
\ln 2 - \ln n! + n \ln \cosh\lr{m B/\tau}
}.
\end{equation}

The energy, magnetization and magnetic field were interrelated by

\begin{dmath}\label{eqn:kittelChapter3:220}
- M B = U
=
\tau^2 \PD{\tau}{}
\lr{-\frac{F}{\tau}}
=
\tau^2 n
\PD{\tau}{}
\ln \cosh\lr{m B/\tau}
=
\tau^2 n \frac{ -m B/\tau^2
\sinh
\lr{m B/\tau}
}{
\cosh
\lr{m B/\tau}
}
=
- m B n \tanh \lr{m B/\tau}.
\end{dmath}

This gives us

\begin{equation}\label{eqn:kittelChapter3:240}
M = m n \tanh \lr{m B/\tau},
\end{equation}

so that
\begin{equation}\label{eqn:kittelChapter3:260}
\chi = \frac{dM}{dB}
= \frac{m^2 n}{\tau \cosh^2 \lr{m B/\tau} }.
\end{equation}

For \(m B/\tau \ll 1\), the cosh term goes to unity, so we have

\begin{equation}\label{eqn:kittelChapter3:280}
\chi \approx
= \frac{m^2 n}{\tau},
\end{equation}

as desired.

With \(x = M/nm\), or \(m = M/nx\), the free energy is

\begin{equation}\label{eqn:kittelChapter3:201}
F =
-\tau
\lr{
\ln 2/n! + n \ln \cosh\lr{\frac{M B}{n x \tau}}
}
%=
%-\tau
%\lr{
%\ln 2/n! + n \ln \cosh\lr{\frac{U}{n x \tau}}
%}.
\end{equation}

That last expression isn't particularly illuminating.  What was the point of that substitution?
} % makeanswer

\makeoproblem{Free energy of a harmonic oscillator}{pr:kittelChapter3:3}{\citep{kittel1980thermal} problem 3.3}{

A one dimensional harmonic oscillator has an infinite series of equally spaced energy states, with \(\epsilon_s = s \Hbar \omega\), where \(s\) is a positive integer or zero, and \(\omega\) is the classical frequency of the oscillator.  We have chosen the zero of energy at the state \(s = 0\).  Show that for a harmonic oscillator the free energy is

\begin{equation}\label{eqn:kittelChapter3:300}
F = \tau \ln
\lr{ 1 - e^{-\Hbar \omega/\tau} }.
\end{equation}

Note that at high temperatures such that \(\tau \gg \Hbar \omega\) we may expand the argument of the logarithm to obtain \(F \approx \tau \ln (\Hbar \omega/\tau)\).  From \eqnref{eqn:kittelChapter3:300} show that the entropy is

\begin{equation}\label{eqn:kittelChapter3:320}
\sigma = \frac{\Hbar\omega/\tau}{e^{\Hbar \omega/\tau} - 1} -
\ln
\lr{1 - e^{-\Hbar \omega/\tau} }
\end{equation}

} % makeoproblem

\makeanswer{pr:kittelChapter3:3}{

I found it curious that this problem dropped the factor of \(\Hbar\omega/2\) from the energy.  Including it we have

\begin{equation}\label{eqn:kittelChapter3:340}
\epsilon_s = \lr{s + \inv{2}} \Hbar \omega,
\end{equation}

So that the partition function is

\begin{equation}\label{eqn:kittelChapter3:360}
Z
= \sum_{s = 0}^\infty e^{-\lr{s + \inv{2}} \Hbar \omega/\tau}
=
e^{-\Hbar \omega/2\tau}
\sum_{s = 0}^\infty e^{-s \Hbar \omega/\tau}.
\end{equation}

The free energy is

\begin{dmath}\label{eqn:kittelChapter3:380}
F
= -\tau \ln Z
= -\tau
\lr{
-\frac{\Hbar \omega}{2\tau}
+
\ln
\lr{
\sum_{s = 0}^\infty e^{-s \Hbar \omega/\tau}
}
}
=
\frac{\Hbar \omega}{2} +
\ln
\lr{
\sum_{s = 0}^\infty e^{-s \Hbar \omega/\tau}
}
\end{dmath}

We see that the contribution of the \(\Hbar \omega/2\) in the energy of each state just adds a constant factor to the free energy.  This will drop out when we compute the entropy.  Dropping that factor now that we know why it doesn't contribute, we can complete the summation, so have, by inspection

\begin{equation}\label{eqn:kittelChapter3:400}
F = -\tau \ln Z
=
\tau \ln
\lr{
1 - e^{-\Hbar \omega/\tau}
}.
\end{equation}

Taking derivatives for the entropy we have

\begin{dmath}\label{eqn:kittelChapter3:420}
\sigma = -\PD{\tau}{F}
=
-\ln
\lr{
1 - e^{-\Hbar \omega/\tau}
}
+
\tau
\frac{\Hbar \omega}{\tau^2} \frac{e^{-\Hbar \omega/\tau}}{
1 - e^{-\Hbar \omega/\tau}
}
=
-\ln
\lr{
1 - e^{-\Hbar \omega/\tau}
}
+
\frac{
\frac{\Hbar \omega}{\tau}
}{
e^{\Hbar \omega/\tau} - 1
}
\end{dmath}

} % makeanswer

\makeoproblem{Energy fluctuation}{pr:kittelChapter3:4}{\citep{kittel1980thermal} problem 3.4}{

Consider a system of fixed volume in thermal contact with a reservoir.  Show that the mean square fluctuation in the energy of the system is

\begin{equation}\label{eqn:kittelChapter3:440}
\expectation{ (\epsilon - \expectation{\epsilon})^2 } = \tau^2
\lr{\PD{\tau}{U}}_V
\end{equation}

Here \(U\) is the conventional symbol for \(\expectation{\epsilon}\).  Hint: Use the partition function \(Z\) to relate \(\PDi{t}{U}\) to the mean square fluctuation.  Also, multiply out the term \((\cdots)^2\).

} % makeoproblem

\makeanswer{pr:kittelChapter3:4}{

With a probability of finding the system in state \(s\) of

\begin{equation}\label{eqn:kittelChapter3:500}
P_s = \frac{e^{-\epsilon_s/\tau}}{Z}
\end{equation}

the average energy is

\begin{dmath}\label{eqn:kittelChapter3:460}
U
= \expectation{\epsilon}
= \sum_s P_s \epsilon_s
= \sum_s \epsilon_s \frac{e^{-\epsilon_s/\tau}}{Z}
= \inv{Z} \sum_s \epsilon_s e^{-\epsilon_s/\tau}
\end{dmath}

So we have

\begin{dmath}\label{eqn:kittelChapter3:480}
\tau^2 \PD{\tau}{U}
= -\frac{\tau^2}{Z^2} \frac{dZ}{d\tau}
\sum_s \epsilon_s e^{-\epsilon_s/\tau}
+ \frac{\tau^2}{Z}
\sum_s \frac{\epsilon_s^2}{\tau^2} e^{-\epsilon_s/\tau}
= -\frac{\tau^2}{Z^2} \frac{dZ}{d\tau}
\sum_s \epsilon_s e^{-\epsilon_s/\tau}
+ \inv{Z}
\sum_s \epsilon_s^2 e^{-\epsilon_s/\tau}.
\end{dmath}

But

\begin{dmath}\label{eqn:kittelChapter3:520}
\frac{dZ}{d\tau}
=
\frac{d}{d\tau} \sum_s e^{-\epsilon_s/\tau}
=
\sum_s \frac{\epsilon_s}{\tau^2} e^{-\epsilon_s/\tau},
\end{dmath}

giving

\begin{dmath}\label{eqn:kittelChapter3:540}
\tau^2 \PD{\tau}{U}
=
\frac{1}{Z^2}
\sum_s \epsilon_s e^{-\epsilon_s/\tau} \sum_s \epsilon_s e^{-\epsilon_s/\tau}
+ \inv{Z}
\sum_s \epsilon_s^2 e^{-\epsilon_s/\tau}
=
-\expectation{ \epsilon }^2 + \expectation{\epsilon^2},
\end{dmath}

which shows \eqnref{eqn:kittelChapter3:440} as desired.
} % makeanswer


%\EndArticle
