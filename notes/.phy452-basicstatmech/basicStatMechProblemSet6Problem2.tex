%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Fugacity expansion}{basicStatMech:problemSet6:2}{\citep{pathriastatistical} Pathria, Appendix D, E}{
%(3 points)
The theory of the ideal Fermi or Bose gases often involves integrals of the form

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:20}
f_\nu^\pm(z) = \inv{\Gamma(\nu)} \int_0^\infty dx \frac{x^{\nu - 1}}{z^{-1} e^x \pm 1}
\end{dmath}

where

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:40}
\Gamma(\nu) = \int_0^\infty dy y^{\nu-1} e^{-y}
\end{dmath}

denotes the gamma function.

\makesubproblem{}{basicStatMech:problemSet6:2a}
Obtain the behavior of \(f_\nu^\pm(z)\) for \(z \rightarrow 0\) keeping the two leading terms in the expansion.

\makesubproblem{}{basicStatMech:problemSet6:2b}
For Fermions, obtain the behavior of \(f_\nu^\pm(z)\) for \(z \rightarrow \infty\) again keeping the two leading terms.

\makesubproblem{}{basicStatMech:problemSet6:2c}
For Bosons, we must have \(z \le 1\) (why?), obtain the leading term of \(f_\nu^-(z)\) for \(z \rightarrow 1\).
} % makeoproblem

\makeanswer{basicStatMech:problemSet6:2}{
\makeSubAnswer{}{basicStatMech:problemSet6:2a}

For \(z \rightarrow 0\) we can rewrite the integrand in a form that allows for series expansion

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:60}
\frac{x^{\nu - 1}}{z^{-1} e^x \pm 1}
=
\frac{z e^{-x} x^{\nu - 1}}{1 \pm z e^{-x}}
=
z e^{-x} x^{\nu - 1}
\lr{1
\mp z e^{-x}
+ (z e^{-x})^2
\mp (z e^{-x})^3
+
\cdots
}
\end{dmath}

For the \(k\)th power of \(z e^{-x}\) in this series our integral is

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:80}
\int_0^\infty dx z e^{-x} x^{\nu - 1} (z e^{-x})^k
=
z^{k+1}
\int_0^\infty dx x^{\nu - 1} e^{-(k + 1) x}
=
\frac{z^{k+1}}{(k+1)^\nu}
\int_0^\infty du u^{\nu - 1} e^{- u}
=
\frac{z^{k+1}}{(k+1)^\nu} \Gamma(\nu)
\end{dmath}

Putting everything back together we have for small \(z\)

\boxedEquation{eqn:basicStatMechProblemSet6Problem2:100}{
f_\nu^\pm(z) =
z
\mp
\frac{z^{2}}{2^\nu}
+
\frac{z^{3}}{3^\nu}
\mp
\frac{z^{4}}{4^\nu}
+
\cdots
}

\makeSubAnswer{}{basicStatMech:problemSet6:2b}

We'll expand \(\Gamma(\nu) f_\nu^+(e^y)\) about \(z = e^y\), writing

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:340}
F_\nu(e^y)
=
\Gamma(\nu) f_\nu^+(e^y)
=
\int_0^\infty dx \frac{x^{\nu - 1}}{e^{x - y} + 1}
=
\int_0^y dx \frac{x^{\nu - 1}}{e^{x - y} + 1}
+
\int_y^\infty dx \frac{x^{\nu - 1}}{e^{x - y} + 1}.
\end{dmath}

The integral has been split into two since the behavior of the exponential in the denominator is quite different in the \(x < y\) and \(x > y\) ranges.  Observe that in the first integral we have

\begin{equation}\label{eqn:basicStatMechProblemSet6Problem2:260}
\inv{2} \le \frac{1}{e^{x - y} + 1} \le \inv{1 + e^{-y}}.
\end{equation}

Since this term is of order 1, let's consider the difference of this from \(1\), writing

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:280}
\frac{1}{e^{x - y} + 1} = 1 + u,
\end{dmath}

or
\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:220}
u
=
\frac{1}{e^{x - y} + 1} - 1
=
\frac{
1 -(
e^{x - y} + 1
)
}
{
e^{x - y} + 1
}
=
\frac{
-e^{x - y}
}
{
e^{x - y} + 1
}
=
-
\frac{
1
}
{
1 + e^{y - x}
}.
\end{dmath}

This gives us
\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:120}
F_\nu(e^y)
=
\int_0^y dx x^{\nu - 1} \lr{
1 -
\frac{ 1 } { 1 + e^{y - x} }
}
+
\int_y^\infty dx \frac{x^{\nu - 1}}{e^{x - y} + 1}
=
\frac{y^\nu}{\nu}
-
\int_0^y dx
\frac{
x^{\nu - 1}
 } { 1 + e^{y - x} }
+
\int_y^\infty dx \frac{x^{\nu - 1}}{e^{x - y} + 1}.
\end{dmath}

Now let's make a change of variables \(a = y - x\) in the first integral and \(b = x - y\) in the second.  This gives

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:320}
F_\nu(e^y)
=
\frac{y^\nu}{\nu}
-
\int_0^\infty da
\frac{
(y - a)^{\nu - 1}
 } { 1 + e^{a} }
+
\int_0^\infty db \frac{(y + b)^{\nu - 1}}{e^{b} + 1}.
\end{dmath}

As \(a\) gets large in the first integral the integrand is approximately \(e^{-a} (y-a)^{\nu -1}\).  The exponential dominates this integrand.  Since we are considering large \(y\), we can approximate the upper bound of the integral by extending it to \(\infty\).  Also expanding in series we have

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:360}
F_\nu(e^y)
\approx
\frac{y^\nu}{\nu}
+
\int_0^\infty da
\frac{
(y + a)^{\nu - 1}
-
(y - a)^{\nu - 1}
 } { 1 + e^{a} }
=
\frac{y^\nu}{\nu}
+
\int_0^\infty da \inv{e^a + 1}
\lr{
   \lr{
   \inv{0!} y^{\nu-1} a^0
   +
   \inv{1!} (\nu-1) y^{\nu-2} a^1
   +
   \inv{2!} (\nu-1) (\nu-2) y^{\nu-3} a^2
   + \cdots
   }
-
   \lr{
   \inv{0!} y^{\nu-1} (-a)^0
   +
   \inv{1!} (\nu-1) y^{\nu-2} (-a)^1
   +
   \inv{2!} (\nu-1) (\nu-2) y^{\nu-3} (-a)^2
   + \cdots
   }
}
=
\frac{y^\nu}{\nu}
+ 2
\int_0^\infty da \inv{e^a + 1}
   \lr{
   \inv{1!} (\nu-1) y^{\nu-2} a^1
   +
   \inv{3!} (\nu-1) (\nu-2) (\nu - 3)y^{\nu-4} a^3
   + \cdots
   }
=
\frac{y^\nu}{\nu}
+ 2
\sum_{j = 1, 3, 5, \cdots} \frac{y^{\nu - 1 - j}}{j!}
\lr{
\prod_{k = 1}^j (\nu-k)
}
\int_0^\infty da \frac{a^j}{e^a + 1}
=
\frac{y^\nu}{\nu}
+ 2
\sum_{j = 1, 3, 5, \cdots} \frac{y^{\nu - 1 - j}}{j!}
\frac{ \Gamma(\nu) } {\Gamma(\nu - j)}
\int_0^\infty da \frac{a^j}{e^a + 1}.
\end{dmath}

For the remaining integral, we find in \nbref{basicStatMechProblemSet6Problem2.nb}

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:380}
\int_0^\infty da \frac{a^j}{e^a + 1}
%=
%2^{-j} \left(2^j-1\right) j! \zeta (j+1)
=
\left( 1 - 2^{-j} \right) j! \zeta (j+1),
\end{dmath}

where for \(s > 1\)

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:400}
\zeta(s) = \sum_{k=1}^{\infty} k^{-s}.
\end{dmath}

This gives

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:420}
F_\nu(e^y)
\approx
\frac{y^\nu}{\nu}
+ 2
\sum_{j = 1, 3, 5, \cdots} y^{\nu - 1 - j}
\frac{ \Gamma(\nu) } {\Gamma(\nu - j)}
\left( 1 - 2^{-j} \right) \zeta(j+1),
\end{dmath}

or

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:440}
f_\nu^+(e^y) \approx
y^\nu
\lr{
\frac{1}{\nu \Gamma(\nu)}
+ 2
\sum_{j = 1, 3, 5, \cdots}
\frac{ 1 } {\Gamma(\nu - j)
y^{j + 1}
}
\left( 1 - 2^{-j} \right) \zeta(j+1)
}
=
\frac{y^\nu}{\Gamma(\nu + 1)}
\lr{
1
+ 2
\sum_{j = 1, 3, 5, \cdots}
\frac{ \Gamma(\nu + 1) } {\Gamma(\nu - j)
}
\left( 1 - 2^{-j} \right)
\frac{\zeta(j+1)}{ y^{j + 1} }
},
\end{dmath}

or
\boxedEquation{eqn:basicStatMechProblemSet6Problem2:460}{
f_\nu^+(e^y) \approx
\frac{y^\nu}{\Gamma(\nu + 1)}
\lr{
1
+ 2 \nu
\sum_{j = 1, 3, 5, \cdots}
(\nu-1) \cdots(\nu - j)
\left( 1 - 2^{-j} \right)
\frac{\zeta(j+1)}{ y^{j + 1} }
}.
}

Evaluating the numerical portions explicitly, with

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:480}
c(j) = 2 \left(1-2^{-j}\right) \zeta (j+1),
\end{dmath}

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:500}
\begin{aligned}
c(1) &= \frac{\pi^2}{6} \\
c(3) &= \frac{7 \pi^4}{360} \\
c(5) &= \frac{31 \pi^6}{15120} \\
c(7) &= \frac{127 \pi^8}{604800},
\end{aligned}
\end{dmath}

so to two terms (\(j = 1, 3\)), we have
\boxedEquation{eqn:basicStatMechProblemSet6Problem2:520}{
f_\nu^+(e^y) \approx
\frac{y^\nu}{\Gamma(\nu + 1)}
\lr{
1
+ \nu(\nu-1) \frac{\pi^2}{6 y^{2}}
+ \nu(\nu-1)(\nu-2)(\nu -3) \frac{7 \pi^4}{360 y^4}
}.
}

\makeSubAnswer{}{basicStatMech:problemSet6:2c}

In order for the Boson occupation numbers to be non-singular we require \(\mu\) less than all \(\epsilon\).  If that lowest energy level is set to zero, this is equivalent to \(z < 1\).  Given this restriction, a \(z = e^{-\alpha}\) substitution is convenient for investigation of the \(z \rightarrow 1\) case.  Following the text, we'll write

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:540}
G_\nu(e^{-\alpha})
=
\Gamma(\nu)
f_\nu^-(e^{-\alpha})
=
\int_0^\infty dx \frac{x^{\nu - 1}}{e^{x + \alpha} - 1}.
\end{dmath}

For \(\nu = 1\), this is integrable

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:560}
\frac{d}{dx} \ln\lr{ 1 - e^{-x - \alpha} }
=
\frac{e^{-x - \alpha}}
{ 1 - e^{-x - \alpha} }
=
\inv
{ e^{x + \alpha} - 1},
\end{dmath}

so that
\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:580}
G_1(e^{-\alpha})
=
\int_0^\infty dx \frac{1}{e^{x + \alpha} - 1}
=
\evalrange{
\ln \lr{1 - e^{-x - \alpha} }
}{0}{\infty}
=
\ln 1
- \ln
\lr{1 - e^{- \alpha} }
=
-\ln \lr{1 - e^{- \alpha} }.
\end{dmath}

Taylor expanding \(1 - e^{-\alpha}\) we have

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:600}
1 - e^{-\alpha} = 1 - \lr{ 1 - \alpha + \alpha^2/2 - \cdots}.
\end{dmath}

Noting that \(\Gamma(1) = 1\), we have for the limit

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:640}
\lim_{\alpha \rightarrow 0} G_1(e^{-\alpha})
\rightarrow - \ln \alpha,
%= \ln (1/\alpha)
\end{dmath}

or
\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:620}
\lim_{z\rightarrow 1} f_\nu^-(z)
= -\ln (-\ln z).
\end{dmath}

For values of \(\nu \ne 1\), the denominator is

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:660}
e^{\alpha + x} - 1
= (\alpha + x) + (\alpha + x)^2/2 + \cdots
\end{dmath}

To first order this gives us

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:680}
f_\nu^-( e^{-\alpha} )
\approx
\inv{\Gamma(\nu)}
\int_0^\infty dx \frac{1}{x + \alpha}.
\end{dmath}

Of this integral Mathematica says it can be evaluated for \(0 < \nu < 1\), and has the value

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:700}
\inv{\Gamma(\nu)}
\int_0^\infty dx \frac{1}{x + \alpha}
=
\frac{\pi}{\sin(\pi\nu)} \frac{1}{\alpha^{1 - \nu} \Gamma (\nu )}.
\end{dmath}

From \citep{abramowitz1964handbook} 6.1.17 we find

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:720}
\Gamma(z) \Gamma(1-z) = \frac{\pi}{\sin(\pi z)},
\end{dmath}

with which we can write

\boxedEquation{eqn:basicStatMechProblemSet6Problem2:740}{
f_\nu^-( e^{-\alpha} )
\approx
\frac{ \Gamma(1 - \nu)}{ \alpha^{1 - \nu} }.
}
}
