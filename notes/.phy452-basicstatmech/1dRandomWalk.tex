%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{1dRandomWalk}
%\renewcommand{\dirname}{notes/phy452/}
%%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{Statistical mechanics, PHY452H1S, random walk, mean, second moment, average, binomial distribution}
%
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{One dimensional random walk}
%\chapter{One dimensional random walk}
\label{chap:1dRandomWalk}

\makeoproblem{One dimensional random walk}{pr:1dRandomWalk:1}{2013 midterm 1, problem 2}{
Random walk in 1D by unit steps.  With the probability to go right of \(p\) and a probability to go left of \(1 -p\) what are the first two moments of the final position of the particle?
} % makeoproblem

\makeanswer{pr:1dRandomWalk:1}{
%This was a problem from the first midterm.  I ran out of time and didn't take the answer as far as I figured I should have.  Here's a more casual bash at the problem.

First we need the probabilities.

\paragraph{One step: \(N = 1\)}

Our distance (from the origin) can only be \(X = \pm 1\).

\begin{equation}\label{eqn:1dRandomWalk:20}
P_{X = -1} = p^{0} (1 -p)^1
\end{equation}
\begin{equation}\label{eqn:1dRandomWalk:40}
P_{X = 1} = p^1 (1-p)^{1 - 1}
\end{equation}

\paragraph{Two steps: \(N = 2\)}

We now have three possibilities

\begin{equation}\label{eqn:1dRandomWalk:60}
P_{X = -2} = p^{0} (1 -p)^{2 - 0}
\end{equation}
\begin{equation}\label{eqn:1dRandomWalk:80}
P_{X = 0} = 2 p^1 (1-p)^{2 - 1}
\end{equation}
\begin{equation}\label{eqn:1dRandomWalk:100}
P_{X = 2} = p^2 (1-p)^{2 - 2}
\end{equation}

\paragraph{Three steps: \(N = 3\)}

We now have three possibilities

\begin{equation}\label{eqn:1dRandomWalk:120}
P_{X = -3} = p^{0} (1 - p)^{3 - 0}
\end{equation}
\begin{equation}\label{eqn:1dRandomWalk:140}
P_{X = -1} = 3 p^1 (1 - p)^{3 - 1}
\end{equation}
\begin{equation}\label{eqn:1dRandomWalk:160}
P_{X = 1} = 3 p^2 (1 - p)^{3 - 2}
\end{equation}
\begin{equation}\label{eqn:1dRandomWalk:180}
P_{X = 3} = p^3 (1-p)^{3 - 3}
\end{equation}

\paragraph{General case}

The pattern is pretty clear, but we need a mapping from the binomial index to the the final distance.  With an index \(k\), and a guess

\begin{equation}\label{eqn:1dRandomWalk:200}
D(k) = a k + b,
\end{equation}

where

\begin{equation}\label{eqn:1dRandomWalk:220}
D(0) = -N = b
\end{equation}
\begin{equation}\label{eqn:1dRandomWalk:240}
D(N) = a N + b = (a - 1)N = N.
\end{equation}

So
\begin{equation}\label{eqn:1dRandomWalk:260}
D(k) = 2 k - N,
\end{equation}

and

\begin{equation}\label{eqn:1dRandomWalk:280}
k = \frac{D + N}{2}.
\end{equation}

Our probabilities are therefore

\boxedEquation{eqn:1dRandomWalk:300}{
P_{X = D} = \binom{N}{(N + D)/2}
p^{(N + D)/2}
(1 - p)^{(N - D)/2}.
}

\paragraph{First moment}

For the expectations let's work with \(k\) instead of \(D\), so that the expectation is

\begin{dmath}\label{eqn:1dRandomWalk:320}
\expectation{X}
= \sum_{k = 0}^N (2 k - N) \binom{N}{k} p^k (1 - p)^{N - k}
= 2 \sum_{k = 0}^N k \frac{N!}{(N-k)!k!} p^k (1 - p)^{N - k} - N
= 2 N p \sum_{k = 1}^N \frac{(N-1)!}{(N - 1 - (k - 1))!(k-1)!} p^{k-1} (1 - p)^{N - 1 - (k - 1)} - N
= 2 N p \sum_{s = 0}^{N-1} \binom{N-1}{s} p^{s} (1 - p)^{N -1 - s} - N.
\end{dmath}

This gives us

\boxedEquation{eqn:1dRandomWalk:340}{
\expectation{X}
= N( 2 p - 1 ).
}

\paragraph{Second moment}
\begin{dmath}\label{eqn:1dRandomWalk:360}
\expectation{X^2}
= \sum_{k = 0}^N (2 k - N)^2 \binom{N}{k} p^k (1 - p)^{N - k}
= 4 \sum_{k = 0}^N k^2 \binom{N}{k} p^k (1 - p)^{N - k}
- 4 N^2 p
+ N^2
= 4 N p \sum_{k = 1}^N k \frac{(N-1)!}{(N - 1 - (k - 1))! (k-1)!} p^{k-1} (1 - p)^{N - k} + N^2(1 - 4 p)
= 4 N p \sum_{s = 0}^N (s + 1) \frac{(N-1)!}{(N - 1 - s)! s!} p^s (1 - p)^{N - 1 - s} + N^2(1 - 4 p)
= 4 N p ((N-1) p + 1) + N^2(1 - 4 p)
= N^2 ( 1 - 4 p + 4 p^2 ) + 4 N p ( 1 - p ).
\end{dmath}

So the second moment is

\boxedEquation{eqn:1dRandomWalk:380}{
\expectation{X^2} = N^2 ( 1 - 2 p )^2 + 4 N p ( 1 - p )
}

From this we see that the variance is just this second term

\begin{equation}\label{eqn:1dRandomWalk:400}
\sigma^2 = \expectation{X^2} - \expectation{X}^2 = 4 N p ( 1 - p ).
\end{equation}

} % makeanswer

%\EndNoBibArticle
