%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Binomial distribution for biased coin}{basicStatMech:problemSet1:2}{2013 problem set 1, q2}{
Consider the more general case of a binomial distribution where the probability of a head is \(r\) and a tail is \((1 - r)\) (a biased coin).  With \(\text{head} = -1\) and \(\text{tail} = +1\), obtain the binomial distribution \(P_N(r,X)\) for obtaining a total of \(X\) from \(N\) coin tosses.  What is the limiting form of this distribution when \(N \gg 1\) and \(\expectation{X - \expectation{X}} \ll N\)?  The latter condition simply means that I need to carry out any Taylor expansions in X about its mean value \(\expectation{X}\). The mean \(\expectation{X}\) can be easily computed first in terms of ``r''.
} % makeoproblem

\makeanswer{basicStatMech:problemSet1:2}{

Let's consider 1, 2, 3, and N tosses in sequence to understand the pattern.

\paragraph{1 toss}

The base case has just two possibilities

\begin{itemize}
\item Heads, \(P = r\), \(X = -1\)
\item Tails, \(P = (1 - r)\), \(X = 1\)
\end{itemize}

If \(k = 0,1\) for \(X = -1, 1\) respectively, we have

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:20}
P_1(r, X) = r^{1 - k} (1 - r)^{k}
\end{dmath}

As a check, when \(r = 1/2\) we have \(P_1(X) = 1/2\)

\paragraph{2 tosses}

Our sample space is now a bit bigger

\begin{itemize}
\item \((h,h)\), \(P = r^2\), \(X = -2\)
\item \((h,t)\), \(P = r (1 - r)\), \(X = 0\)
\item \((t,h)\), \(P = r (1 - r)\), \(X = 0\)
\item \((t,t)\), \(P = (1 - r)^2\), \(X = 2\)
\end{itemize}

Here \(P\) is the probability of the ordered sequence, but we are interested only in the probability of each specific value of \(X\).  For \(X = 0\) there are \(\binom{2}{1} = 2\) ways of picking a heads, tails combination.

Enumerating the probabilities, as before, with \(k = 0, 1, 2\) for \(X = -1, 0, 1\) respectively, we have

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:40}
P_2(r, X) = r^{2 - k} (1 - r)^{k} \binom{2}{k}
\end{dmath}

\paragraph{3 tosses}

Increasing our sample space by one more toss our possibilities for all ordered triplets of toss results is

\begin{itemize}
\item \((h,h,h)\), \(P = r^3\), \(X = -3\)
\item \((h,h,t)\), \(P = r^2(1 - r)\), \(X = -1\)
\item \((h,t,h)\), \(P = r^2(1 - r)\), \(X = -1\)
\item \((h,t,t)\), \(P = r(1 - r)^2\), \(X = 1\)
\item \((t,h,h)\), \(P = r^2(1 - r)\), \(X = -1\)
\item \((t,h,t)\), \(P = r(1 - r)^2\), \(X = 1\)
\item \((t,t,h)\), \(P = r(1 - r)^2\), \(X = 1\)
\item \((t,t,t)\), \(P = r (1 - r)\), \(X = 0\)
\item \((t,t,t)\), \(P = (1 - r)^3\), \(X = 3\)
\end{itemize}

Here \(P\) is the probability of the ordered sequence, but we are still interested only in the probability of each specific value of \(X\).  We see that we have
\(\binom{3}{1} = \binom{3}{2} = 3\) ways of picking some ordering of either \((h,h,t)\) or \((t,t,h)\)

Now enumerating the possibilities with \(k = 0, 1, 2, 3\) for \(X = -3, -1, 1, 3\) respectively, we have

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:50}
P_3(r, X) = r^{3 - k} (1 - r)^{k} \binom{3}{k}
\end{dmath}

\paragraph{n tosses}

To generalize we need a mapping between our random variable \(X\), and the binomial index \(k\), but we know what that is from the fair coin problem, one of \((N-X)/2\) or \((N + X)/2\).  To get the signs right, let's evaluate \((N \pm X)/2\) for \(N = 3\) and \(X \in \{3, -1, 1, 3\}\)

\captionedTable{Mapping between \(k\) and \((N \pm X)/2\) for \(N = 3\)}{tab:basicStatMechProblemSet1Problem2:1}{
\begin{tabular}{|l|l|l|}
\hline
\(X\) & \(\frac{N-X}{2}\) & \(\frac{N+X}{2}\) \\ \hline
-3 & 3 & 0 \\ 
-1 & 2 & 1 \\ 
1 & 1 & 2 \\  
3 & 0 & 3 \\ \hline
\end{tabular}
}

Using this, we see that the generalization to unfair coins of the binomial distribution is

\boxedEquation{eqn:basicStatMechProblemSet1Problem2:70}{
P_N(r, X) = r^{\frac{N-X}{2}} (1 - r)^{\frac{N+X}{2}} \frac{N!}{
\left(
\frac{N + X}{2}
\right)!
\left(
\frac{N - X}{2}
\right)!
}
}

Checking against the fair result, we see that we have the \(1/2^N\) factor when \(r = 1/2\) as expected.  Let's check for \(X = -1\) (two heads, one tail) to see if the exponents are right.  That is

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:90}
P_3(r, -1)
= r^{\frac{3 + 1}{2}} (1 - r)^{\frac{3 - 1}{2}} \frac{3!}{
\left(
\frac{3 - 1}{2}
\right)!
\left(
\frac{3 + 1}{2}
\right)!
}
=
r^2 (1-r) \frac{3!}{1! 2!}
= r^2 (1 - r)
\end{dmath}

Good, we've got a \(r^2\) (two heads) term as desired.

\paragraph{Limiting form}

%We can express \(P_N(r, X)\) in terms of \(P_N(X) = P_N(1/2, X)\).  This is
%
%\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:110}
%P_N(r, X) = 2^N r^{\frac{N-X}{2}} (1 - r)^{\frac{N+X}{2}} P_N(X).
%\end{dmath}
%
%Using the previous fair coin Gaussian approximation we have
%
%\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:130}
%P_N(r, X)
%\approx
%2^N r^{\frac{N-X}{2}} (1 - r)^{\frac{N+X}{2}}
%\frac{2}{\sqrt{2 \pi N}} e^{ -\frac{X^2}{2 N} }
%\end{dmath}
%
%For \(N \gg X\) we have
%
%\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:150}
%P_N(r, X)
%\approx
%2^{N} \sqrt{
%\frac{
%2 r^{N} (1 - r)^{N}
%}{\pi N}}
%e^{ -\frac{X^2}{2 N} }
%\end{dmath}

To determine the limiting behavior, we can utilize the Central limit theorem.  We first have to calculate the mean and the variance for the \(N=1\) case.  The first two moments are

\begin{subequations}
\begin{equation}\label{eqn:basicStatMechProblemSet1Problem2:170}
\expectation{X} = -1 r + 1 (1-r) = 1 - 2 r
\end{equation}
\begin{equation}\label{eqn:basicStatMechProblemSet1Problem2:190}
\expectation{X^2} = (-1)^2 r + 1^2 (1-r) = 1
\end{equation}
\end{subequations}

and the variance is
\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:210}
\expectation{X^2} -\expectation{X}^2
= 1 - (1 - 2r)^2
= 1 - ( 1 - 4 r + 4 r^2 )
= 4 r - 4 r^2
= 4 r ( 1 - r )
\end{dmath}

The Central Limit Theorem gives us

\begin{equation}\label{eqn:basicStatMechProblemSet1Problem2:230}
P_N(r, X) \rightarrow \inv{ \sqrt{8 \pi N r (1 - r) }} \exp
\left(
- \frac{( X - N (1 - 2 r) )^2}{8 N r ( 1 - r )}
\right),
\end{equation}

however, we saw in \citep{peterYoungClt} that this theorem was derived for continuous random variables.  Here we have random variables that only take on either odd or even integer values, with parity depending on whether \(N\) is odd or even.  We'll need to double the CLT result to account for this.  This gives us

\boxedEquation{eqn:basicStatMechProblemSet1Problem2:240}{
P_N(r, X) \rightarrow \frac{1}{ \sqrt{2 \pi N r (1 - r) }} \exp
\left(
- \frac{( X - N (1 - 2 r) )^2}{8 N r ( 1 - r )}
\right)
}

As a check we note that for \(r = 1/2\) we have \(r(1-r) = 1/4\) and \(1 - 2r = 0\), so we get

\begin{equation}\label{eqn:basicStatMechProblemSet1Problem2:250}
P_N(1/2, X) \rightarrow \frac{2}{ \sqrt{2 \pi N }} \exp
\left(
- \frac{ X^2}{2 N }
\right).
\end{equation}

Observe that both this and \eqnref{eqn:basicStatMechProblemSet1Problem1:180} do not integrate to unity, but to \(2\).  This is expected given the parity of the discrete random variable \(X\).  An integral normalization check is really only approximating the sum over integral values of our discrete random variable, and here we want to skip half of those values.
%That was a whole lot easier than attempting to evaluate the limit of \(P_N(X)\) directly (I should have done the Central Limit Theorem reading before attempting that problem)!
%
}
