%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%
\label{chap:PJTongMf1}
%\date{August 25, 2008.  tongMf1.tex}

These are my solutions to David Tong's mf1 \citep{TongMf1} problem set
(Lagrangian problems) associated with his excellent
and freely available online text \citep{TongClas}.

\makeproblem{Euler-Lagrange equations for purely kinetic system (problem 1)}{tongmf1:pr1}{

Derive the Euler-Lagrange equations for

\begin{equation}
\LL = \inv{2} \sum  g_{a b}(q_c) \qdot^a \qdot^b
\end{equation}
}

\makeanswer{tongmf1:pr1}{

I found it helpful to clarify for myself what was meant by \(g_{ab}(q^c)\).  This is a function of all the generalized coordinates:

\begin{equation*}
g_{ab}(q^c) = g_{ab}( q^1, q^2, \ldots, q^N ) = g_{ab}(\Bq)
\end{equation*}

So I think that a vector parameter reminder is helpful.

\begin{equation*}
\LL = \inv{2} \sum  g_{b c}(\Bq) \qdot^b \qdot^c
\end{equation*}

\begin{equation}\label{eqn:tong_mf1:left}
\PD{q^a}{\LL} = \inv{2} \sum \qdot^b \qdot^c \PD{q^a}{g_{b c}(\Bq)}
\end{equation}

Now, proceed to calculate the generalize momentums:
\begin{equation}\label{eqn:tongMf1:20}
\begin{aligned}
\PD{\qdot^a}{\LL}
&= \inv{2} \sum g_{b c}(\Bq) \PD{\qdot^a}{
\lr{ \qdot^b \qdot^c }
} \\
&= \inv{2} \sum g_{a c}(\Bq) \qdot^c + g_{b a}(\Bq) \qdot^b \\
&= \sum g_{a b}(\Bq) \qdot^b \\
\end{aligned}
\end{equation}

For
\begin{equation}\label{eqn:tong_mf1:right}
\frac{d}{dt} \PD{\qdot^a}{\LL} = \sum \PD{q^d}{ g_{a b} } \qdot^d \qdot^b + g_{b a} \qddot^b
\end{equation}

Taking the difference of \eqnref{eqn:tong_mf1:left} and \eqnref{eqn:tong_mf1:right} we have:
\begin{equation}\label{eqn:tongMf1:40}
\begin{aligned}
0
&= \sum \inv{2} \qdot^b \qdot^c \PD{q^a}{g_{b c}} - \PD{q^d}{g_{a b}} \qdot^d \qdot^b - g_{b a} \qddot^b \\
&= \sum \qdot^b \qdot^c \left( \inv{2} \PD{q^a}{g_{b c}} - \PD{q^c}{g_{a b}} \right) - g_{b a} \qddot^b \\
&= \sum \qdot^b \qdot^c \left( -\inv{2} \PD{q^a}{g_{b c}} +\inv{2} \PD{q^c}{g_{a b}} +\inv{2} \PD{q^c}{g_{a b}} \right) + g_{b a} \qddot^b \\
&= \sum \inv{2} \qdot^b \qdot^c \left( -\PD{q^a}{g_{b c}} +\PD{q^c}{g_{a b}} +\PD{q^b}{g_{a c}} \right) + g_{b a} \qddot^b \\
\end{aligned}
\end{equation}

Here a split of the symmetric expression

\begin{equation*}
X = \sum \qdot^b \qdot^c \PD{q^c}{g_{a b}} = \inv{2}(X + X),
\end{equation*}

was used, and then an interchange of dummy indices \(b,c\).

Now multiply this whole sum by \(g^{b a}\), and sum to remove the metric term from the generalized acceleration

\begin{equation}\label{eqn:tongMf1:60}
\begin{aligned}
\sum g^{d a} g_{b a} \qddot^b &= -\inv{2} \sum \qdot^b \qdot^c g^{d a} \left( - \PD{q^a}{g_{b c}} + \PD{q^c}{g_{a b}} + \PD{q^b}{g_{a c}} \right) \\
\sum {\delta^d}_b \qddot^b &= \\
\qddot^d &= \\
\end{aligned}
\end{equation}

Swapping \(a\), and \(d\) indices to get form stated in the problem we have

\begin{equation}\label{eqn:tongMf1:80}
\begin{aligned}
0
&= \qddot^a + \inv{2} \sum \qdot^b \qdot^c g^{a d} \left( - \PD{q^d}{g_{b c}} + \PD{q^c}{g_{d b}} + \PD{q^b}{g_{d c}} \right) \\
&= \qddot^a + \sum \qdot^b \qdot^c {\Gamma^a}_{b c} \\
{\Gamma^a}_{b c} &= \inv{2} g^{a d} \left( - \PD{q^d}{g_{b c}} + \PD{q^c}{g_{d b}} + \PD{q^b}{g_{d c}} \right)
\end{aligned}
\end{equation}

%Aside: Having typed this up, while correcting errors, some wholescale index replacements to simplify, I wonder with all these indices flying around
%how any mathematician previously did tensor algebra without a
%text editor that has a regular expression interface (easier than on paper).
}

\makeproblem{An alternate Lagrangian with same equations of motion (problem 2)}{tongmf1:pr2}{
%
%\begin{equation*}
%\LL = \inv{12}m^2 \xdot^4 - m \xdot^2 V + V^2
%\end{equation*}
%
%\begin{align*}
%\frac{\partial L}{\partial x} &= \frac{d}{dt} \frac{\partial L}{\partial \xdot} \\
%-m \xdot^2 V_x + 2V V_x &= \frac{d}{dt} \left( \inv{3}m^2 \xdot^3 - 2 m \xdot V \right) \\
%                        &= m^2 \xdot^2 \xddot - 2m \xddot V \\
%-(m \xdot^2 -2V) V_x    &= m \xddot (m \xdot^2 - 2 V) \\
%\end{align*}
%
%Cancelling left and right common factors:
%
%\begin{equation*}
%m \xddot = -\frac{\partial V}{\partial x}
%\end{equation*}
%
%THIS IS WRONG, since \(dV/dt \ne 0\).
%
%Although \(V(x)\) has no explicit time
%dependence on \(t\), \(x = x(t)\), so \(dV/dt = dV/dx dx/dt\).

\begin{equation}
\LL = \inv{12}m^2 \xdot^4 + m \xdot^2 V - V^2
\end{equation}
}

\makeanswer{tongmf1:pr2}{

Digging in

\begin{equation}\label{eqn:tongMf1:100}
\begin{aligned}
\frac{\partial L}{\partial x} &= \frac{d}{dt} \frac{\partial L}{\partial \xdot} \\
m \xdot^2 V_x - 2V V_x &= \frac{d}{dt} \left( \inv{3}m^2 \xdot^3 + 2 m \xdot V \right) \\
\end{aligned}
\end{equation}

When taking the time derivative of \(V\), \(dV/dt \ne 0\), despite no explicit time dependence.
Take an example, such as \(V = mgx\), where the positional parameter is dependent on time, so the chain rule is required:

\begin{equation*}
\frac{d V}{dt} = \frac{d V}{dx} \frac{dx}{dt} = \xdot V_x.
\end{equation*}

Perhaps that is obvious, but I made that mistake first doing this problem (which would have been harder to make if I had used an example potential) the first time.  I subsequently constructed an alternate Lagrangian
\(\lr{ \LL = \inv{12}m^2 \xdot^4 - m \xdot^2 V + V^2 }\)
that worked when this mistake was made, and emailed the author suggesting that I believed he had a sign typo in his problem set.

Anyways, continuing with the calculation:

\begin{equation}\label{eqn:tongMf1:120}
\begin{aligned}
m \xdot^2 V_x - 2V V_x &= m^2 \xdot^2 \xddot + 2m \xddot V + 2 m \xdot^2 V_x \\
m \xdot^2 V_x - 2V V_x - 2 m \xdot^2 V_x &= m \xddot
\lr{  m \xdot^2 + 2 V  }
 \\
-
\lr{  2V + m \xdot^2  }
 V_x &= \\
\end{aligned}
\end{equation}

Canceling left and right common factors, which perhaps not coincidentally equal \(2E = V + \inv{2}mv^2\) we have:

\begin{equation*}
m \xddot = -V_x
\end{equation*}

This is what we would get for our standard kinetic and position dependent Lagrangian too:

\begin{equation*}
\LL = \inv{2}m \xdot^2 - V
\end{equation*}

\begin{equation}\label{eqn:tongMf1:140}
\begin{aligned}
\frac{\partial L}{\partial x} &= \frac{d}{dt} \frac{\partial L}{\partial \xdot} \\
-V_x &= \frac{d (m \xdot) }{dt} \\
-V_x &= m \xddot
\end{aligned}
\end{equation}
}

\makeproblem{(problem 3)}{tongmf1:pr3}{

Derive the relativistic equations of motion for a point particle in a position dependent potential:

\begin{equation}
\LL = -m c^2 \sqrt{ 1 - \Bv^2/c^2} - V(\Br)
\end{equation}
}

\makeanswer{tongmf1:pr3}{

The first thing to observe here is that for \(\abs{\Bv} << c\), this is our familiar kinetic energy Lagrangian

\begin{equation}\label{eqn:tongMf1:160}
\begin{aligned}
\LL
&= -m c^2 \left( 1 - \inv{2}\Bv^2/c^2 + \inv{2}\inv{-2}\inv{2!}(\Bv/c)^4 + \cdots \right) - V(\Br) \\
&\approx  -m c^2 + \inv{2} m \Bv^2 - V(\Br) \\
\end{aligned}
\end{equation}

The constant term \(-mc^2\) will not change the equations of motion and we can perhaps think of this as an additional potential term (quite large as we see from atomic fusion and fission).  For small \(\Bv\) we recover the Newtonian Kinetic energy term, and therefore expect the results will be equivalent to the Newtonian equations in that limit.

Moving on to the calculations we have:
\begin{equation}\label{eqn:tongMf1:180}
\begin{aligned}
\frac{\partial L}{\partial x^i} &= \frac{d}{dt} \frac{\partial L}{\partial \xdot^i} \\
-\PD{x^i}{V}
&= -c^2 \frac{d}{dt} m \frac{\partial L}{\partial \xdot^i} \sqrt{ 1 - \sum
\lr{ \xdot^j }^2/c^2
} \\
&= -c^2 \frac{d}{dt} m \inv{2} \inv{ \sqrt{ 1 - \Bv^2/c^2}} \frac{\partial L}{\partial \xdot^i} \left({ 1 - \sum
\lr{ \xdot^j }^2/c^2
}\right) \\
&= -c^2 \frac{d}{dt} m \inv{2} \inv{ \sqrt{ 1 - \Bv^2/c^2}} (-2) \xdot^i/c^2 \\
&= \frac{d}{dt} m \inv{ \sqrt{ 1 - \Bv^2/c^2}} \xdot^i \\
&= \frac{d}{dt} m \gamma \xdot^i \\
\implies \\
- \left(\sum \Be_i \PD{x^i}{}\right) V &= \frac{d}{dt} m \gamma \sum \Be_i \xdot^i \\
- \grad V  &= \frac{d(m \gamma \Bv)}{dt} \\
\end{aligned}
\end{equation}

For \(v << c\), \(gamma \approx 1\), so we get our Newtonian result in the limiting case.

Now, I found this result very impressive result, buried in a couple line problem statement.  I subsequently used this as the starting point for guessing about how to formulate the Lagrange equations in a proper time form, as well as a proper velocity form for this Kinetic and potential term.  Those turn out to make it possible to express
Maxwell's law and the Lorentz force law together in a particularly nice compact covariant form.  This catches me a up a bit in terms of my understanding and think that I am now at least learning and rediscovering things known since the early 1900s;)
}

\makeproblem{Double pendulum (problem 4)}{tongmf1:pr4}{
Derive the Lagrangian for a double pendulum.
}

\makeanswer{tongmf1:pr4}{

First consider a single pendulum (fixed length \(l\)).

\begin{equation}\label{eqn:tongMf1:200}
\begin{aligned}
x &= l \exp(i\theta) \\
\xdot &= l i \dottheta \exp(i\theta) \\
\abs{\xdot}^2 &= l^2 \dottheta^2 \\
\end{aligned}
\end{equation}

Now, if \(\theta = 0\) represents the downwards position at rest, the height above that rest point is \(h = l - l \cos\theta\).  Therefore the Lagrangian is:

\begin{equation}\label{eqn:tongMf1:220}
\begin{aligned}
\LL
&= \inv{2} m v^2 - mgh \\
&= \inv{2} m l^2 \dottheta^2 - mg l (1 - \cos\theta) \\
\end{aligned}
\end{equation}

The constant term can be dropped resulting in the equivalent Lagrangian:

\begin{equation*}
\LL' = \inv{2} m l^2 \dottheta^2 + mg l \cos\theta
\end{equation*}

This amounts to a difference in the reference point for the potential energy, so
instead of measuring the potential energy \(V = m g h\) from a reference position below the mass, one could consider that the potential has a maximum of zero at the highest position, and decreases from there as:

\begin{equation*}
V' = 0 - m g l \cos\theta.
\end{equation*}

Moving back to the EOMs that result from either form of Lagrangian, we have after taking our derivatives:

\begin{equation*}
-m g l \sin\theta = \frac{d}{dt} m l^2 \dottheta = m l^2 \ddottheta
\end{equation*}

Or,

\begin{equation*}
\ddottheta = - g/l \sin\theta
\end{equation*}

This is consistent with our expectations, and recovers the familiar small angle SHM equation:

\begin{equation*}
\ddottheta \approx - g/l \theta.
\end{equation*}

Now, move on to the double pendulum, and compute the Kinetic energies of the two particles:

\begin{equation}\label{eqn:tongMf1:240}
\begin{aligned}
x_1 &= l_1 \exp(i\theta_1) \\
\xdot_1 &= l_1 i \dottheta_1 \exp(i\theta_1) \\
\abs{\xdot_1}^2 &= {l_1}^2 {\dottheta_1}^2 \\
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:tongMf1:260}
\begin{aligned}
x_2 &= x_1 + l_2 \exp(i\theta_2) \\
\xdot_2 &= \xdot_1 + l_2 i \dottheta_2 \exp(i\theta_2) \\
        &= l_1 i \dottheta_1 \exp(i\theta_1) + l_2 i \dottheta_2 \exp(i\theta_2) \\
\abs{\xdot_2}^2
&=
(l_1 \dottheta_1)^2 + (l_2 \dottheta_2)^2
+ l_1 i \dottheta_1 \exp(i\theta_1) l_2 (-i) \dottheta_2 \exp(-i\theta_2)
+ l_1 (-i) \dottheta_1 \exp(-i\theta_1) l_2 i \dottheta_2 \exp(i\theta_2) \\
&=
(l_1 \dottheta_1)^2 + (l_2 \dottheta_2)^2
+ l_1 l_2 \dottheta_1 \dottheta_2 \left( \exp(i(\theta_1 -\theta_2)) + \exp(-i(\theta_1 - \theta_2)) \right) \\
&=
(l_1 \dottheta_1)^2 + (l_2 \dottheta_2)^2
+ 2 l_1 l_2 \dottheta_1 \dottheta_2 \cos(\theta_1 -\theta_2) \\
\end{aligned}
\end{equation}

Now calculate the potential energies for the two masses.  The first has potential of

\begin{equation*}
V_1 = m_1 g l_1 (1 - \cos\theta_1)
\end{equation*}

and the potential energy of the second mass, relative to the position of the first mass is:
\begin{equation*}
V_2' = m_2 g l_2 (1 - \cos\theta_2)
\end{equation*}

But that is the potential only if the first mass is at rest.  The total difference in height from the dual rest position is:
\begin{equation*}
l_1 (1 - \cos\theta_1) + l_2 (1 - \cos\theta_2)
\end{equation*}

So, the potential energy for the second mass is:
\begin{equation*}
V_2 = m_2 g \left( l_1 (1 - \cos\theta_1) + l_2 (1 - \cos\theta_2) \right)
\end{equation*}

Dropping constant terms the total Lagrangian for the system is:

\begin{equation}\label{eqn:tongMf1:280}
\begin{aligned}
\LL
&= \inv{2}m_1 {v_1}^2 +\inv{2}m_2 {v_2}^2 + m_1 g l_1 \cos\theta_1 + m_2 g \left( l_1 \cos\theta_1 + l_2 \cos\theta_2 \right) \\
&=
\inv{2} m_1 {l_1}^2 {\dottheta_1}^2
+ \inv{2} m_2 \left( (l_1 \dottheta_1)^2 + (l_2 \dottheta_2)^2 + 2 l_1 l_2 \dottheta_1 \dottheta_2 \cos(\theta_1 -\theta_2) \right) \\
&+ m_1 g l_1 \cos\theta_1 + m_2 g \left( l_1 \cos\theta_1 + l_2 \cos\theta_2 \right) \\
\end{aligned}
\end{equation}

Again looking at the resulting Lagrangian, we see that it would have been more natural to measure the potential energy from a reference point of zero potential at the horizontal position, and measure downwards from there:

\begin{equation}\label{eqn:tongMf1:300}
\begin{aligned}
V_1' &= 0 - m_1 g l_1 \cos\theta_1 \\
V_2' &= 0 - m_2 g \left( l_1 \cos\theta_1 + l_2 \cos\theta_2 \right)
\end{aligned}
\end{equation}

\paragraph{N coupled pendulums}

Now, with just two masses it is not too messy to expand out those kinetic energy terms, but for more the trig gets too messy.  With the \(K_2\) term of the Lagrangian in complex form we have:

\begin{equation}\label{eqn:tongMf1:320}
\begin{aligned}
\LL
&=
\inv{2} m_1 {l_1}^2 {\dottheta_1}^2
+ \inv{2} m_2 \Abs{ l_1 \dottheta_1 + l_2 \dottheta_2 \exp(i(\theta_2 -\theta_1)) }^2 \\
&+ m_1 g l_1 \cos\theta_1 + m_2 g \left( l_1 \cos\theta_1 + l_2 \cos\theta_2 \right) \\
&=
\inv{2} m_1 \Abs{l_1 \dottheta_1 \exp(i\theta_1)}^2
+ \inv{2} m_2 \Abs{ l_1 \dottheta_1 \exp(i\theta_1) + l_2 \dottheta_2 \exp(i\theta_2) }^2 \\
&+ m_1 g l_1 \cos\theta_1 + m_2 g \left( l_1 \cos\theta_1 + l_2 \cos\theta_2 \right) \\
\end{aligned}
\end{equation}

By inspection we can also write the Lagrangian for the N particle variant:

\begin{equation*}
\LL
=
\inv{2} \sum_{j=1}^N m_j \Abs{ \sum_{k=1}^j l_k \dottheta_k \exp(i\theta_k) }^2
+ g \sum_{j=1}^N l_j \cos\theta_j \sum_{k=j}^N m_k
\end{equation*}

Can this be used to derive the wave equation?

If each of the \(N\) masses is a fraction \(m_j = \Delta m = M/N\) of the total mass, and the lengths are all uniformly divided into segments of length
\(l_j = \Delta l = L/N\), then the Lagrangian becomes:

\begin{equation}\label{eqn:tongMf1:340}
\begin{aligned}
\LL
&= \frac{\Delta l}{2g} \sum_{j=1}^N \Abs{ \sum_{k=1}^j \dottheta_k \exp(i\theta_k) }^2 + \sum_{j=1}^N \cos\theta_j \sum_{k=j}^N 1 \\
&= \frac{\Delta l}{2g} \sum_{j=1}^N \Abs{ \sum_{k=1}^j \dottheta_k \exp(i\theta_k) }^2 + ( N - j + 1 ) \sum_{j=1}^N \cos\theta_j \\
\end{aligned}
\end{equation}

FIXME: return to this later?
\paragraph{Double pendulum}

First consider a single pendulum (fixed length \(l\)).

\begin{equation}\label{eqn:tongMf1:360}
\begin{aligned}
x &= l \exp(i\theta) \\
\xdot &= l i \dottheta \exp(i\theta) \\
\abs{\xdot}^2 &= l^2 \dottheta^2 \\
\end{aligned}
\end{equation}

Now, if \(\theta = 0\) represents the downwards position at rest, the height above that rest point is \(h = l - l \cos\theta\).  Therefore the Lagrangian is:

\begin{equation}\label{eqn:tongMf1:380}
\begin{aligned}
\LL
&= \inv{2} m v^2 - mgh \\
&= \inv{2} m l^2 \dottheta^2 - mg l (1 - \cos\theta) \\
\end{aligned}
\end{equation}

The constant term can be dropped resulting in the equivalent Lagrangian:

\begin{equation*}
\LL' = \inv{2} m l^2 \dottheta^2 + mg l \cos\theta
\end{equation*}

This amounts to a difference in the reference point for the potential energy, so
instead of measuring the potential energy \(V = m g h\) from a reference position below the mass, one could consider that the potential has a maximum of zero at the highest position, and decreases from there as:

\begin{equation*}
V' = 0 - m g l \cos\theta.
\end{equation*}

Moving back to the EOMs that result from either form of Lagrangian, we have after taking our derivatives:

\begin{equation*}
-m g l \sin\theta = \frac{d}{dt} m l^2 \dottheta = m l^2 \ddottheta
\end{equation*}

Or,

\begin{equation*}
\ddottheta = - g/l \sin\theta
\end{equation*}

This is consistent with our expectations, and recovers the familiar small angle SHM equation:

\begin{equation*}
\ddottheta \approx - g/l \theta.
\end{equation*}

Now, move on to the double pendulum, and compute the Kinetic energies of the two particles:

\begin{equation}\label{eqn:tongMf1:400}
\begin{aligned}
x_1 &= l_1 \exp(i\theta_1) \\
\xdot_1 &= l_1 i \dottheta_1 \exp(i\theta_1) \\
\abs{\xdot_1}^2 &= {l_1}^2 {\dottheta_1}^2 \\
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:tongMf1:420}
\begin{aligned}
x_2 &= x_1 + l_2 \exp(i\theta_2) \\
\xdot_2 &= \xdot_1 + l_2 i \dottheta_2 \exp(i\theta_2) \\
        &= l_1 i \dottheta_1 \exp(i\theta_1) + l_2 i \dottheta_2 \exp(i\theta_2) \\
\abs{\xdot_2}^2
&=
(l_1 \dottheta_1)^2 + (l_2 \dottheta_2)^2
+ l_1 i \dottheta_1 \exp(i\theta_1) l_2 (-i) \dottheta_2 \exp(-i\theta_2)
+ l_1 (-i) \dottheta_1 \exp(-i\theta_1) l_2 i \dottheta_2 \exp(i\theta_2) \\
&=
(l_1 \dottheta_1)^2 + (l_2 \dottheta_2)^2
+ l_1 l_2 \dottheta_1 \dottheta_2 \left( \exp(i(\theta_1 -\theta_2)) + \exp(-i(\theta_1 - \theta_2)) \right) \\
&=
(l_1 \dottheta_1)^2 + (l_2 \dottheta_2)^2
+ 2 l_1 l_2 \dottheta_1 \dottheta_2 \cos(\theta_1 -\theta_2) \\
\end{aligned}
\end{equation}

Now calculate the potential energies for the two masses.  The first has potential of

\begin{equation*}
V_1 = m_1 g l_1 (1 - \cos\theta_1)
\end{equation*}

and the potential energy of the second mass, relative to the position of the first mass is:
\begin{equation*}
V_2' = m_2 g l_2 (1 - \cos\theta_2)
\end{equation*}

But that is the potential only if the first mass is at rest.  The total difference in height from the dual rest position is:
\begin{equation*}
l_1 (1 - \cos\theta_1) + l_2 (1 - \cos\theta_2)
\end{equation*}

So, the potential energy for the second mass is:
\begin{equation*}
V_2 = m_2 g \left( l_1 (1 - \cos\theta_1) + l_2 (1 - \cos\theta_2) \right)
\end{equation*}

Dropping constant terms the total Lagrangian for the system is:

\begin{equation}\label{eqn:tongMf1:440}
\begin{aligned}
\LL
&= \inv{2}m_1 {v_1}^2 +\inv{2}m_2 {v_2}^2 + m_1 g l_1 \cos\theta_1 + m_2 g \left( l_1 \cos\theta_1 + l_2 \cos\theta_2 \right) \\
&=
\inv{2} m_1 {l_1}^2 {\dottheta_1}^2
+ \inv{2} m_2 \left( (l_1 \dottheta_1)^2 + (l_2 \dottheta_2)^2 + 2 l_1 l_2 \dottheta_1 \dottheta_2 \cos(\theta_1 -\theta_2) \right) \\
&+ m_1 g l_1 \cos\theta_1 + m_2 g \left( l_1 \cos\theta_1 + l_2 \cos\theta_2 \right) \\
\end{aligned}
\end{equation}

Again looking at the resulting Lagrangian, we see that it would have been more natural to measure the potential energy from a reference point of zero potential at the horizontal position, and measure downwards from there:

\begin{equation}\label{eqn:tongMf1:460}
\begin{aligned}
V_1' &= 0 - m_1 g l_1 \cos\theta_1 \\
V_2' &= 0 - m_2 g \left( l_1 \cos\theta_1 + l_2 \cos\theta_2 \right)
\end{aligned}
\end{equation}
}

\makeproblem{Pendulum on a rotating wheel (problem 5)}{tongmf1:pr5}{
Lagrangian and equations of motion for pendulum with pivot moving on a circle.
}

\makeanswer{tongmf1:pr5}{

Express the position of the pivot point on the wheel with:

\begin{equation*}
q_1 = R e^{-i\omega t}.
\end{equation*}

The position of the mass is then:
\begin{equation*}
q_2 = R e^{-i\omega t} - il e^{i\theta}.
\end{equation*}

The velocity of the mass is then:
\begin{equation*}
\qdot_2 = -i(\dotomega t + \omega)R e^{-i\omega t} + l \dottheta e^{i\theta}.
\end{equation*}

Let \(\omega t = \alpha\), we have a Kinetic energy of:

\begin{equation}\label{eqn:tongMf1:480}
\begin{aligned}
\inv{2} m \abs{\qdot_2}^2
&= \inv{2} m \Abs{-i\dotalpha R e^{-i\omega t} + l \dottheta e^{i\theta}}^2 \\
&= \inv{2} m \left( R^2 \dotalpha^2 + l^2 \dottheta^2 + 2 R l \dotalpha \dottheta \Real
\lr{  -i e^{-i\alpha -i\theta} }
 \right) \\
&= \inv{2} m \left( R^2 \dotalpha^2 + l^2 \dottheta^2 + 2 R l \dotalpha \dottheta \cos( -\alpha -\theta -\pi/2 ) \right) \\
&= \inv{2} m \left( R^2 \dotalpha^2 + l^2 \dottheta^2 - 2 R l \dotalpha \dottheta \sin( \alpha +\theta ) \right) \\
\end{aligned}
\end{equation}

The potential energy in the Lagrangian does not depend on the position of the pivot, only the angle from vertical, so it is thus:

\begin{equation}\label{eqn:tongMf1:500}
\begin{aligned}
V &= mg l ( 1 - \cos\theta ) \\
V' &= 0 - m g l \cos\theta
\end{aligned}
\end{equation}

Depending on whether one measures the potential up from the lowest potential point, or measures decreasing potential from zero at the horizontal.
Either way, combining the kinetic and potential terms, and dividing through by \(ml^2\) we have the Lagrangian of:

\begin{equation*}
\LL = \inv{2} \left( (R/l)^2 \dotalpha^2 + \dottheta^2 - 2 (R/l) \dotalpha \dottheta \sin( \alpha +\theta ) \right) + (g/l) \cos\theta
\end{equation*}

\paragraph{Digression.  Reduction of the Lagrangian}
\label{chap:PJTongMf1:addDerivative}

Now, in Tong's solutions for this problem (which he emailed me since I questioned problem 2), he had \(\dotalpha = \omega = \text{constant}\), which allows the
Lagrangian above to be expressed as:

\begin{equation*}
\LL =
\inv{2} \left( (R/l)^2 \omega^2 + \dottheta^2 \right)
+ \frac{d}{dt} ((R/l) \cos( \omega t + \theta )) + \omega (R/l) \sin(\omega t + \theta)
+ (g/l) \cos\theta
\end{equation*}

and he made the surprising step of removing that cosine term completely, with a statement that it would not effect the dynamics because it was a time derivative.
That turns out to be a generalized result, but I had to prove it to myself.  I also asked around on PF about this, and it was not any named property of Lagrangians,
but was a theorem in some texts.

First consider the simple example of a Lagrangian with such a cosine derivative term added to it:

\begin{equation*}
\LL' = \LL + \frac{d}{dt} A \cos(\omega t + \theta)
\end{equation*}

and compute the equations of motion from this:
\begin{equation}\label{eqn:tongMf1:520}
\begin{aligned}
0
&= \PD{\theta}{\LL'} - \frac{d}{dt}\left(\PD{\dottheta}{\LL'}\right) \\
&= \PD{\theta}{\LL} - \frac{d}{dt}\left(\PD{\dottheta}{\LL}\right)
+ \PD{\theta}{} {\frac{d}{dt} A \cos(\omega t + \theta)}
- \frac{d}{dt} \PD{\dottheta}{} \frac{d}{dt} A \cos(\omega t + \theta) \\
&= \PD{\theta}{\LL} - \frac{d}{dt}\left(\PD{\dottheta}{\LL}\right)
- \PD{\theta}{} A \dottheta \sin(\omega t + \theta) +
\frac{d}{dt} \PD{\dottheta}{} A \dottheta \sin(\omega t + \theta) \\
&= \PD{\theta}{\LL} - \frac{d}{dt}\left(\PD{\dottheta}{\LL}\right)
- \PD{\theta}{} A \dottheta \sin(\omega t + \theta) + \frac{d}{dt} A \sin(\omega t + \theta) \\
&= \PD{\theta}{\LL} - \frac{d}{dt}\left(\PD{\dottheta}{\LL}\right)
- A \dottheta \cos(\omega t + \theta) + A \dottheta \cos(\omega t + \theta) \\
&= \PD{\theta}{\LL} - \frac{d}{dt}\left(\PD{\dottheta}{\LL}\right)  \\
\end{aligned}
\end{equation}

Now consider the general case, altering a Lagrangian by adding the time derivative of a positional dependent function:

\begin{equation*}
\LL' = \LL + \frac{df}{dt}
\end{equation*}

and compute the equations of motion from this more generally altered function:
\begin{equation}\label{eqn:tongMf1:540}
\begin{aligned}
0
&= \PD{q^i}{\LL'} - \frac{d}{dt}\left(\PD{q^i}{\LL'}\right) \\
&= \PD{q^i}{\LL} - \frac{d}{dt}\left(\PD{q^i}{\LL}\right)
+ \PD{q^i}{}\frac{df}{dt} - \frac{d}{dt} \PD{q^i}{} \frac{df}{dt} \\
\end{aligned}
\end{equation}

Now, if \(f(q^j,\qdot^j,t) = f(q^j,t)\) we have:
\begin{equation*}
\frac{df}{dt} = \sum \PD{q^j}{f} \qdot^j + \PD{t}{f}
\end{equation*}

We want to see if the following sums to zero:
\begin{equation}\label{eqn:tongMf1:560}
\begin{aligned}
\PD{q^i}{}\frac{df}{dt} - \frac{d}{dt} \PD{q^i}{} \frac{df}{dt}
&= \sum \PD{q^i}{} \PD{q^j}{f} \left(\qdot^j + \PD{t}{f}\right) - \frac{d}{dt} \PD{\qdot^i}{} \left(\sum \PD{q^j}{f} \qdot^j + \PD{t}{f}\right) \\
&= \sum \PDD{q^i}{q^j}{f} \qdot^j + \PDD{q^i}{t}{f} - \frac{d}{dt} \left(\sum \delta_{ij} \PD{q^j}{f} + \PDD{\qdot^i}{t}{f}\right) \\
&= \sum \PDD{q^i}{q^j}{f} \qdot^j + \PDD{q^i}{t}{f} - \frac{d}{dt} \PD{q^i}{f} \\
&= \sum \PDD{q^i}{q^j}{f} \qdot^j + \PDD{q^i}{t}{f} - \sum \qdot^j \PDD{q^j}{q^i}{f} - \PDD{t}{q^i}{f} \\
\end{aligned}
\end{equation}

Therefore provided the function is sufficiently continuous that all mixed pairs of mixed partials are equal, this is zero, and the \(df/dt\) addition does not
change the equations of motion that the Lagrangian generates.

\paragraph{Back to the problem}

Now, return to the Lagrangian for this problem, and compute the equations of motion.  Writing \(\mu = R/l\), we have:

\begin{equation*}
\LL = \inv{2} \left( \mu^2 \dotalpha^2 + \dottheta^2 - 2 \mu \dotalpha \dottheta \sin( \alpha +\theta ) \right) + (g/l) \cos\theta
\end{equation*}

\begin{equation}\label{eqn:tongMf1:580}
\begin{aligned}
0 &= \frac{d}{dt}\PD{\dottheta} -\PD{\theta} \LL \\
&= \frac{d}{dt} \left(\dottheta - \mu \dotalpha \sin(\alpha + \theta)\right) + \mu \dotalpha \dottheta \cos(\alpha + \theta) + (g/l) \sin\theta \\
&= \ddottheta - \mu \ddotalpha \sin(\alpha + \theta) - \mu \dotalpha \cos(\alpha + \theta) (\dotalpha + \dottheta) + \mu \dotalpha \dottheta \cos(\alpha + \theta) + (g/l) \sin\theta \\
\end{aligned}
\end{equation}

Sure enough we have a cancellation of terms for constant \(\omega\).  In general we are left with:

\begin{equation*}
\ddottheta = \mu \ddotalpha \sin(\alpha + \theta) + \mu \dotalpha^2 \cos(\alpha + \theta) - (g/l) \sin\theta
\end{equation*}

Or,
\begin{equation*}
\ddottheta = \mu (\ddotomega t + 2\dotomega) \sin(\omega t + \theta) + \mu (\dotomega t + \omega)^2 \cos(\omega t + \theta) - (g/l) \sin\theta
\end{equation*}

For constant \(\omega\), this is just:
\begin{equation*}
\ddottheta = \mu \omega^2 \cos(\omega t + \theta) - (g/l) \sin\theta
\end{equation*}
}

\makeproblem{Lorentz force Lagrangian (problem 6)}{tongmf1:pr6}{

Using

\begin{equation*}
\LL = \inv{2} m \Bv^2 -q \phi + q \Bv/c \cdot \BA,
\end{equation*}

derive the Lorentz force equation, and some other stuff.
}

\makeanswer{tongmf1:pr6}{
First part of the problem is to show that the Lagrangian:

is equivalent to the Lorentz force law.

When I first tried this problem I had trouble with it, and also had trouble following the text for the same in Tong's paper.  Later I did the somewhat harder problem of exactly
this, but for the covariant form of the Lorentz force law, so I thought I had come back to this and try again.

First step that seemed natural was to put the equation into four vector form, despite the fact that the proper time Lagrangian equations were not going to be used to
produce the equation of motion.  For just the Lorentz part of the Lagrangian we have:


\begin{equation}\label{eqn:tongMf1:600}
\begin{aligned}
\LL'
&= -\phi + \Bv/c \cdot \BA \\
&= -\phi \sum v^i/c A^j
\mathLabelBox{\sigma_i \cdot \sigma_j}{\(\inv{2}(\gamma_{i0j0} + \gamma_{j0i0}) = - \gamma_i \cdot \gamma_j\)}
\\
&= -\inv{c} \phi c + \sum v^i A^i {\gamma_i}^2 \\
&= -\inv{c} \phi c {\gamma_0}^2 + \sum v^i A^i {\gamma_i}^2 \\
\end{aligned}
\end{equation}

Thus with \(v = c \gamma_0 + \sum v^i \gamma_i = \sum v^{\mu} \gamma_{\mu}\), and \(A = \phi \gamma_0 + \sum A^{i} \gamma_i = \sum A^{\mu} \gamma_{\mu}\), we can thus write the complete
Lagrangian as:

\begin{equation*}
\LL = \inv{2} m \Bv^2 - q A \cdot v/c
\end{equation*}

As usual we recover our vector forms by wedging with the time basis vector:

\begin{equation*}
A \wedge \gamma_0 = \sum A^i \gamma_{i0} = \sum A^i \sigma_i = \BA
\end{equation*}

and \(v \wedge \gamma_0 = \cdots = \Bv\).

Notice the sign in the potential term, which is negative, unlike the same Lagrangian in relativistic (proper) form: \(\LL = \inv{2}m v^2 + q A \cdot v/c\).  That difference is required
since the lack of the use of time as one of the generalized coordinates will change the signs of some of the results.

Now, this does not matter for this particular problem, but also observe that this Lagrangian is almost in its proper form.  All we have to do is add a \(-\inv{2} m c^2\) constant to it, which should not effect the equations of motion.  Doing so yields:

\begin{equation*}
\LL = \inv{2} m (-c^2 + \Bv^2) - q A \cdot v/c = - \left( \inv{2} mv^2 + q A \cdot v/c \right)
\end{equation*}

I did not notice that until writing this up.  So we have the same Lagrangian in both cases, which makes sense.  Whether or not one gets the traditional Lorentz force law from this
or the equivalent covariant form depends only on whether one treats time as one of the generalized coordinates or not (and if doing so, use proper time in the place of the time
derivatives when applying the Lagrange equations).  Cool.

Anyways, now that we have a more symmetric form of the Lagrangian, lets compute the equations of motion.

\begin{equation}\label{eqn:tongMf1:620}
\begin{aligned}
\PD{x^i}{\LL}
&= \frac{d}{dt} \PD{\xdot^i}{\LL} \\
&= \frac{d}{dt} \left(m v^i - q/c A \cdot \PD{\xdot^i}{v} \right) \\
&= \frac{d}{dt} \left(m v^i - q/c A \cdot \gamma_i \right) \\
&= \frac{d}{dt} \left(m v^i + q/c A^i \right) \\
&= p^i + q/c \sum \xdot^j \PD{x^j}{A^i} \\
q \PD{x^i}{A} \cdot v/c &= \\
\implies \\
\dot{p}^i
&= -q/c \left( \PD{x^i}{A} \cdot v - \sum \xdot^j \PD{x^j}{A^i} \right) \\
&= -q/c \left( \sum \PD{x^i}{A^{\mu}} v^{\nu} \gamma_{\mu} \cdot \gamma_{\nu} - \sum v^j \PD{x^j}{A^i} \right) \\
&= -q/c \left( \sum \PD{x^i}{A^0} v^0 {\gamma_0}^2 +\sum \PD{x^i}{A^j} v^j {\gamma_j}^2 - \sum v^j \PD{x^j}{A^i} \right) \\
\implies \\
\sum \sigma_i \dot{p}^i = \Bp
&= q/c \sum \sigma_i \left( -\PD{x^i}{A^0} v^0 {\gamma_0}^2 - \PD{x^i}{A^j} v^j {\gamma_j}^2 - v^j \PD{x^j}{A^i} \right) \\
&= -q \grad \phi + \sum \sigma_i v^j \left( \PD{x^i}{A^j} - \PD{x^j}{A^i} \right) \\
\end{aligned}
\end{equation}

Now, it is not obvious by looking, but this last expression is \(\Bv \cross (\grad \cross \BA)\).  Let us verify this by going backwards:

\begin{equation}\label{eqn:tongMf1:640}
\begin{aligned}
\Bv \cross
\lr{ \grad \cross \BA }
&= \inv{i} \left( \Bv \wedge
\lr{  \grad \cross \BA  }
\right) \\
&= \inv{2i} \left( \Bv
\lr{  \grad \cross \BA  }
- \lr{  \grad \cross \BA  }
 \Bv \right) \\
&= \inv{2i} \left( \Bv \inv{i}
\lr{  \grad \wedge \BA  }
 - \inv{i}
\lr{  \grad \wedge \BA  }
 \Bv \right) \\
&= -\inv{2} \left( \Bv
\lr{  \grad \wedge \BA  }
 -
\lr{  \grad \wedge \BA  }
 \Bv \right) \\
&=
\lr{  \grad \wedge \BA  }
\cdot \Bv \\
&= \sum v^k \PD{x^i}{A^j} \sigma_i
\lr{ \sigma_j \cdot \sigma_k } - \sigma_j
\lr{ \sigma_i \cdot \sigma_k } \\
&= \sum v^k \PD{x^i}{A^j} \sigma_i \delta_{jk} - \sigma_j \delta_{ik} \\
&= \sum v^j \PD{x^i}{A^j} \sigma_i -v^i \PD{x^i}{A^j} \sigma_j \\
&= \sum v^j \PD{x^i}{A^j} \sigma_i -v^j \PD{x^j}{A^i} \sigma_i \\
&= \sum v^j \sigma_i \left(\PD{x^i}{A^j} - \PD{x^j}{A^i} \right) \\
\end{aligned}
\end{equation}

Therefore the final result is our Lorentz force law, as expected:

\begin{equation*}
\Bp = -q \grad \phi + q \Bv/c \cross (\grad \cross \BA)
\end{equation*}

\paragraph{Cylindrical Polar Coordinates}

The next two parts of question 6 require cylindrical polar coordinates.  I found a digression was useful (or at least interesting), to see
if the gradient followed from the Lagrangian as was the case with non-orthonormal constant frame basis vectors.

The first step required for this calculation (and the later parts of the problem) is to express the KE in terms of the polar coordinates.
We need the velocity to do so:

\begin{equation}\label{eqn:tongMf1:660}
\begin{aligned}
\Br &= \Be_3 z + \Be_1 r e^{i\theta} \\
\dot{\Br} &= \Be_3 \zdot + \Be_1 (\rdot + r \dottheta i) e^{i\theta} \\
\Abs{\dot{\Br}}
&= \zdot^2 + \Abs{\rdot + r \dottheta i}^2 \\
&= \zdot^2 + \rdot^2 +
\lr{ r \dottheta }^2 \\
\end{aligned}
\end{equation}

Now, form the Lagrangian of a point particle with a non-velocity dependent potential:

\begin{equation*}
\LL = \inv{2} m \left(\zdot^2 + \rdot^2 + \left(r \dottheta\right)^2\right) - \phi
\end{equation*}

and calculate the equations of motion:
\begin{equation}\label{eqn:tongMf1:680}
\begin{aligned}
\PD{z}\LL &= \left(\PD{\zdot}\LL\right)' \\
-\PD{z}{\phi} &= \left(m\zdot\right)' \\
\end{aligned}
\end{equation}
\begin{equation}\label{eqn:tongMf1:700}
\begin{aligned}
\PD{r}\LL &= \left(\PD{\rdot}\LL\right)' \\
-\PD{r}{\phi} + m r \dottheta^2 &= \left(m\rdot\right)' \\
\end{aligned}
\end{equation}
\begin{equation}\label{eqn:tongMf1:720}
\begin{aligned}
\PD{\theta}\LL &= \left(\PD{\dottheta}\LL\right)' \\
-\PD{\theta}{\phi} &= \left(m r^2 \dottheta\right)' \\
\end{aligned}
\end{equation}

There are a few things to observe about these equations.  One is that we can assign physically significance to an expression such as \(m r^2 \dottheta\).  If the potential has no \(\theta\) dependence this is a conserved quantity (angular momentum).

The other thing to observe here is that the dimensions for the \(\theta\) coordinate equation result has got an extra length factor in the numerator.  Thus we can not multiply these with our respective frame vectors and sum.  We can however scale that last equation by a factor of \(1/r\) and then sum:

\begin{equation*}
\zcap (m\zdot)' + \rcap \left((m\rdot)' - m r \dottheta^2\right) + \inv{r} (mr^2 \dottheta)' = - \left(\zcap \PD{z}{} + \rcap \PD{r}{} + \inv{r} \PD{\theta}{}\right) \phi
\end{equation*}

For constant mass this is:
\begin{equation*}
m \left( \zcap \zddot + \rcap
\lr{ \rddot - r \dottheta^2 }
 + \inv{r} \left(2 r \rdot \dottheta + r^2 \ddottheta\right) \right) = - \left(\zcap \PD{z}{} + \rcap \PD{r}{} + \inv{r} \thetacap \PD{\theta}{}\right) \phi
\end{equation*}

However, is such a construction have a meaningful physical quantity?  One can easily imagine more complex generalized coordinates where guessing scale factors in this fashion would not be possible.

Let us compare this to a calculation of acceleration in cylindrical coordinates.

\begin{equation}\label{eqn:tongMf1:740}
\begin{aligned}
\ddot{\Br} &= \Be_3 \zddot + \Be_1
\lr{ \rddot + r \ddottheta i + \rdot \dottheta i + \lr{ \rdot + r \dottheta i } i\dottheta }
 e^{i\theta} \\
           &= \Be_3 \zddot + \Be_1
\lr{ \rddot + r \ddottheta i + 2 \rdot \dottheta i - r \dottheta^2 }
 e^{i\theta} \\
           &= \zcap \zddot + \rcap
\lr{ \rddot - r \dottheta^2 }
 + \thetacap
\lr{ r \ddottheta + 2 \rdot \dottheta } \\
\end{aligned}
\end{equation}

Sure enough, the ad-hoc vector that was constructed matches the acceleration vector for the constant mass case, so the right hand side must also define the gradient
in cylindrical coordinates.

\begin{equation}\label{eqn:tongMf1:760}
\begin{aligned}
\grad
&= \zcap \PD{z}{} + \rcap \PD{r}{} + \inv{r} \thetacap \PD{\theta}{} \\
&= \zcap \PD{z}{} + \rcap \left(\PD{r}{} + \frac{i}{r} \PD{\theta}{} \right)
\end{aligned}
\end{equation}

Very cool result.  Seeing this I finally understand when and where statements like "angular momentum is conserved" is true.  Specifically it requires a potential that has no angular dependence (ie: like gravity acting between two point masses.)

I never found that making such an angular momentum conservation "law" statement to be obvious, even once the acceleration was expressed in a radial decomposition.  This is something that can be understood without the Lagrangian formulation.  To do so the missing factor is that before a conservation statement like this can be claimed one has to first express the gradient in cylindrical form, and then look at the coordinates with respect to the generalized frame vectors.  Conservation of angular momentum depends on an appropriately well behaved potential function!  Intuitively, I understood that something else was required to make this statement, but it took the form of an unproven axiom in most elementary texts.

FIXME: generalize this and prove to myself that angular momentum is conserved in a N-body problem and/or with a rigid body rotation constraint on \(N-1\) of the masses.

\paragraph{(i)}

The Lagrangian for this problem is:

\begin{equation*}
\LL = \inv{2} m \Bv^2 - e \BA \cdot \Bv
\end{equation*}

Given a cylindrical decomposition, our velocity is:

\begin{equation}\label{eqn:tongMf1:780}
\begin{aligned}
\Br &= z \zcap + r \rcap \\
\dot{\Br}
&= \zdot \zcap + r\dot{\rcap} + \rdot \rcap \\
&= \zdot \zcap + \rcap
\lr{ \rdot + r\dottheta i } \\
&= \zdot \zcap + \rdot \rcap + r\dottheta \thetacap
\end{aligned}
\end{equation}

The specific potential for the problem, using \((z,\theta,r)\) coordinates is:

\begin{equation*}
\BA = \thetacap \frac{f(r)}{r}
\end{equation*}

Therefore the Lagrangian is:
\begin{equation*}
\LL = \inv{2} m \left(\zdot^2 + \rdot^2 +
\lr{ r\dottheta }^2
\right) - e \frac{f(r)}{r} r \dottheta
\end{equation*}

so the equations of motion for the \(z\), \(\theta\), and \(r\) coordinates (respectively) are:

\begin{equation}\label{eqn:tongMf1:800}
\begin{aligned}
(m\zdot)' &= 0 \\
(m r^2 \dottheta -e f(r))' &= 0 \\
(m \rdot)' &= m r \dottheta^2 - e f'(r) \dottheta \\
\end{aligned}
\end{equation}

From second of these equations we have:

\begin{equation*}
m r^2 \dottheta - e f(r) = K
\end{equation*}

In particular this is true for \(r = r(t_0) = r_0\), so

\begin{equation*}
m {r_0}^2 \dottheta_0 - e f(r_0) = K
\end{equation*}

Or,
\begin{equation*}
\dottheta(t) - {\left(\frac{r_0}{r}\right)}^2 \dottheta(t_0) = \frac{e}{m r^2} \left( f(r) - f(r_0) \right)
\end{equation*}

Now, the problem is to show that
\begin{equation*}
\dottheta = \frac{e}{mr^2} \left(f(r) - f(r_0)\right)
\end{equation*}

I do not see how that follows?  Ah, I see, the velocity is in the \((r,z)\) plane for \(t=0\), so \(\dottheta(t_0) = 0\).

\paragraph{(ii)}

The potential for this problem is

\begin{equation*}
\BA =  r g(z) \thetacap
\end{equation*}

Therefore the Lagrangian is:
\begin{equation*}
\LL = \inv{2} m \left(\zdot^2 + \rdot^2 + (r\dottheta)^2\right) - e r^2 g(z) \dottheta
\end{equation*}

Taking \(\theta, r, z\) derivatives:
\begin{equation*}
0 = \left(mr^2 \dottheta - e r^2 g(z)\right)'
\end{equation*}
\begin{equation*}
mr \dottheta^2 - 2 e r g(z) \dottheta = (m \rdot)'
\end{equation*}
\begin{equation*}
-e r^2 g' \dottheta = ( m \zdot )'
\end{equation*}

One constant of motion is:

\begin{equation*}
mr^2 \dottheta - e r^2 g(z) = K
\end{equation*}

Looking at Tong's solutions another is the Hamiltonian.  (I have got to go back and read that Hamiltonian stuff since this did not occur to me).

\begin{equation*}
\dottheta = (e/m) g(z) + (r_0/r)^2 \left(\dottheta_0 - (e/m) g(z_0)\right)
\end{equation*}

With \(\dottheta_0 = 2 e g(z_0)/m\) this is:

\begin{equation*}
\dottheta = \frac{e}{m} \left(g(z) + {\left(\frac{r_0}{r}\right)}^2 g(z_0)\right)
\end{equation*}

FIXME: think through the remainder bits of this problem more carefully.
}

\makeproblem{Two circular constrained paths (problem 7)}{tongmf1:pr7}{
Masses connected by a spring.
}

\makeanswer{tongmf1:pr7}{

With \(i = \Be_1 \wedge \Be_2\), the paths, (squared) speeds and separation of the masses can be written:

\begin{equation}\label{eqn:tongMf1:820}
\begin{aligned}
q_1 &= \Be_1 R_1 e^{i\theta} \\
q_2 &= c\Be_3 + \Be_1
\lr{  ai + R_2 e^{i\alpha} }
\\
\Abs{\qdot_1}^2 &=
\lr{ R_1 \dottheta }^2 \\
\Abs{\qdot_2}^2 &=
\lr{ R_2 \dotalpha }^2 \\
d^2 &=
\lr{ q_1 - q_2 }^2 \\
&= c^2 + \Abs{ai + R_2 e^{i\alpha} - R_1 e^{i\theta}}^2 \\
&= c^2 + a^2 + {R_2}^2 + {R_1}^2 + a i \left( R_2 e^{-i\alpha} - R_1 e^{-i\theta} -R_2 e^{i\alpha} + R_1 e^{i\theta} \right) \\
& \quad - R_1 R_2
\lr{  e^{i\alpha} e^{-i\theta} + e^{-i\alpha} e^{i\theta}  } \\
&= c^2 + a^2 + {R_2}^2 + {R_1}^2
% a i \left( R_2 e^{-i\alpha} - R_1 e^{-i\theta} -R_2 e^{i\alpha} + R_1 e^{i\theta} \right)
% a/i \left( -R_2 e^{-i\alpha} + R_1 e^{-i\theta} +R_2 e^{i\alpha} - R_1 e^{i\theta} \right)
+ 2 a
(R_2 \sin\alpha - R_1 \sin\theta)
- 2 R_1 R_2 \cos(\alpha - \theta)
\end{aligned}
\end{equation}

With the given potential:

\begin{equation*}
V = \inv{2} \omega^2 d^2
\end{equation*}

We have the following Lagrangian (where the constant terms in the separation have been dropped) :

\begin{equation*}
\LL = \inv{2} m_1 (R_1 \dottheta)^2 +\inv{2} m_2 (R_2 \dotalpha)^2
+ \omega^2 \left( a (R_2 \sin\alpha - R_1 \sin\theta) - R_1 R_2 \cos(\alpha - \theta) \right)
\end{equation*}

Last part of the problem was to show that there is an additional conserved quantity when \(a=0\).  The Lagrangian in that case is:

\begin{equation*}
\LL = \inv{2} m_1
\lr{ R_1 \dottheta }^2 +\inv{2} m_2
\lr{ R_2 \dotalpha }^2
- R_1 R_2 \omega^2 \cos(\alpha - \theta)
\end{equation*}

Evaluating the Lagrange equations, for this condition one has:

\begin{equation}\label{eqn:tongMf1:840}
\begin{aligned}
-R_1 R_2 \omega^2 \sin(\alpha - \theta) &=
\lr{ m_1 {R_1}^2 \dottheta }' \\
R_1 R_2 \omega^2 \sin(\alpha - \theta) &=
\lr{ m_2 {R_2}^2 \dotalpha }'
\end{aligned}
\end{equation}

Summing these one has:
\begin{equation*}
\lr{ m_1 {R_1}^2 \dottheta }'
 + \lr{ m_2 {R_2}^2 \dotalpha }' = 0
\end{equation*}

Therefore the additional conserved quantity is:
\begin{equation*}
m_1 {R_1}^2 \dottheta + m_2 {R_2}^2 \dotalpha = K
\end{equation*}

FIXME: Is there a way to identify such a conserved quantity without evaluating the derivatives?  Noether's?

\paragraph{Spring Potential?}

Small digression.  Let us take the gradient of this spring potential and see if this matches our expectations for a \(-kx\) spring force.

\begin{equation*}
-{\grad}_d V = -\omega^2 d \dcap = -\omega^2 \Bd
\end{equation*}

Okay, this works, \(\omega^2 = k\), which just expresses the positiveness of this constant.
}

\makeproblem{Masses on string, one dangling (problem 8)}{tongmf1:pr8}{
Two particles connected by string, one on table, the other dangling.
}

\makeanswer{tongmf1:pr8}{
\paragraph{Part (i)}

The second particle hangs straight down (also Goldstein problem 9, also example 2.3 in Hestenes NFCM.)  First mass \(m_1\) on the table, and second, hanging.

The kinetic term for the mass on the table was calculated above in problem 7, so adding that and the KE term for the dangling mass we have:

\begin{equation*}
K = \inv{2} m_1 \left( \rdot^2 + (r\dotpsi)^2 \right) + \inv{2} m_2 \rdot^2
\end{equation*}

Our potential, measuring down is:

\begin{equation*}
V = 0 - m_2 g (l - r)
\end{equation*}

Combining the KE and PE terms and dropping constant terms we have:

\begin{equation*}
\LL = \inv{2} m_1 \left( \rdot^2 + (r\dotpsi)^2 \right) + \inv{2} m_2 \rdot^2 - m_2 g r
\end{equation*}

The ignorable coordinate is \(\psi\) since it has only derivatives in the Lagrangian.  EOMs are:

\begin{equation}\label{eqn:tongMf1:860}
\begin{aligned}
0 &=
\lr{ m_1 r^2 \dotpsi }'
 \\
m_1 r \dotpsi^2 - m_2 g &= {\left( (m_1 + m_2) \rdot \right)}' = M \rddot
\end{aligned}
\end{equation}

The first equation here is a conservation of angular momentum statement, whereas the second equation has all the force terms that lie along the string (radially above the table, and downwards below).  We see the \(r \dotpsi^2 = r\omega^2\) angular acceleration component when calculating radial and non-radial component of acceleration.

Goldstein asks here for the equations of motion as a second order equation, and to integrate once.  We can go all the way, but
only implicitly, as we can write \(t = t(r)\), using \(\rdot\) as an integrating factor:

\begin{equation}\label{eqn:tongMf1:880}
\begin{aligned}
m_1 r^2 \dotpsi = m_1 {r_0}^2 \omega_0 \\
\implies \\
\dotpsi = {\left(\frac{r_0}{r}\right)}^2 \omega_0 \\
\implies \\
m_1 \frac{{r_0}^4}{r^3} {\omega_0}^2 - m_2 g &= M \rddot \\
\implies \\
m_1 \rdot \frac{{r_0}^4}{r^3} {\omega_0}^2 - m_2 g \rdot  &= M \rdot \rddot \\
-m_1 {r_0}^2 \left(\inv{r^2}\right)' {\omega_0}^2 - m_2 g \rdot  &= M \left(\rdot^2\right)' \\
K -m_1 {r_0}^4 \inv{r^2} {\omega_0}^2 - m_2 g r &= M \rdot^2 \\
\implies \\
K &= m_1 {r_0}^2 {\omega_0}^2 + m_2 g r_0 + M {\rdot_0}^2 \\
m_1 {\omega_0}^2 {r_0}^2 \left( 1 - \frac{{r_0}^2}{r^2} \right)
+ M {\rdot_0}^2
- m_2 g \left( r - r_0 \right) &= M \rdot^2 \\
\implies \\
t = \int{
\frac{dr}{\sqrt{
\frac{m_1}{M} {\omega_0}^2 {r_0}^2 \left( 1 - \frac{{r_0}^2}{r^2} \right)
+ {\rdot_0}^2
- \frac{m_2}{M} g \left( r - r_0 \right)
}}}
\end{aligned}
\end{equation}

We can also write \(\psi = \psi(r)\), but that does not look like it is any easier to solve:

\begin{equation}\label{eqn:tongMf1:900}
\begin{aligned}
\dotpsi &= \frac{d \psi}{dr} \frac{dr}{dt} \\
\implies \\
\frac{d \psi}{dr}
&= \frac{dt}{dr} {\left(\frac{r_0}{r}\right)}^2 \omega_0 \\
\psi &= \int{
\frac{{r_0}^2 \omega_0 dr}{r^2 \sqrt{
\frac{m_1}{M} {\omega_0}^2 {r_0}^2 \left( 1 - \frac{{r_0}^2}{r^2} \right)
+ {\rdot_0}^2
- \frac{m_2}{M} g \left( r - r_0 \right)
}}}
\end{aligned}
\end{equation}

\paragraph{(ii).  Motion of dangling mass not restricted to straight down}

This part of the problem treats the dangling mass as a spherical pendulum.  If \(\theta\) is the angle from the vertical
and \(\alpha\) is the angle in the horizontal plane of motion, we can describe the coordinate of the dangler
(pointing \(\zcap = \gcap\) downwards), as:

\begin{equation*}
q_2 = R( \sin\theta \cos\alpha, \sin\theta \sin\alpha, \cos\theta )
\end{equation*}

and the velocity as:
\begin{equation}\label{eqn:tongMf1:920}
\begin{aligned}
\qdot_2
&= \Rdot( \sin\theta \cos\alpha, \sin\theta \sin\alpha, \cos\theta ) \\
&+ R( \cos\theta \cos\alpha, \cos\theta \sin\alpha, -\sin\theta ) \dottheta \\
&+ R ( -\sin\theta \sin\alpha, \sin\theta \cos\alpha, 0) \dotalpha \\
\end{aligned}
\end{equation}

and can then attempt to square this mess to get the squared speed that we need for the kinetic energy term of the Lagrangian.  Instead, lets choose an alternate parametrization:

\begin{equation}\label{eqn:tongMf1:940}
\begin{aligned}
q_2 &= R \cos\theta \zcap + \Be_1 R \sin\theta e^{i\alpha} \\
\qdot_2
&= \left(\Rdot \cos\theta - R \sin\theta \dottheta\right) \zcap
+ \Be_1 e^{i\alpha} \left( \Rdot \sin\theta + R \cos\theta \dottheta + R \sin\theta i \dotalpha \right) \\
\Abs{\qdot_2}^2
&= \left(\Rdot \cos\theta - R \sin\theta \dottheta\right)^2
+ \left( \Rdot \sin\theta + R \cos\theta \dottheta\right)^2
+ (R \sin\theta \dotalpha)^2 \\
&= \Rdot^2 + (R \dottheta)^2 + (R \sin\theta \dotalpha)^2 \\
\end{aligned}
\end{equation}

Our potential is

\begin{equation*}
V = 0 - m_2 g (l-r) \cos\theta,
\end{equation*}

so, the Lagrangian is therefore:

\begin{equation}\label{eqn:tongMf1:960}
\begin{aligned}
\LL = \inv{2} m_2 \left(\rdot^2 +
(l-r)^2
\lr{ \dottheta^2 + \sin\theta \dotalpha }^2
 \right) + \inv{2} m_1 \left(\rdot^2 +
\lr{ r\dotpsi }^2
\right) + m_2 g
(l-r) \cos\theta
\end{aligned}
\end{equation}
}
