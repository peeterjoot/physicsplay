%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%
%\input{../peeter_prologue.tex}

\chapter{Spherical polar pendulum for one and multiple masses, and multivector Euler-Lagrange formulation}
\index{spherical pendulum!Geometric Algebra}
\label{chap:sPolarMultiPendulum}

%\blogpage{http://sites.google.com/site/peeterjoot/math2009/sPolarMultiPendulum.pdf}
%\date{Oct 27, 2009}
%\revisionInfo{\(RCSfile: sPolarMultiPendulum.tex,v \) Last \(Revision: 1.19 \) \(Date: 2009/12/03 03:24:40 \)}

\beginArtWithToc
%\beginArtNoToc

\section{Motivation}

The planar multiple pendulum problem proved somewhat tractable in the Hamiltonian formulation.  Generalizing this to allow for three dimensional motion is a logical next step.  Here this is attempted, using a Geometric Algebra scalar plus bivector parametrization of the spherical position of each dangling mass relative to the position of what it is attached to, as in

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo1}
\begin{aligned}
\Bz = l \Be_3 e^{j\theta}
\end{aligned}
\end{equation}

The exponential is essentially a unit quaternion, rotating the vector \(l \Be_3\) from the polar axis to its \(\theta,\phi\) angle dependent position.  Two sided rotation operators are avoided here by requiring of the unit bivector \(j = \Be_3 \wedge \Bm\), where \(\Bm\) is a vector in the plane of rotation passing through the great circle from \(\Be_3\) through \(\Bz\).  Note that we are free to pick \(\Bm = \Be_1 e^{\Be_1 \Be_2 \phi}\), the unit vector in the \(x,y\) plane at angle \(\phi\) from the x-axis.  When that is done \(j = \Be_3 \Bm\) since these are perpendicular.  Setting up the Lagrangian in terms of the bivector \(j\) instead of the scalar angle \(\phi\) will be attempted, since this is expected to have some elegance and will be a fun way to try the problem.  This should also provide a concrete example of a multivector Lagrangian in a context much simpler than electromagnetic fields or quantum mechanics.

Note finally that a number of simplifying assumptions will be made.  These include use of point masses, zero friction at the pivots and rigid nonspringy massless connecting rods between the masses.

\section{Kinetic energy for the single pendulum case}

Let us compute derivatives of the unit vector

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo2}
\begin{aligned}
\zcap = \Be_3 e^{j\theta} = e^{-j\theta} \Be_3
\end{aligned}
\end{equation}

This can be done with both the left and right factorization of \(\Be_3\), and are respectively

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo3}
\begin{aligned}
\dot{\zcap}
&= \Be_3 \left( j \thetadot e^{j\theta} + \frac{dj}{dt} \sin\theta \right) \\
&=
\Be_3
\begin{bmatrix}
j e^{j\theta} & \sin\theta
\end{bmatrix}
\frac{d}{dt}
\begin{bmatrix}
\theta \\
j
\end{bmatrix}
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo4}
\begin{aligned}
\dot{\zcap} &= \left( -j \thetadot e^{-j\theta} - \frac{dj}{dt} \sin\theta \right) \Be_3 \\
&=
\left(
\frac{d}{dt}
\begin{bmatrix}
\theta & -j
\end{bmatrix}
\right)
\begin{bmatrix}
-j e^{-j\theta} \\
\sin\theta
\end{bmatrix}
\Be_3
\end{aligned}
\end{equation}

These derivatives have been grouped into a matrix factors that allow a natural seeming conjugate operation to be defined.  That is for a matrix of multivector elements \(a_{ij}\)

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo5}
\begin{aligned}
A =
\begin{bmatrix}
a_{ij}
\end{bmatrix}
\end{aligned}
\end{equation}

define a conjugate matrix, as the transpose of the reversed elements

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo6}
\begin{aligned}
A^\dagger \equiv
\begin{bmatrix}
\tilde{a}_{ji}
\end{bmatrix}
\end{aligned}
\end{equation}

With this definition, plus two helpers

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo7}
\begin{aligned}
\BTheta &\equiv
\begin{bmatrix}
\theta \\ j
\end{bmatrix} \\
R &=
\begin{bmatrix}
j e^{j\theta} & \sin\theta
\end{bmatrix}
\end{aligned}
\end{equation}

Our velocity becomes

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo8}
\begin{aligned}
{\dot{\zcap}}^2
&= {\dot{\BTheta}}^\dagger R^\dagger R \dot{\BTheta} \\
\end{aligned}
\end{equation}

Explicitly, expanding the inner matrix product we can write

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo9}
\begin{aligned}
Q &\equiv R^\dagger R \\
&=
\begin{bmatrix}
1 & -j e^{-j\theta} \sin\theta \\
j e^{j\theta} \sin\theta & \sin^2 \theta
\end{bmatrix} \\
{\dot{\zcap}}^2
&= {\dot{\BTheta}}^\dagger Q \dot{\BTheta} \\
\end{aligned}
\end{equation}

This is a slightly unholy mix of geometric and matrix algebra, but it works to compactly express the velocity dependence.  Observe that this inner matrix \(Q = Q^\dagger\), so it is Hermitian with this definition of conjugation.

Our Lagrangian for the one particle pendulum, measuring potential energy from the horizontal, is then

% h = l(1+\cos\theta)
% \phi = m g h = m g l (1+\cos\theta)      %% then drop m g l constant term.
\begin{equation}\label{eqn:sPolarMultiPendulum:zoo10}
\begin{aligned}
\LL = {\dot{\BTheta}}^\dagger \inv{2} m l^2 Q \dot{\BTheta} - m g l \cos\theta
\end{aligned}
\end{equation}

We also have a mechanism that should generalize fairly easily to the two or many pendulum cases too.

Before continuing, it should be noted that there were assumptions made in this energy expression derivation that are not reflected in the Lagrangian above.  One of these was the unit bivector assumption for \(j\), as well as a \(\Be_3\) containment assumption for the plane this represents (\(\Be_3 \wedge j = 0\)).  So for completeness we should probably add to the Lagrangian above some Lagrange multiplier enforced constraints

\begin{equation}\label{eqn:sPolarMultiPendulum:noo6}
\begin{aligned}
\lambda ( {j}^2 + 1 ) + \alpha \cdot ( \Be_3 \wedge j )
\end{aligned}
\end{equation}

Here \(\alpha\) has got to be a trivector multiplier for the Lagrangian to be a scalar.  Can we get away with omitting these constraints?

\section{Two and multi particle case}

Having constructed a way that can express the velocity of a single spherical pendulum in a tidy way, we can move on to consider the multiple pendulum case as shown in \cref{fig:sPolarMultiPendulum:pendulumDouble}

\imageFigure{../../figures/classicalmechanics/pendulumDouble}{Double spherical pendulum}{fig:sPolarMultiPendulum:pendulumDouble}{0.4}

There are two bivectors depicted, \(j_1\) and \(j_2\) representing oriented planes passing through great circles from a local polar axis (in direction \(\Be_3\)).  Let the positions of the respective masses be \(z_1\) and \(z_2\), where each mass is connected by a rigid massless rod of length \(l_1\) and \(l_2\) respectively.  The masses are rotated by angles \(\theta_1\) and \(\theta_2\) in the planes \(j_1\) and \(j_2\) from an initial direction of \(\Be_3\).  We can express the position of the second mass as

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo11a}
\begin{aligned}
\Bz_2 = \Bz_1 + \Be_3 e^{j_2 \theta_2}
\end{aligned}
\end{equation}

We can use the same factorization as previously used for the single mass case and write for our collection of angular velocities

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo11}
\begin{aligned}
\BTheta &\equiv
\begin{bmatrix}
\theta_1 \\ j_1 \\
\theta_2 \\ j_2 \\
\end{bmatrix}
\end{aligned}
\end{equation}

Using this the total Kinetic energy is

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo12}
\begin{aligned}
K &= {\dot{\BTheta}}^\dagger \inv{2} Q \dot{\BTheta} \\
R_1 &=
\begin{bmatrix}
l_1 j_1 e^{j_1\theta_1} &
l_1 \sin\theta_1 &
0 &
0
\end{bmatrix} \\
R_2 &=
\begin{bmatrix}
 l_1 j_1 e^{j_1\theta_1} &
 l_1 \sin\theta_1 &
 l_2 j_2 e^{j_2\theta_2} &
 l_2 \sin\theta_2
\end{bmatrix} \\
Q &=
m_1 {R_1}^\dagger R_1
+m_2 {R_2}^\dagger R_2
\end{aligned}
\end{equation}

Notation has been switched slightly from the single mass case, and the \(m l^2\) factor is now incorporated directly into \(Q\) for convenience.

An expansion of \(Q\) is essentially one of block matrix multiplication (where we already have to be careful with order of operations as we do for the geometric product elements themselves).  We have something like

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo13}
\begin{aligned}
R_1 &=
\begin{bmatrix}
A_1 & 0
\end{bmatrix} \\
{R_1}^\dagger &=
\begin{bmatrix}
{A_1}^\dagger \\
0
\end{bmatrix} \\
R_2 &=
\begin{bmatrix}
A_1 & A_2
\end{bmatrix} \\
{R_2}^\dagger &=
\begin{bmatrix}
{A_1}^\dagger \\
{A_2}^\dagger \\
\end{bmatrix}
\end{aligned}
\end{equation}

We have for the products
\begin{equation}\label{eqn:sPolarMultiPendulum:zoo14}
\begin{aligned}
{R_1}^\dagger R_1 &=
\begin{bmatrix}
{A_1}^\dagger A_1 & 0 \\
0 & 0
\end{bmatrix} \\
{R_2}^\dagger R_2 &=
\begin{bmatrix}
{A_1}^\dagger A_1 & {A_1}^\dagger A_2 \\
{A_2}^\dagger A_1 & {A_2}^\dagger A_2 \\
\end{bmatrix}
\end{aligned}
\end{equation}

So our quadratic form matrix is
\begin{equation}\label{eqn:sPolarMultiPendulum:zoo15}
\begin{aligned}
Q =
\begin{bmatrix}
(m_1 + m_2) {A_1}^\dagger A_1 & m_2 {A_1}^\dagger A_2 \\
m_2 {A_2}^\dagger A_1 & m_2 {A_2}^\dagger A_2 \\
\end{bmatrix}
\end{aligned}
\end{equation}

In general for the multiple particle case this is
\begin{equation}\label{eqn:sPolarMultiPendulum:zoo16}
\begin{aligned}
Q &=
{\begin{bmatrix}
\left(\sum_{k=\max(r,c)}^N m_k \right)
{A_r}^\dagger A_c
\end{bmatrix}}_{rc} \\
A_k &= l_k
\begin{bmatrix}
j_k e^{j_k \theta_k} & \sin\theta_k
\end{bmatrix}
\end{aligned}
\end{equation}

Expanded explicitly this is

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo17}
\begin{aligned}
Q &=
{\begin{bmatrix}
\left(\sum_{k=\max(r,c)}^N m_k \right) l_r l_c
\begin{bmatrix}
- j_r e^{-j_r \theta_r} j_c e^{j_c\theta_c} & - j_r e^{-j_r \theta_r} \sin\theta_c \\
j_c e^{j_c \theta_c} \sin\theta_r & \sin\theta_r \sin\theta_c
\end{bmatrix}
\end{bmatrix}}_{rc}
\end{aligned}
\end{equation}

Observe that the order of products in this expansion is specifically ordered, since the \(j_c\) and \(j_r\) bivectors do not necessarily commute.

The potential in the multiple particle case is also fairly straightforward to compute.  Consider the two particle case to illustrate the pattern.   Using the lowest point as the potential reference we have

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo18}
\begin{aligned}
\phi' = g \sum m_i h_i
% two:
= m_1 r_1 (1 + \cos\theta_1)
+ m_2 \left( r_1(1 + \cos\theta_1) + r_2( 1 + \cos\theta_2) \right)
%+ m_3 \left( r_1(1 + \cos\theta_1) + r_2( 1 + \cos\theta_2) + r_3( 1 + \cos\theta_3) \right)
\end{aligned}
\end{equation}

Alternately, dropping all the constant terms (using the horizon as the potential reference) we have for the general case

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo19}
\begin{aligned}
\phi = g \sum_i \left( \sum_{k=i}^N m_k \right) r_i \cos\theta_i
\end{aligned}
\end{equation}

Lets collect all the bits and pieces now for the multiple pendulum Lagrangian now, repeating for coherency, and introducing a tiny bit more notation (mass sums and block angular velocity matrices) for convenience

\begin{equation}\label{eqn:sPolarMultiPendulum:zoo20}
\begin{aligned}
\LL &= K - \phi + \sum_k \lambda_k ({j_k}^2 + 1 ) \\
\BTheta_i &=
\begin{bmatrix}
\theta_i \\
j_i
\end{bmatrix} \\
\BTheta &=
{\begin{bmatrix}
\BTheta_r
\end{bmatrix}}_{r} \\
\mu_i &=
\sum_{k=i}^N m_k \\
Q &=
{\begin{bmatrix}
\mu_{\max(r,c)}
l_r l_c
\begin{bmatrix}
- j_r e^{-j_r \theta_r} j_c e^{j_c\theta_c} & - j_r e^{-j_r \theta_r} \sin\theta_c \\
j_c e^{j_c \theta_c} \sin\theta_r & \sin\theta_r \sin\theta_c
\end{bmatrix}
\end{bmatrix}}_{rc} \\
K &=
\inv{2} {\dot{\BTheta}}^\dagger Q \dot{\BTheta} \\
\phi &=
g \sum_{i=1}^N \mu_i r_i \cos\theta_i
\end{aligned}
\end{equation}

\section{Building up to the Multivector Euler-Lagrange equations}

Rather than diving right into any abstract math, lets consider a few specific examples of multivector Lagrangians to develop some comfort with non-scalar Lagrangian functions.  The generalized ``coordinates'' in the Lagrangian for the spherical pendulum problem being considered include include bivectors, and we do not know how to evaluate the Euler Lagrange equations for anything but scalar generalized coordinates.

The goal is to develop Euler-Lagrange equations that can handle a Lagrangian for these more general functions, but until we figure out how to do that, we can at least tackle the problem using variation of the action around a stationary solution.

\subsection{A first example to build intuition}

To help understand what we have to do, lets consider the very simplest bivector parametrized Lagrangian, that of a spherical pendulum constrained (perhaps by a track or a surface) of moving only in a ring.  This is shown pictorially in \cref{fig:sPolarMultiPendulum:pendulumPolarCircular}

\imageFigure{../../figures/classicalmechanics/pendulumPolarCircular}{Circularly constrained spherical pendulum}{fig:sPolarMultiPendulum:pendulumPolarCircular}{0.4}

The potential energy is fixed on this surface, so our Lagrangian is purely kinetic

\begin{equation}\label{eqn:sPolarMultiPendulum:noo1}
\begin{aligned}
\LL = -\inv{2} m l^2 \sin^2 \theta_0 {j'}^2
\end{aligned}
\end{equation}

We would like to directly vary the action for the Lagrangian around a stationary solution

\begin{equation}\label{eqn:sPolarMultiPendulum:noo2}
\begin{aligned}
S = \int \LL dt
\end{aligned}
\end{equation}

Introducing a bivector variation \(j = \overbar{j} + \epsilon\), and writing \(I = m l^2 \sin^2\theta_0\) we have

\begin{equation}\label{eqn:sPolarMultiPendulum:43}
\begin{aligned}
\overbar{S} + \delta S
&=
-\inv{2} I \int (\overbar{j}' + \epsilon')^2 dt \\
&=
-\inv{2} I \int (\overbar{j}')^2 dt
-\inv{2} I \int \left( {\overbar{j}}' \epsilon' + \epsilon' {\overbar{j}}' \right) dt
-\inv{2} I \int (\epsilon')^2 dt
\end{aligned}
\end{equation}

The first term is just \(\overbar{S}\).  Setting the variation \(\delta S = 0\) (neglecting the quadratic \(\epsilon'\) term) and integrating by parts we have

\begin{equation}\label{eqn:sPolarMultiPendulum:63}
\begin{aligned}
0 &= \delta S \\
&=
\int dt \left( \frac{d}{dt}\left( \inv{2} I {\overbar{j}}' \right) \epsilon + \epsilon \frac{d}{dt}\left( \inv{2} I {\overbar{j}}' \right) \right) \\
&=
\int \left( \frac{d}{dt} I {\overbar{j}}' \right) \cdot \epsilon dt
\end{aligned}
\end{equation}

With \(\epsilon\) arbitrary it appears that the solutions of the variation problem are given by

\begin{equation}\label{eqn:sPolarMultiPendulum:noo3}
\begin{aligned}
\frac{d}{dt}\left( I j' \right) = 0
\end{aligned}
\end{equation}

Has anything been lost by requiring that this is zero identically when all we had originally was the dot product of this with the variation bivector was zero?  If this zero describes the solution set, then we should be able to integrate this, yielding a constant.  However, following this to its logical conclusion leads to inconsistency.  Integrating \eqnref{eqn:sPolarMultiPendulum:noo3}, producing a bivector constant \(\kappa\) we have

\begin{equation}\label{eqn:sPolarMultiPendulum:noo3a}
\begin{aligned}
I j' = \kappa
\end{aligned}
\end{equation}

The original constraint on \(j\) was the bivector spanning the plane from the polar axis to the azimuthal unit vector in the \(x,y\) plane at angle a \(\phi\).  The \(\phi\) dependence was not specified, and left encoded in the bivector representation.  Without words that was

\begin{equation}\label{eqn:sPolarMultiPendulum:noo3b}
\begin{aligned}
j = \Be_3 \Be_1 e^{\Be_{12} \phi}
\end{aligned}
\end{equation}

Inserting back into \eqnref{eqn:sPolarMultiPendulum:noo3a} this gives

\begin{equation}\label{eqn:sPolarMultiPendulum:noo3c}
\begin{aligned}
\frac{d}{dt} e^{\Be_{12} \phi} = \frac{\Be_1 \Be_3 \kappa}{I}
\end{aligned}
\end{equation}

One more integration is trivially possible yielding

\begin{equation}\label{eqn:sPolarMultiPendulum:noo3d}
\begin{aligned}
e^{\Be_{12} \phi(t)} = e^{\Be_{12} \phi_0} + \frac{\Be_1 \Be_3 \kappa t}{I}
\end{aligned}
\end{equation}

There are two possibilities for the grades of \(\kappa\), one is \(\kappa \propto \Be_3 \Be_1\), so that the time dependence is a scalar, and the other is \(\kappa \propto \Be_3 \Be_2\) so that we have an \(x,y\) plane bivector component.  Allowing for both, and separating into real and imaginary parts we have

\begin{equation}\label{eqn:sPolarMultiPendulum:noo3e}
\begin{aligned}
\cos\phi - \cos\phi_0 &= \inv{I} \kappa_r t \\
\sin\phi - \sin\phi_0 &= \inv{I} \kappa_i t
\end{aligned}
\end{equation}

This is not anything close to the solution that is expected if we were to start with the scalar Lagrangian for the same problem.  That Lagrangian is

\begin{equation}\label{eqn:sPolarMultiPendulum:noo4}
\begin{aligned}
\LL = \inv{2} I \dot{\phi}^2
\end{aligned}
\end{equation}

and the Euler Lagrange equations give us, for a scalar constant \(\mu\)

\begin{equation}\label{eqn:sPolarMultiPendulum:noo5}
\begin{aligned}
I \dot{\phi} = \mu
\end{aligned}
\end{equation}

So the solution for \(\phi\) is just

\begin{equation}\label{eqn:sPolarMultiPendulum:noo5b}
\begin{aligned}
\phi - \phi_0 = \frac{\mu t}{I}
\end{aligned}
\end{equation}

In the absence of friction this makes sense.  Our angle increases monotonically, and we have circular motion with constant angular velocity.  Compare this to the messier \eqnref{eqn:sPolarMultiPendulum:noo3e} derived from the bivector ``solution'' to the variational problem.  There is definitely something wrong with the variational approach (or conclusion) when the variable is a bivector.

Does it help to include the constraints explicitly?  The bivector parametrized Lagrangian with the unit bivector multiplier constraint for this system is

\begin{equation}\label{eqn:sPolarMultiPendulum:noo20}
\begin{aligned}
\LL = -\inv{2} I (j')^2 + \lambda (j^2 + 1)
\end{aligned}
\end{equation}

Doing the variation we get a set of two equations

\begin{equation}\label{eqn:sPolarMultiPendulum:noo21}
\begin{aligned}
- I j'' &= 2 \lambda j \\
j^2 &= -1
\end{aligned}
\end{equation}

Once again re-inserting \(j = \Be_{31} e^{\Be_{12} \phi}\) one gets

\begin{equation}\label{eqn:sPolarMultiPendulum:noo22}
\begin{aligned}
e^{i\phi} = A \sin(\sqrt{I/2\lambda} t) + B \cos(\sqrt{I/2\lambda} t)
\end{aligned}
\end{equation}

Setting \(\lambda = 1\), \(A = i\), \(B = 1\), we have

\begin{equation}\label{eqn:sPolarMultiPendulum:noo23}
\begin{aligned}
\phi \propto t
\end{aligned}
\end{equation}

This is now consistent with the scalar Lagrangian treatment.  In both cases we have the angle linearly proportional to time, and have a single parameter to adjust the angular velocity (used \(\mu\) in the scalar treatment above and have \(\lambda\) this time (although it was set to one here for convenience).  The conclusion has to be that the requirement to include the multipliers for the constraints is absolutely necessary to get the right physics out of this bivector parametrized Lagrangian.  The good news is that we can get the right physics out of a non-scalar treatment.  What is a bit disturbing is that it was fairly difficult in the end to get from the results of the variation to a solution, and that this will not likely get any easier with a more complex system.

%It appears that one has the freedom to use a trig or hyperbolic basis by picking the sign of \(\lambda\), setting \(A = i\), and \(B = 1\)
%
%Based on knowledge of the correct answer, there is one possible route to resolution to the troubles here.  If we agree that \eqnref{eqn:sPolarMultiPendulum:noo3a} is a constant, then its square is also constant, which gives
%
%\begin{align}\label{eqn:sPolarMultiPendulum:noo5c}
%(I j' )^2 = -m^2 l^4 (\phi')^2 = \text{constant}
%\end{align}
%
%Now we have exactly the scalar Lagrangian solution, and can take roots (using a new constant), for
%
%\begin{align}\label{eqn:sPolarMultiPendulum:noo5d}
%I \phi' = \text{constant}
%\end{align}
%
%This is the correct result, but to get it required an unjustified mathematical step.  I will need to return to this and figure out if this is the correct general approach, and if it is what was missed in the variational process.  Lets assume temporarily that this an be resolved, and continue working towards how to derive the multivector Euler-Lagrange equations in general.
%
%FIXME: This out of sequence approach is also because I did not initially spot the inconsistency when working up to the multivector Euler-Lagrange equations.  Some reorganization of the organic ordering of these notes is required to fix that.

\subsection{A second example}

%FIXME: same problems with constant and zeros as above.  Note these explicitly.

The scalar expansion \eqnref{eqn:sPolarMultiPendulum:scalarExpansion} of the kinetic term in our spherical polar Lagrangian shows a couple of other specific multivector functions we can consider the variation of.

We have considered an specific example of a Lagrangian function \(\LL = f(j' \cdot j')\) without (yet) utilizing or deriving a multivector form of the Euler-Lagrange equations.  Let us consider a few more specific simple examples motivated by the expansion of the kinetic energy in \eqnref{eqn:sPolarMultiPendulum:scalarExpansion}.  Lets start with

\begin{equation}\label{eqn:sPolarMultiPendulum:noo7}
\begin{aligned}
\LL = \theta' a \cdot j'
\end{aligned}
\end{equation}

where \(a\) is a bivector constant, \(\theta\) a scalar, and \(j\) a bivector variable for the system.  Expanding this around stationary points \(j = \overbar{j} + \epsilon\), and \(\theta = \overbar{\theta} + \phi\) we have to first order

\begin{equation}\label{eqn:sPolarMultiPendulum:83}
\begin{aligned}
\int \delta \LL dt
&\approx \int \left( \phi' a \cdot \overbar{j}' + \overbar{\theta}' a \cdot \epsilon' \right) dt \\
&= \int \left( \phi \frac{d}{dt}( - a \cdot \overbar{j}' ) + \frac{d}{dt}( - \overbar{\theta}' a ) \cdot \epsilon \right) dt \\
\end{aligned}
\end{equation}

In this simple system where both scalar variable \(\theta\) and bivector variable \(j\) are cyclic ``coordinates'', we have solutions to the variational problem given by the pair of equations

\begin{equation}\label{eqn:sPolarMultiPendulum:noo8}
\begin{aligned}
- a \cdot j' &= \text{constant} \\
- \theta' a &= \text{constant}
\end{aligned}
\end{equation}

As to what, if anything, this particular Lagrangian (a fragment picked out of a real Kinetic energy function) represents physically that does not matter so much, since the point of this example was to build up to treating the more general case where we are representing something physical.

\subsection{A third example}

If we throw a small additional wrench into the problem above and allow \(a\) to be one of the variables our system is dependent on.

\begin{equation}\label{eqn:sPolarMultiPendulum:noo9a}
\begin{aligned}
\LL(\theta, \theta', a, a', j, j') = \theta' a \cdot j'
\end{aligned}
\end{equation}

It is less obvious how to do a first order Taylor expansion of this Lagrangian required for the variation around the stationary solution.  If all the coordinates in the Lagrangian were scalars as in

\begin{equation}\label{eqn:sPolarMultiPendulum:noo9}
\begin{aligned}
\LL(\theta, \theta', a, a', j, j') = \theta' a j'
\end{aligned}
\end{equation}

(dropping dot products now that these are all scalar variables), then the variation requires nothing abnormal.  Suppose our stationary point has coordinates \(\overbar{\theta}, \overbar{a}, \overbar{j}\), with variations \(\alpha, \beta, \gamma\) that vanish at the extremes of the integral as usual.

With scalar variables our path is clear, and we just form

\begin{equation}\label{eqn:sPolarMultiPendulum:103}
\begin{aligned}
\delta S &= \int \delta \LL \\
&=
\int \left(
\alpha \PD{\theta}{\LL}
+\alpha' \PD{\theta'}{\LL}
+\beta \PD{a}{\LL}
+\beta' \PD{a'}{\LL}
+\gamma \PD{j}{\LL}
+\gamma' \PD{j'}{\LL}
\right) \\
\end{aligned}
\end{equation}

Here is it implied that all the partials are evaluated at the stationary points \(\overbar{\theta}, \overbar{a}, \overbar{j}\).  Doing the integration by parts we have

\begin{equation}\label{eqn:sPolarMultiPendulum:123}
\begin{aligned}
\delta S
&=
\int \left(
\alpha \left( \PD{\theta}{\LL} - \frac{d}{dt} \PD{\theta'}{\LL} \right)
+\beta \left( \PD{a}{\LL} - \frac{d}{dt} \PD{a'}{\LL} \right)
+\gamma \left( \PD{j}{\LL} - \frac{d}{dt} \PD{j'}{\LL} \right)
\right)
\end{aligned}
\end{equation}

Setting \(\delta S = 0\) this produces the Euler-Lagrange equations for the system.  For our specific Lagrangian this procedure gives

\begin{equation}\label{eqn:sPolarMultiPendulum:143}
\begin{aligned}
\int \delta \LL
&=
\int \alpha' \overbar{a} \overbar{j}' + \overbar{\theta}' \beta \overbar{j}' + \overbar{\theta}' \overbar{a} \gamma' \\
&=
\int \alpha \frac{d}{dt}\left( - \overbar{a} \overbar{j}' \right) + \overbar{\theta}' \beta \overbar{j}' + \frac{d}{dt}\left( -\overbar{\theta}' \overbar{a}\right) \gamma \\
\end{aligned}
\end{equation}

Each time we do the first order expansion we are varying just one of the coordinates.  It seems likely that the correct answer for the multivariable case will be

\begin{equation}\label{eqn:sPolarMultiPendulum:163}
\begin{aligned}
\int \delta \LL
&=
\int \alpha \frac{d}{dt}\left( - \overbar{a} \cdot \overbar{j}' \right) + \beta \cdot (\overbar{\theta}' \overbar{j}') + \frac{d}{dt}\left( -\overbar{\theta}' \overbar{a}\right) \cdot \gamma \\
\end{aligned}
\end{equation}

Thus the variational problem produces solutions (the coupled equations we still have to solve) of

\begin{equation}\label{eqn:sPolarMultiPendulum:noo10}
\begin{aligned}
- a \cdot j' &= \text{constant} \\
\theta' j' &= 0 \\
-\theta' a &= \text{constant}
\end{aligned}
\end{equation}

\section{Multivector Euler-Lagrange equations}

\subsection{Derivation}

Having considered a few specific Lagrangians dependent on multivector generalized ``coordinates'', some basic comfort that it is at least possible has been gained.  Let us now move on to the general case.  It is sufficient to consider Lagrangian functions that only depend on blades, since we can write any more general multivector as a sum of such blades

Write

\begin{equation}\label{eqn:sPolarMultiPendulum:roo1}
\begin{aligned}
\LL = \LL(X_k, X_k')
\end{aligned}
\end{equation}

where \(X_k \in \bigwedge^{m_k}\) is a blade of grade \(m_k\).  We can do a regular old chain rule expansion of this Lagrangian if coordinates are (temporarily) introduced for each of the blades \(X_k\).  For example, if \(X\) is a bivector in \R{3}, we can write

\begin{equation}\label{eqn:sPolarMultiPendulum:183}
\begin{aligned}
X =
\Be_{12} a^{12} +
\Be_{13} a^{13} +
\Be_{23} a^{23}
\end{aligned}
\end{equation}

and then we can do a first order Taylor series expansion of \(\LL(\overbar{X} + \Bepsilon)\) in terms of these coordinates.  With \(\Bepsilon = \Be_{12}\epsilon^{12} + \Be_{13}\epsilon^{13} + \Be_{23}\epsilon^{23}\), for this specific single variable Lagrangian we have

\begin{equation}\label{eqn:sPolarMultiPendulum:203}
\begin{aligned}
\delta \LL
&= \LL(\overbar{X} + \Bepsilon) - \LL(\overbar{X}) \\
&\approx
\epsilon^{12} \evalbar{\PD{a^{12}}{\LL}}{\overbar{X}}
+\epsilon^{23} \evalbar{\PD{a^{23}}{\LL}}{\overbar{X}}
+\epsilon^{13} \evalbar{\PD{a^{13}}{\LL}}{\overbar{X}}
\end{aligned}
\end{equation}

If we write the coordinate expansion of our blades \(X_k\) as

\begin{equation}\label{eqn:sPolarMultiPendulum:223}
\begin{aligned}
X_k = \sum_{b_k} {x_k}^{b_k} \sigma_{b_k}
\end{aligned}
\end{equation}

where \(b_k\) is some set of indices like \(\{12, 23, 13\}\) from the \R{3} bivector example, then our chain rule expansion of the Lagrangian to first order about a stationary point becomes

\begin{equation}\label{eqn:sPolarMultiPendulum:roo2}
\begin{aligned}
\delta \LL %(\overbar{X}_k + \epsilon_k, \overbar{X}_k' + \epsilon_k')
&=
\sum_{b_k} {\epsilon_k}^{b_k} \evalbar{ \PD{{x_k}^{b_k}}{\LL} }{\overbar{X}_k, \overbar{X}_k'}
+\sum_{b_k} ({\epsilon_k}^{b_k})' \evalbar{ \PD{({x_k}^{b_k})'}{\LL} }{\overbar{X}_k, \overbar{X}_k'}
\end{aligned}
\end{equation}

Trying to write this beastie down with abstract indexing variables is a bit ugly.  There is something to be said for not trying to be general since writing this for the single variable bivector example was much clearer.  However, having written down the ugly beastie, it can now be cleaned up nicely by introducing position and velocity gradient operators for each of the grades

\begin{equation}\label{eqn:sPolarMultiPendulum:roo3}
\begin{aligned}
\grad_{X_k} &\equiv \sigma^{b_k} \PD{{x_k}^{b_k}}{} \\
\grad_{X_k'} &\equiv \sigma^{b_k} \PD{({x_k}^{b_k})'}{}
\end{aligned}
\end{equation}

Utilizing this (assumed) orthonormal basis pair \(\sigma^{b_k} \cdot \sigma_{b_j} = {\delta^k}_j\) we have

\begin{equation}\label{eqn:sPolarMultiPendulum:243}
\begin{aligned}
\delta S
&= \int \delta \LL \\
&=
\int \sum_k
\Bepsilon_k \cdot \evalbar{ \grad_{X_k} \LL }{\overbar{X}_k, \overbar{X}_k'}
+{\Bepsilon_k}' \cdot \evalbar{ \grad_{X_k'} \LL }{\overbar{X}_k, \overbar{X}_k'} \\
&=
\int \sum_k
\Bepsilon_k \cdot \left( \evalbar{ \grad_{X_k} \LL }{\overbar{X}_k, \overbar{X}_k'} - \frac{d}{dt} \evalbar{ \grad_{X_k'} \LL }{\overbar{X}_k, \overbar{X}_k'} \right) \\
\end{aligned}
\end{equation}

Setting \(\delta S = 0\) we have a set of equations for each of the blade variables, and the Euler-Lagrange equations take the form

\begin{equation}\label{eqn:sPolarMultiPendulum:roo4}
\begin{aligned}
\grad_{X_k} \LL = \frac{d}{dt} \grad_{X_k'} \LL
\end{aligned}
\end{equation}

\subsection{Work some examples}

For the pendulum problem we are really only interested in applying \eqnref{eqn:sPolarMultiPendulum:roo4} for scalar and bivector variables.  Let us revisit some of the example Lagrangians, functions of bivectors, already considered and see how we can evaluate the position and velocity gradients.  This generalized Euler-Lagrange formulation does not do much good if we can not work with it.

Let us take the bivector gradient of a couple bivector functions (all the ones considered previously leading up to the multivector Euler-Lagrange equations).

\begin{equation}\label{eqn:sPolarMultiPendulum:263}
\begin{aligned}
f(B) &= A \cdot B \\
g(B) &= B^2
\end{aligned}
\end{equation}

It is actually sufficient (in a less than 4D space) to consider only the first,

\begin{equation}\label{eqn:sPolarMultiPendulum:283}
\begin{aligned}
\grad_B f
&= \grad_B \gpgradezero{ A B } \\
&= \sum_{a<b} \sigma^{ab} \PD{b^{ab}}{} \gpgradezero{ A b^{a'b'} \sigma_{a'b'} } \\
&= \sum_{a<b} \sigma^{ab} \gpgradezero{ A \sigma_{ab} } \\
&= \sum_{a<b} \sigma^{ab} A \cdot \sigma_{ab} \\
&= A
\end{aligned}
\end{equation}

For \(g\) we then have

\begin{equation}\label{eqn:sPolarMultiPendulum:303}
\begin{aligned}
\grad_B g
&= \grad_B B B \\
&= \grad_B \gpgradezero{ B B} \\
&= 2 B
\end{aligned}
\end{equation}

This is now enough to evaluate our bivector parametrized Lagrangian from the first example, \eqnref{eqn:sPolarMultiPendulum:noo20}, reproducing the result obtained by direct variation (as in Feynman's lectures)

\begin{equation}\label{eqn:sPolarMultiPendulum:323}
\begin{aligned}
\frac{d}{dt} \grad_{j'} \LL &= \grad_{j} \LL \\
- I j'' &= \\
        &= 2 \lambda j
\end{aligned}
\end{equation}

By inspection we can see that this works for the remaining two motivational examples too.

\section{Evaluating the pendulum Euler-Lagrange equations (scalar, bivector parametrized KE)}

We now have the tools to evaluate the Euler-Lagrange equations for the pendulum problem \eqnref{eqn:sPolarMultiPendulum:zoo20}.  Since all the \(d{\theta}_a/dt\) and \(dj_a/dt\) dependence is in the kinetic energy we can start with that.  For

\begin{equation}\label{eqn:sPolarMultiPendulum:eoo1}
\begin{aligned}
K = \inv{2} \dot{\BTheta}^\dagger Q \dot{\BTheta}
\end{aligned}
\end{equation}

We want each of \(\PD{\dot{\theta}_a}{K}\) and \(\grad_{j_a'} K\).  Of these the \(\dot{\theta}\) derivative is easier, so lets start with that

\begin{equation}\label{eqn:sPolarMultiPendulum:343}
\begin{aligned}
\PD{\theta_a}{K}
&=
\inv{2} \left( \PD{\dot{\theta}_a}{\dot{\BTheta}}^\dagger \right) Q \dot{\BTheta}
+\inv{2} \dot{\BTheta}^\dagger Q \left( \PD{\dot{\theta}_a}{\dot{\BTheta}} \right)  \\
\end{aligned}
\end{equation}

Each of these are scalars and thus equal their Hermitian conjugate.  This leaves us with just one term doubled

\begin{equation}\label{eqn:sPolarMultiPendulum:363}
\begin{aligned}
\PD{\theta_a}{K}
&=
\dot{\BTheta}^\dagger Q \left( \PD{\dot{\theta}_a}{\dot{\BTheta}} \right) \\
\end{aligned}
\end{equation}

A final evaluation of the derivatives, in block matrix form over rows \(r\), gives us

\begin{equation}\label{eqn:sPolarMultiPendulum:eoo2}
\begin{aligned}
\PD{\theta_a}{K}
=
\dot{\BTheta}^\dagger Q
{\begin{bmatrix}
\delta_{ar}
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\end{bmatrix}}_{r}
\end{aligned}
\end{equation}

For the bivector velocity gradients, we can do the same,

\begin{equation}\label{eqn:sPolarMultiPendulum:383}
\begin{aligned}
\grad_{j_a'} K
&=
\inv{2} \left( \rgrad_{j_a'} \dot{\BTheta}^\dagger \right) Q \dot{\BTheta}
+\inv{2} \dot{\BTheta}^\dagger Q \left( \dot{\BTheta} \lgrad_{j_a'} \right)  \\
\end{aligned}
\end{equation}

Only the \(j_a'\) parts of \(\dot{\BTheta}\) contribute to the velocity gradients, so we need to know how to evaluate a bivector gradient (as opposed to the square which was done earlier).  Expanding in coordinates

\begin{equation}\label{eqn:sPolarMultiPendulum:403}
\begin{aligned}
\grad_j j
&= \inv{2} \sum_{a b} \sigma^{ab} \PD{j^{ab}}{} \inv{2} \sum_{a'b'} \sigma_{a' b'} j^{a' b'} \\
&= \inv{2} \sum_{a b} \sigma^{ab} \sigma_{a b} \\
&= 3
\end{aligned}
\end{equation}

(three here because we are in \R{3}, and our bivectors have three independent coordinates).

\begin{equation}\label{eqn:sPolarMultiPendulum:423}
\begin{aligned}
\grad_{j_a'} K
&=
\frac{3}{2}
{\begin{bmatrix}
\delta_{ac}
\begin{bmatrix}
0 & -1
\end{bmatrix}
\end{bmatrix}}_{c}
Q \dot{\BTheta}
+\frac{3}{2} \dot{\BTheta}^\dagger Q
{\begin{bmatrix}
\delta_{ar}
\begin{bmatrix}
0 \\
1
\end{bmatrix}
\end{bmatrix}}_{r}
\end{aligned}
\end{equation}

These terms are both one-by-one bivector matrices, and negate with Hermitian conjugation, so we can again double up and eliminate one of the two terms, producing

\begin{equation}\label{eqn:sPolarMultiPendulum:eoo3}
\begin{aligned}
\grad_{j_a'} K
&=
 3 \dot{\BTheta}^\dagger Q
{\begin{bmatrix}
\delta_{ar}
\begin{bmatrix}
0 \\
1
\end{bmatrix}
\end{bmatrix}}_{r}
\end{aligned}
\end{equation}

Completing the Euler-Lagrange equation evaluation we have for the \(\theta_a\) coordinates

\begin{equation}\label{eqn:sPolarMultiPendulum:eoo4}
\begin{aligned}
\frac{d}{dt} \left(
\dot{\BTheta}^\dagger Q
{\begin{bmatrix}
\delta_{ar}
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\end{bmatrix}}_{r}
\right)
=
\inv{2} \dot{\BTheta}^\dagger \PD{\theta_a}{Q} \dot{\BTheta} - \PD{\theta_a}{\phi}
\end{aligned}
\end{equation}

plus one equation for each of the bivectors \(j_a\)

\begin{equation}\label{eqn:sPolarMultiPendulum:eoo5}
\begin{aligned}
 3 \frac{d}{dt} \left(
\dot{\BTheta}^\dagger Q
{\begin{bmatrix}
\delta_{ar}
\begin{bmatrix}
0 \\
1
\end{bmatrix}
\end{bmatrix}}_{r}
\right)
=
\inv{2} \sum_{e < f} \Be_f \Be_e \dot{\BTheta}^\dagger \PD{{j_a}^{e f}}{Q} \dot{\BTheta} + 2 \lambda_a j_a
\end{aligned}
\end{equation}

Because the bivector \(\Be_f \Be_e\) does not (necessarily) commute with bivectors \(j_a'\) that are part of \(\dot{\BTheta}\) there does not look like there is much hope of assembling the left hand \(j_a\) gradients into a nice non-coordinate form.  Additionally, looking back at this approach, and the troubles with producing meaningful equations of motion even in the constrained single pendulum case, it appears that a bivector parametrization of the kinetic energy is generally not a good approach.  This is an unfortunate conclusion after going through all the effort to develop intuition that led to the multivector Euler-Lagrange formulation for this problem.

Oh well.

The Hermitian formulation used here should still provide a nice compact way of expressing the kinetic energy, even if we work with plain old scalar spherical polar angles \(\theta\), and \(\phi\).  Will try this another day, since adding that to these notes will only make them that much more intractable.

%\section{Multivector Hamiltonian}
%
%TODO.
%
%\section{Evaluating the Hamiltonian pendulum equations}
%
%TODO.

\section{Appendix calculation.  A verification that the Kinetic matrix product is a real scalar}

In the kinetic term of the rather scary looking Lagrangian of \eqnref{eqn:sPolarMultiPendulum:zoo20} we have what should be a real scalar, but it is not obvious that this is the case.  As a validation that nothing very bad went wrong, it seems worthwhile to do a check that this is in fact the case, expanding this out explicitly in gory detail.

One way to try this expansion is utilizing a block matrix summing over the diagonal and paired skew terms separately.  That is

\begin{equation}\label{eqn:sPolarMultiPendulum:443}
\begin{aligned}
K &=
\inv{2}
\sum_{k=1}^N
\mu_k
{l_k}^2
{\dot{\BTheta}_k}^\dagger
\begin{bmatrix}
1 & - j_k e^{-j_k \theta_k} \sin\theta_k \\
j_k e^{j_k \theta_k} \sin\theta_k & \sin^2\theta_k
\end{bmatrix}
\dot{\BTheta}_k \\
&+
\inv{2}
\sum_{a<b}
\mu_b
l_a l_b \\
&\qquad
\left(
{\dot{\BTheta}_a}^\dagger
\begin{bmatrix}
- j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} & - j_a e^{-j_a \theta_a} \sin\theta_b \\
j_b e^{j_b \theta_b} \sin\theta_a & \sin\theta_a \sin\theta_b
\end{bmatrix}
\dot{\BTheta}_b
+
{\dot{\BTheta}_b}^\dagger
\begin{bmatrix}
- j_b e^{-j_b \theta_b} j_a e^{j_a\theta_a} & - j_b e^{-j_b \theta_b} \sin\theta_a \\
j_a e^{j_a \theta_a} \sin\theta_b & \sin\theta_b \sin\theta_a
\end{bmatrix}
\dot{\BTheta}_a
\right)
\end{aligned}
\end{equation}

Examining the diagonal matrix products and expanding one of these (dropping the \(k\) suffix for tidiness), we have

\begin{equation}\label{eqn:sPolarMultiPendulum:moo1}
\begin{aligned}
{\dot{\BTheta}}^\dagger
\begin{bmatrix}
1 & - j e^{-j \theta} \sin\theta \\
j e^{j \theta} \sin\theta & \sin^2\theta
\end{bmatrix}
\dot{\BTheta}
&=
\dot{\theta}^2 -\sin^2\theta \left(\frac{dj}{dt}\right)^2 - \dot{\theta} \sin\theta\cos\theta \left( j \frac{dj}{dt} + \frac{dj}{dt} j \right)
\end{aligned}
\end{equation}

Since we are working in 3D this symmetric sum is twice the dot product of the bivector \(j\) with its derivative, which means that it is a scalar.  We expect this to be zero though, and can observe that this is the case since \(j\) was by definition a unit bivector

\begin{equation}\label{eqn:sPolarMultiPendulum:moo2}
\begin{aligned}
j \frac{dj}{dt} + \frac{dj}{dt} j = \frac{d j^2}{dt} = \frac{d (-1)}{dt} = 0
\end{aligned}
\end{equation}

(thus \(j\) and its derivative represent orthogonal oriented planes rather like \(\rcap\) and its derivative are orthogonal on a circle or sphere).  The implication is that the diagonal subset of the kinetic energy expansion contains just

\begin{equation}\label{eqn:sPolarMultiPendulum:moo3}
\begin{aligned}
\inv{2}
\sum_{k=1}^N
\mu_k
{l_k}^2
\left(
\left(\frac{d\theta_k}{dt}\right)^2 -\sin^2\theta_k \left(\frac{d j_k}{dt}\right)^2  \right)
\end{aligned}
\end{equation}

If we are going to have any complex interaction terms then they will have to come from the off diagonal products.  Expanding the first of these

\begin{equation}\label{eqn:sPolarMultiPendulum:463}
\begin{aligned}
{\dot{\BTheta}_a}^\dagger
&\begin{bmatrix}
- j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} & - j_a e^{-j_a \theta_a} \sin\theta_b \\
j_b e^{j_b \theta_b} \sin\theta_a & \sin\theta_a \sin\theta_b
\end{bmatrix}
\dot{\BTheta}_b \\
&=
\begin{bmatrix}
\theta_a' & -j_a'
\end{bmatrix}
\begin{bmatrix}
- j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} & - j_a e^{-j_a \theta_a} \sin\theta_b \\
j_b e^{j_b \theta_b} \sin\theta_a & \sin\theta_a \sin\theta_b
\end{bmatrix}
\begin{bmatrix}
\theta_b' \\
j_b'
\end{bmatrix} \\
&=
\begin{bmatrix}
\theta_a' & -j_a'
\end{bmatrix}
\begin{bmatrix}
- j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} \theta_b' - j_a e^{-j_a \theta_a} \sin\theta_b j_b' \\
j_b e^{j_b \theta_b} \sin\theta_a \theta_b' + \sin\theta_a \sin\theta_b j_b'
\end{bmatrix} \\
&=
- j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} \theta_a' \theta_b' - j_a e^{-j_a \theta_a} \sin\theta_b \theta_a' j_b' -j_a' j_b e^{j_b \theta_b} \sin\theta_a \theta_b' - \sin\theta_a \sin\theta_b j_a' j_b'
\end{aligned}
\end{equation}

Adding to this the \(a \leftrightarrow b\) exchanged product and rearranging yields

\begin{equation}\label{eqn:sPolarMultiPendulum:483}
\begin{aligned}
- \theta_a' \theta_b' (j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} + j_b e^{-j_b \theta_b} j_a e^{j_a\theta_a} ) - \sin\theta_a \sin\theta_b (j_a' j_b' + j_b' j_a') \\
- \sin\theta_b \theta_a' ( j_a e^{-j_a \theta_a} j_b' + j_b' j_a e^{j_a \theta_a} )
- \sin\theta_a \theta_b' ( j_b e^{-j_b \theta_b} j_a' + j_a' j_b e^{j_b \theta_b} )
\end{aligned}
\end{equation}

Each of these multivector sums within the brackets is of the form \(A + \tilde{A}\), a multivector plus its reverse.  There can therefore be no bivector or trivector terms since they negate on reversal, and the resulting sum can have only scalar and vector grades.  Of these the second term, \(j_a' j_b' + j_b' j_a' = 2 j_a' \cdot j_b'\) so it is unarguably a scalar as expected, but additional arguments are required to show this of the other three terms.  Of these remaining three, the last two have the same form.  Examining the first of these two

\begin{equation}\label{eqn:sPolarMultiPendulum:503}
\begin{aligned}
j_b e^{-j_b \theta_b} j_a' + j_a' j_b e^{j_b \theta_b}
&=
(j_b \cos\theta_b + \sin\theta_b) j_a' + j_a' (j_b \cos\theta_b - \sin\theta_b) \\
&=
\cos\theta_b (j_b j_a' + j_a' j_b ) \\
&=
2 \cos\theta_b (j_b \cdot j_a')
\end{aligned}
\end{equation}

The first term actually expands in a similarly straightforward way.  The vector terms all cancel, and one is left with just

\begin{equation}\label{eqn:sPolarMultiPendulum:523}
\begin{aligned}
j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} + j_b e^{-j_b \theta_b} j_a e^{j_a\theta_a}
=
2 \cos\theta_a\cos\theta_b j_a \cdot j_b - 2 \sin\theta_a \sin\theta_b
\end{aligned}
\end{equation}

Writing \(S_{\theta_k} = \sin\theta_k\) and \(C_{\theta_k} = \cos\theta_k\) (for compactness to fit things all in since the expanded result is messy), all of this KE terms can be assembled into the following explicit scalar expansion

\begin{equation}\label{eqn:sPolarMultiPendulum:scalarExpansion}
\begin{array}{l l}
K &=
\inv{2}
\sum_{k=1}^N
\mu_k
{l_k}^2
\left( (\theta_k')^2 - (S_{\theta_k} j_k')^2 \right) \\
&-
\sum_{a<b}
\mu_b
l_a l_b \\
&\qquad \left(
\theta_a' \theta_b' (C_{\theta_a}C_{\theta_b} (j_a \cdot j_b) - S_{\theta_a} S_{\theta_b} )
+S_{\theta_a} S_{\theta_b} (j_a' \cdot j_b')
+S_{\theta_b} C_{\theta_b} \theta_a' (j_b \cdot j_a')
+S_{\theta_a} C_{\theta_a} \theta_b' (j_a \cdot j_b')
\right)
\end{array}
\end{equation}

Noting that all the bivector, bivector dot products are scalars really completes the desired verification.  We can however, be more explicit using \(j_a = \Be_{31} e^{\Be_{12}\phi_a}\), which gives after a bit of manipulation

\begin{equation}\label{eqn:sPolarMultiPendulum:moo4}
\begin{aligned}
j_a \cdot j_b &= - \cos(\phi_a - \phi_b) \\
(j_a')^2 &= -(\phi_a')^2 \\
j_a \cdot j_b' &= \phi_b' \sin(\phi_a - \phi_b) \\
j_a' \cdot j_b' &= -\phi_a' \phi_b' \cos(\phi_a - \phi_b)
\end{aligned}
\end{equation}

These can then be inserted back into \eqnref{eqn:sPolarMultiPendulum:scalarExpansion} in a straightforward fashion, but it is not any more illuminating to do so.

%%\EndArticle
%\EndNoBibArticle
