%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{midterm2reflection}
%\renewcommand{\dirname}{notes/phy452/}
%\newcommand{\keywords}{Statistical mechanics, PHY452H1S, magnetic field, spin, partition function, magnetization, perturbation, classical harmonic oscillator, average energy, specific heat}
%
%\newcommand{\nbref}[1]{notes/phy452/mathematica/#1}
%
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{Midterm II reflection}
%\chapter{Midterm II reflection}
\label{chap:midterm2reflection}

%Here's some reflection about this Thursday's midterm, redoing the problems without the mad scramble.  I don't think my results are too different from what I did in the midterm, even doing them casually now, but I'll have to see after grading if these solutions are good.

\makeoproblem{Magnetic field spin level splitting}{pr:midterm2reflection:1}{2013 midterm II p1}{
%(5 points)
A particle with spin \(S\) has \(2 S + 1\) states \(-S, -S + 1, \cdots S-1, S\).  When exposed to a magnetic field, state splitting results in energy \(E_m = \Hbar m B\).  Calculate the partition function, and use this to find the temperature specific magnetization.  A ``sum the geometric series'' hint was given.
} % makeoproblem

\makeanswer{pr:midterm2reflection:1}{ 

Our partition function is

\begin{dmath}\label{eqn:midterm2reflection:20}
Z 
= \sum_{m = -S}^S e^{-\Hbar \beta m B}
= 
e^{-\Hbar \beta S B}
\sum_{m = -S}^S e^{-\Hbar \beta (m + S) B}
= 
e^{\Hbar \beta S B}
\sum_{n = 0}^{2 S} e^{-\Hbar \beta n B}.
\end{dmath}

Writing

\begin{equation}\label{eqn:midterm2reflection:40}
a = e^{-\Hbar \beta B},
\end{equation}

that is

\begin{dmath}\label{eqn:midterm2reflection:560}
Z = 
a^{-S}
\sum_{n = 0}^{2 S} a^n 
=
a^{-S} \frac{ a^{2 S + 1} - 1 }{a - 1}
=
\frac{ a^{S + 1} - a^{-S} }{a - 1}
=
\frac{ a^{S + 1/2} - a^{-S - 1/2} }{a^{1/2} - a^{-1/2}}.
\end{dmath}

Substitution of \(a\) gives us
\boxedEquation{eqn:midterm2reflection:80}{
Z = 
\frac
{ \sinh( \Hbar \beta B (S + 1/2) ) }
{ \sinh( \Hbar \beta B /2 )  }.
}

To calculate the magnetization \(M\), I used

\begin{equation}\label{eqn:midterm2reflection:100}
M = -\expectation{H}/B.
\end{equation}

As \citep{kittel1980thermal} defines magnetization for a spin system.  It was pointed out to me after the test that magnetization was defined differently in class as

\begin{equation}\label{eqn:midterm2reflection:140}
\mu = \PD{B}{F}.
\end{equation}

These are, up to a sign, identical, at least in this case, since we have \(\beta\) and \(B\) traveling together in the partition function.

In terms of the average energy

\begin{dmath}\label{eqn:midterm2reflection:580}
M = -\frac{\expectation{H}}{B}
= \inv{B} \PD{\beta}{} \ln Z(\beta B)
= \inv{Z B} \PD{\beta}{}Z(\beta B)
= \inv{Z} \PD{(\beta B)}{} Z(\beta B)
\end{dmath}

Compare this to the in-class definition of magnetization

\begin{dmath}\label{eqn:midterm2reflection:180}
\mu 
= \PD{B}{F}
= \PD{B}{} \lr{ - \kB T \ln Z(\beta B) }
= -\PD{B}{} \frac{\ln Z (\beta B)}{\beta}
= -\inv{\beta Z} \PD{B}{} Z(\beta B)
= -\inv{Z} \PD{(\beta B)}{} Z(\beta B).
\end{dmath}

Defining the magnetic moment in either of these fashions is really a cheat, because it's done without any connection to physics of the situation.  In \S 3.9 of \citep{pathriastatistical} is a much better seeming approach, where the moment is defined as \(M_z = -\expectation{\Bmu \cdot \BH}/H\), but this is then shown to have the form \eqnref{eqn:midterm2reflection:180}.

\paragraph{Calculating it}

For this derivative we have

\begin{dmath}\label{eqn:midterm2reflection:600}
\PD{(\beta B)}{} \ln Z
=
\PD{(\beta B)}{} \ln 
\frac
{ \sinh( \Hbar \beta B (S + 1/2) ) }
{ \sinh( \Hbar \beta B /2 )  }
=
\PD{(\beta B)}{} \lr{
   \ln \sinh( \Hbar \beta B (S + 1/2) ) 
   - \ln \sinh( \Hbar \beta B /2 ) 
}
=
\frac{\Hbar }{2}
\lr{
   (2 S + 1) \coth( \Hbar \beta B (S + 1/2) ) 
   - \coth( \Hbar \beta B /2 ) 
}.
\end{dmath}

This gives us
\begin{dmath}\label{eqn:midterm2reflection:620}
\mu 
= 
-\inv{Z} 
\frac{\Hbar }{2}
\lr{
   (2 S + 1) \coth( \Hbar \beta B (S + 1/2) ) 
   - \coth( \Hbar \beta B /2 ) 
}
=
-
\frac
{ \sinh( \Hbar \beta B /2 )  }
{ \sinh( \Hbar \beta B (S + 1/2) ) }
\frac{\Hbar }{2}
\lr{
   (2 S + 1) \coth( \Hbar \beta B (S + 1/2) ) 
   - \coth( \Hbar \beta B /2 ) 
}
\end{dmath}

After some simplification (done offline in \nbref{midtermTwoQ1FinalSimplificationMu.nb}) we get

\boxedEquation{eqn:midterm2reflection:240}{
\mu
=
\Hbar 
\frac{
(s+1) \sinh(\Hbar \beta B s)
-s \sinh(\Hbar \beta B (s+1))
}{
\cosh(\Hbar \beta B(2 s+1)) - 1
}.
}

I got something like this on the midterm, but recall doing it somehow much differently (after getting my marked paper back, saw that was because I'd made an error, and everything after that got messed up).

} % makeanswer

\makeoproblem{Perturbation of classical harmonic oscillator}{pr:midterm2reflection:2}{2013 midterm II p2}{ 
%(10 points)

Consider a single particle perturbation of a classical simple harmonic oscillator Hamiltonian 

\begin{equation}\label{eqn:midterm2reflection:120}
H = \inv{2} m \omega^2 \lr{x^2 + y^2} + \inv{2 m} \lr{p_x^2 + p_y^2} + a x^4 + by^6
\end{equation}

Calculate the canonical partition function, mean energy and specific heat of this system.

\makesubproblem{}{pr:midterm2reflection:2:a}
This problem can be attempted in two ways, the first of which was how I did it on the midterm, differentiating under the integral sign, leaving the integrals in exact form, but not evaluated explicitly in any way.

\makesubproblem{}{pr:midterm2reflection:2:b}
By Taylor expanding around \(c = 0\) and \(d = 0\) with those as the variables in the Taylor expansion (as now done in the Pathria 3.29 problem), we can form a solution in short order (this was the desired approach).  %Given my low midterm mark, it seems very likely that this was what was expected.

} % makeoproblem

\makeanswer{pr:midterm2reflection:2}{ 

The canonical partition function is

\begin{dmath}\label{eqn:midterm2reflection:260}
Z 
= 
\int dx dy dp_x dp_y e^{-\beta H}
=
\int dx e^{-\beta 
\lr{
\inv{2} m \omega^2 x^2 + a x^4
}
}
\int dy e^{-\beta 
\lr{
\inv{2} m \omega^2 y^2 + b y^6
}
}
\int dp_x dp_y e^{-\beta p_x^2/2 m} e^{-\beta p_y^2/2 m}.
\end{dmath}

With 

\begin{subequations}
\begin{dmath}\label{eqn:midterm2reflection:280}
u = \sqrt{\frac{\beta}{2m}} p_x
\end{dmath}
\begin{dmath}\label{eqn:midterm2reflection:300}
v = \sqrt{\frac{\beta}{2m}} p_y,
\end{dmath}
\end{subequations}

the momentum integrals are

\begin{dmath}\label{eqn:midterm2reflection:320}
\int dp_x dp_y e^{-\beta p_x^2/2 m} e^{-\beta p_y^2/2 m}
=
\frac{2m}{\beta}
\int du du e^{- u^2 - v^2}
=
\frac{m}{\beta}
2 \pi
\int 2 r dr e^{- r^2}
=
\frac{2 \pi m}{\beta}.
\end{dmath}

Writing 

\begin{subequations}
\begin{dmath}\label{eqn:midterm2reflection:340}
f(x) = \inv{2} m \omega^2 x^2 + a x^4
\end{dmath}
\begin{dmath}\label{eqn:midterm2reflection:360}
g(x) = \inv{2} m \omega^2 y^2 + b y^6,
\end{dmath}
\end{subequations}

we have

\boxedEquation{eqn:midterm2reflection:380}{
Z = 
\frac{2 \pi m}{\beta}
\int dx e^{- \beta f(x)}
\int dy e^{- \beta g(y)}.
}

\makeSubAnswer{Attempt 1: differentiation under the integral sign}{pr:midterm2reflection:2:a}
The mean energy is

\begin{dmath}\label{eqn:midterm2reflection:400}
\expectation{H} 
= \frac{\int H e^{-\beta H}}{\int e^{-\beta H}}
= -\PD{\beta}{} \ln \int e^{-\beta H}
= \PD{\beta}{} 
\lr{
\ln \beta
-\ln \int dx e^{- \beta f(x)}
-\ln \int dy e^{- \beta g(y)}
}
=
\inv{\beta} 
+ \frac{
\int dx f(x) e^{- \beta f(x)}
}
{
\int dx e^{- \beta f(x)}
}
+ \frac{
\int dy g(y) e^{- \beta g(y)}
}
{
\int dy e^{- \beta g(y)}
}.
\end{dmath}

The specific heat follows by differentiating once more
\begin{dmath}\label{eqn:midterm2reflection:420}
\CV
=
\PD{T}{\expectation{H}}
=
\PD{T}{\beta}
\PD{\beta}{\expectation{H}}
= -\inv{\kB T^2}
\PD{\beta}{\expectation{H}}
= -\kB \beta^2
\PD{\beta}{\expectation{H}}
=
- \kB \beta^2
\lr{
-\inv{\beta^2}
+ \PD{\beta}{}
\lr{
\frac{
\int dx f(x) e^{- \beta f(x)}
}
{
\int dx e^{- \beta f(x)}
}
+ \frac{
\int dy g(y) e^{- \beta g(y)}
}
{
\int dy e^{- \beta g(y)}
}
}
}.
\end{dmath}

Differentiating the integral terms we have, for example,

\begin{dmath}\label{eqn:midterm2reflection:440}
\PD{\beta}{} 
\frac{
\int dx f(x) e^{- \beta f(x)}
}
{
\int dx e^{- \beta f(x)}
}
=
-\frac{
\int dx f^2(x) e^{- \beta f(x)}
}
{
\int dx e^{- \beta f(x)}
}
+
\lr{
\frac{
\int dx f(x) e^{- \beta f(x)}
}
{
\int dx e^{- \beta f(x)}
}
}^2,
\end{dmath}

so that the specific heat is
\boxedEquation{eqn:midterm2reflection:460}{
\begin{aligned}
\CV &=
\kB 
\biglr{
1 
+ 
\frac{
\int dx f^2(x) e^{- \beta f(x)}
}
{
\int dx e^{- \beta f(x)}
} \\
&-
\lr{
\frac{
\int dx f(x) e^{- \beta f(x)}
}
{
\int dx e^{- \beta f(x)}
}
}^2
+ 
\frac{
\int dy g^2(y) e^{- \beta g(y)}
}
{
\int dy e^{- \beta g(y)}
}
-
\lr{
\frac{
\int dy g(y) e^{- \beta g(y)}
}
{
\int dy e^{- \beta g(y)}
}
}^2
}.
\end{aligned}
}

That's as far as I took this problem.  There was a discussion after the midterm with Eric about Taylor expansion of these integrals.  That's not something that I tried.

\makeSubAnswer{Attempt 2: Taylor expanding in \(c\) and \(d\)}{pr:midterm2reflection:2:b}

Performing a two variable Taylor expansion of \(Z\), about \((c, d) = (0, 0)\) we have

\begin{dmath}\label{eqn:midterm2reflection:381}
Z \approx
\frac{2 \pi m}{\beta}
\int dx dy
e^{- \beta m \omega^2 x^2/2}
e^{- \beta m \omega^2 y^2/2}
\lr{ 1 - \beta a x^4 - \beta b y^6 }
=
\frac{2 \pi m}{\beta}
\frac{ 2 \pi}{\beta m \omega^2}
\lr{ 
1 
- \beta a \frac{3!!}{(\beta m \omega^2)^2}
- \beta b \frac{5!!}{(\beta m \omega^2)^3}
},
\end{dmath}

or

\boxedEquation{eqn:midterm2reflection:480}{
Z \approx
\frac{(2 \pi/\omega)^2}{\beta^2}
\lr{ 
1 
- \frac{3 a }{\beta (m \omega^2)^2}
- \frac{15 b }{\beta^2 (m \omega^2)^3}
}.
}

Now we can calculate the average energy

\begin{dmath}\label{eqn:midterm2reflection:500}
\expectation{H} 
= 
- \PD{\beta}{}
\ln Z
= 
- \PD{\beta}{}
\lr{
   -2 \ln \beta + \ln
   \lr{ 
      1 
      - \frac{3 a }{\beta (m \omega^2)^2}
      - \frac{15 b }{\beta^2 (m \omega^2)^3}
   }
}
=
\frac{2 \beta}
-
\frac{
    \frac{3 a }{\beta^2 (m \omega^2)^2}
+
    \frac{30 b }{\beta^3 (m \omega^2)^3}
}
{
   1 
   - \frac{3 a }{\beta (m \omega^2)^2}
   - \frac{15 b }{\beta^2 (m \omega^2)^3}
}.
\end{dmath}

Dropping the \(c\), \(d\) terms of the denominator above, we have

\boxedEquation{eqn:midterm2reflection:520}{
\expectation{H}
=
\frac{2 \beta}
-
    \frac{3 a }{\beta^2 (m \omega^2)^2}
-
    \frac{30 b }{\beta^3 (m \omega^2)^3}.
}

The heat capacity follows immediately

\boxedEquation{eqn:midterm2reflection:540}{
\CV 
= \PD{T}{\expectation{H}}
= 
\kB \lr{
2 - \frac{6 a \kB T}{(m \omega^2)^2} 
- \frac{90 \kB^2 T^2 b }{(m \omega^2)^3}.
}
}

} % makeanswer

%\EndArticle
