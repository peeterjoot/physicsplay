%
% Copyright © 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeproblem{Fresnel TM equations.}{emt:problemSet8:1}{
For the geometry shown in \cref{fig:ps8:ps8Fig1}, obtain the TM (E)
Fresnel reflection and transmission coefficients. Express your
results in terms of the propagation constant \( k_{1z} \) and
and \( k_{2z} \),
(i.e., the projection of
\( \Bk_1 \) and
\( \Bk_2 \)
along z-direction.) Note that the
interface is at \( z=0 \) plane.

\imageFigure{../../figures/ece1228-emt/ps8Fig1}{TM mode geometry.}{fig:ps8:ps8Fig1}{0.2}
} % makeproblem

\makeanswer{emt:problemSet8:1}{

From the figure, with \( i = \Be_3 \Be_1 \) the propagation unit vectors are
\begin{subequations}
\label{eqn:emtproblemSet8Problem1:20}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:40}
\kcap_1
= \Be_3 e^{i \theta_1}
= \Be_3 \cos\theta_1 + \Be_1 \sin\theta_1
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:60}
\kcap_1'
= -\Be_3 e^{-i \theta_1'}
= -\Be_3 \cos\theta_1' + \Be_1 \sin\theta_1'
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:80}
\kcap_2
= \Be_3 e^{i \theta_2}
= \Be_3 \cos\theta_2 + \Be_1 \sin\theta_2
\end{dmath}
\end{subequations}

Recall that Faraday's law shows that \( \Bk, \BE, \BH \) is a right handed triple.  In particular

\begin{dmath}\label{eqn:emtproblemSet8Problem1:100}
-j \omega \mu \BH
=
\spacegrad \cross \BE
=
-\BE_0 \cross \spacegrad e^{j \omega t - j \Bk \cdot \Bx}
=
-\BE_0 \cross (-j \Bk) e^{j \omega t - j \Bk \cdot \Bx}
=
j \BE \cross \Bk,
\end{dmath}

or
\begin{dmath}\label{eqn:emtproblemSet8Problem1:120}
\BH
=
\inv{-j \omega \mu} j \BE \cross \Bk
=
\inv{\omega \mu} \Bk \cross \BE.
=
\inv{\eta} \kcap \cross \BE.
\end{dmath}

This means that \( \BH_i, \BH_t \) must be directed along the \( +\Be_2 \) direction, whereas \( \BH_r \) is directed in the \( -\Be_2 \) direction.  Note that the phase of this reflected magnetic field is opposite to what might be considered a natural choice, so we should that \( r \) is negative compared to a reference that picks the opposite phase convention.

The electric field directions from the figure are

\begin{subequations}
\label{eqn:emtproblemSet8Problem1:140}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:160}
\Ecap_i
=
\kcap_1 i
= \Be_3 e^{i \theta_1} i
= \Be_1 e^{i \theta_1}
= \Be_1 \cos\theta_1 - \Be_3 \sin\theta_1
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:180}
\Ecap_r
=
\kcap_1' (-i)
= -\Be_3 e^{-i \theta_1'} (-i)
= \Be_1 e^{-i \theta_1'}
= \Be_1 \cos\theta_1' + \Be_3 \sin\theta_1'
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:200}
\Ecap_t
=
\kcap_2 i
= \Be_3 e^{i \theta_2} i
= \Be_1 e^{i \theta_2}
= \Be_1 \cos\theta_2 - \Be_3 \sin\theta_2
\end{dmath}
\end{subequations}

The boundary value conditions, with \( \ncap = \Be_3 \), are
\begin{dmath}\label{eqn:emtproblemSet8Problem1:220}
\begin{aligned}
\ncap \cross \lr{ \BH_1 - \BH_2 } &= 0 \\
\ncap \cdot \lr{ \BB_1 - \BB_2 } &= 0 \\
\ncap \cross \lr{ \BE_1 - \BE_2 } &= 0 \\
\ncap \cdot \lr{ \BD_1 - \BD_2 } &= 0,
\end{aligned}
\end{dmath}

where
\begin{subequations}
\label{eqn:emtproblemSet8Problem1:240}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:260}
\BE_1
=
E_0 \lr{ \Be_1 \cos\theta_1 - \Be_3 \sin\theta_1 } e^{-j \Bk_1 \cdot \Bx }
+
E_0 r \lr{ \Be_1 \cos\theta_1' + \Be_3 \sin\theta_1' } e^{-j \Bk_1' \cdot \Bx }
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:280}
\BE_2
=
E_0 t \lr{ \Be_1 \cos\theta_2 - \Be_3 \sin\theta_2 } e^{-j \Bk_2 \cdot \Bx }
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:300}
\BH_1
=
\Be_2 \frac{E_0}{\eta_1} e^{-j \Bk_1 \cdot \Bx }
-
\Be_2 \frac{E_0 r}{\eta_1} e^{-j \Bk_1' \cdot \Bx }
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:320}
\BH_2
=
\Be_2 \frac{E_0 t}{\eta_2} e^{-j \Bk_2 \cdot \Bx }.
\end{dmath}
\end{subequations}

The boundary value constraints can be seen to resolve to the following set of scalar equations

\begin{subequations}
\label{eqn:emtproblemSet8Problem1:340}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:360}
\frac{E_0}{\eta_1} e^{-j \Bk_1 \cdot \Bx}
-\frac{E_0 r}{\eta_1} e^{-j \Bk_1' \cdot \Bx}
=
\frac{t E_0}{\eta_2} e^{-j \Bk_2 \cdot \Bx}
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:380}
E_0 \cos\theta_1 e^{-j \Bk_1 \cdot \Bx } + E_0 r \cos\theta_1' e^{-j \Bk_1' \cdot \Bx }
=
E_0 t \cos\theta_2 e^{-j \Bk_2 \cdot \Bx }
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:400}
-\epsilon_1 E_0 \sin\theta_1 e^{-j \Bk_1 \cdot \Bx }
+
\epsilon_1 E_0 r \sin\theta_1' e^{-j \Bk_1' \cdot \Bx }
=
-\epsilon_2 E_0 t \sin\theta_2 e^{-j \Bk_2 \cdot \Bx }
\end{dmath}
\end{subequations}

where equality is required at all points \( \Bx = x \Be_1 \) along the \( z = 0 \) axis.
In order for the phase factors to cancel out, as they do at the origin, we require

\begin{equation}\label{eqn:emtproblemSet8Problem1:420}
\Bk_1 \cdot \Be_1 = \Bk_1' \cdot \Be_1 = \Bk_2 \cdot \Be_2.
\end{equation}

The \( \Bk_1, \Bk_1' \) equality is Snell's first law, a requirement that the incident angle equals the reflection angle

\begin{dmath}\label{eqn:emtproblemSet8Problem1:440}
k_1 \sin\theta_1 = k_1 \sin\theta_1'.
\end{dmath}

The remaining phase equality is Snell's second law in disguise
\begin{dmath}\label{eqn:emtproblemSet8Problem1:460}
0
= \Bk_1 \cdot \Be_1 - \Bk_2 \cdot \Be_2
= k_1 \sin\theta_1 - k_2 \sin\theta_2
= \frac{\omega}{v_1} \sin\theta_1 - \frac{\omega}{v_2} \sin\theta_2
= \frac{\omega}{c}\frac{c}{v_1} \sin\theta_1 - \frac{\omega}{c}\frac{c}{v_2} \sin\theta_2
= \frac{\omega}{c} \lr{ n_1 \sin\theta_1 - n_2 \sin\theta_2 },
\end{dmath}

or
\begin{dmath}\label{eqn:emtproblemSet8Problem1:480}
n_1 \sin\theta_1 = n_2 \sin\theta_2.
\end{dmath}

With equality of all the phase terms, we are left with

\begin{subequations}
\label{eqn:emtproblemSet8Problem1:500}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:520}
\frac{1}{\eta_1}
-\frac{r}{\eta_1}
=
\frac{t}{\eta_2}
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:540}
\cos\theta_1(1 + r)
=
t \cos\theta_2
\end{dmath}
\begin{dmath}\label{eqn:emtproblemSet8Problem1:560}
-\epsilon_1 \sin\theta_1 (1 - r)
=
-\epsilon_2 t \sin\theta_2
\end{dmath}
\end{subequations}

Since \( \epsilon \eta = \sqrt{\epsilon\mu} = n/c \), one of these is redundant since the first and last just re-express Snell's law.  That leaves two equations in two unknowns (\(r,t\))

\begin{dmath}\label{eqn:emtproblemSet8Problem1:580}
\begin{bmatrix}
r \\
t
\end{bmatrix}
=
{
\begin{bmatrix}
1 & \eta_1/\eta_2 \\
-\cos\theta_1 & \cos\theta_2
\end{bmatrix}
}^{-1}
\begin{bmatrix}
1 \\
\cos\theta_1
\end{bmatrix}
=
\inv{ \eta_1 \cos\theta_1 + \eta_2 \cos\theta_2 }
\begin{bmatrix}
\eta_2 \cos\theta_2 & -\eta_1 \\
\eta_2 \cos\theta_1 & \eta_2
\end{bmatrix}
\begin{bmatrix}
1 \\
\cos\theta_1
\end{bmatrix},
\end{dmath}

or
\begin{dmath}\label{eqn:emtproblemSet8Problem1:600}
\begin{aligned}
r &=
\frac{ \eta_2 \cos\theta_2 -\eta_1 \cos\theta_1 }
{ \eta_1 \cos\theta_1 + \eta_2 \cos\theta_2 } \\
t &=
\frac{ 2 \eta_2 \cos\theta_1 }
{ \eta_1 \cos\theta_1 + \eta_2 \cos\theta_2 }.
\end{aligned}
\end{dmath}

As expected, this reflection coefficient has a different sign, than \citep{hecht1998hecht} (4.38), where the magnetic fields were all aligned along \( +\Be_2 \).

To express this in terms of \( k_{1z}, k_{2z} \) we have to rewrite expressions of the form

\begin{dmath}\label{eqn:emtproblemSet8Problem1:620}
\eta_1 \cos\theta_1
=
\frac{\eta_1}{k_1} k_{1z}
=
\frac{\eta_1 v_1}{\omega} k_{1z}
=
\frac{k_{1z}}{\omega} \sqrt{\frac{\mu_1}{\epsilon_1}} \inv{\sqrt{\epsilon_1 \mu_1}}
=
\frac{k_{1z}}{\epsilon_1 \omega}.
\end{dmath}

This gives
\begin{dmath}\label{eqn:emtproblemSet8Problem1:640}
\begin{aligned}
r &=
\frac{  \frac{k_{2z}}{\epsilon_2} - \frac{k_{1z}}{\epsilon_1} }
{  \frac{k_{1z}}{\epsilon_1} +  \frac{k_{2z}}{\epsilon_2} } \\
t &=
\frac{ 2 \frac{\eta_2}{\eta_1}  \frac{k_{1z}}{\epsilon_1} }
{  \frac{k_{1z}}{\epsilon_1} +  \frac{k_{2z}}{\epsilon_2} },
\end{aligned}
\end{dmath}

or
\boxedEquation{eqn:emtproblemSet8Problem1:660}{
\begin{aligned}
r &=
\frac{  \epsilon_1 k_{2z} - \epsilon_2 k_{1z} }
{  \epsilon_2 k_{1z} +  \epsilon_1 k_{2z} } \\
t &=
\frac{ 2 \frac{\eta_2}{\eta_1}  \epsilon_2 k_{1z} }
{  \epsilon_2 k_{1z} +  \epsilon_1 k_{2z} }.
\end{aligned}
}

}
