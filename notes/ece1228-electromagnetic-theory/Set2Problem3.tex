%
% Copyright © 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeproblem{Gradient in cylindrical coordinates.}{emt:problemSet2:3}{
\index{gradient!cylindrical coordinates}

If gradient of a scalar function \( \psi \) rectangular coordinate system is given by

\begin{dmath}\label{eqn:emtproblemSet2Problem3:20}
\spacegrad \psi =
\xcap_1 \PD{x}{\psi}
+\ycap_2 \PD{y}{\psi}
+\zcap \PD{z}{\psi},
\end{dmath}

using coordinate transformation and chain rule show
that the gradient of \( \psi \) in cylindrical coordinates is given by

\begin{dmath}\label{eqn:emtproblemSet2Problem3:40}
\spacegrad \psi =
\rhocap \PD{\rho}{\psi}
+\phicap \inv{\rho} \PD{\phi}{\psi}
+\zcap \PD{z}{\psi}.
\end{dmath}
} % makeproblem

\makeanswer{emt:problemSet2:3}{

The components of the gradient in the cylindrical coordinate system can be factored into a product of a rotation matrix and the Cartesian components of the gradient
\index{rotation matrix}
\index{basis vectors}
\begin{dmath}\label{eqn:emtProblemSet2Problem3:60}
\begin{bmatrix}
\rhocap \cdot \spacegrad \psi \\
\phicap \cdot \spacegrad \psi \\
\zcap \cdot \spacegrad \psi \\
\end{bmatrix}
=
\begin{bmatrix}
\rhocap \cdot \lr{ \xcap \PDi{x}{\psi} +\ycap \PDi{y}{\psi} +\zcap \PDi{z}{\psi} } \\
\phicap \cdot \lr{ \xcap \PDi{x}{\psi} +\ycap \PDi{y}{\psi} +\zcap \PDi{z}{\psi} } \\
\zcap \cdot \lr{ \xcap \PDi{x}{\psi} +\ycap \PDi{y}{\psi} +\zcap \PDi{z}{\psi} } \\
\end{bmatrix}
=
\begin{bmatrix}
\rhocap \cdot \xcap & \rhocap \cdot \ycap & \rhocap \cdot \zcap \\
\phicap \cdot \xcap & \phicap \cdot \ycap & \phicap \cdot \zcap \\
\zcap \cdot \xcap & \zcap \cdot \ycap & \zcap \cdot \zcap \\
\end{bmatrix}
\begin{bmatrix}
\PDi{x}{\psi} \\
\PDi{y}{\psi} \\
\PDi{z}{\psi}
\end{bmatrix}
\end{dmath}

\index{coordinate transformation!cylindrical}
The coordinate transformation is
\begin{dmath}\label{eqn:emtProblemSet2Problem3:80}
\begin{aligned}
x &= \rho \cos\phi \\
y &= \rho \sin\phi,
\end{aligned}
\end{dmath}

where the unit vectors are
\footnote{The exponential \( \exp\lr{\xcap \ycap \phi} = \cos\phi + \xcap \ycap \sin\phi \) is Geometric Algebra notation for a (non-commutative) multivector rotation operator int the x-y plane.  The bivector \( \xcap \ycap \) squares to -1, allowing for complex number like rotations of vectors.}

\begin{dmath}\label{eqn:emtProblemSet2Problem3:100}
\begin{aligned}
\rhocap &= \xcap e^{\xcap \ycap \phi} = \xcap \cos \phi + \ycap \sin\phi \\
\phicap &= \ycap e^{\xcap \ycap \phi} = \ycap \cos \phi - \xcap \sin\phi,
\end{aligned}
\end{dmath}

so
\begin{dmath}\label{eqn:emtProblemSet2Problem3:120}
\begin{bmatrix}
\rhocap \cdot \spacegrad \psi \\
\phicap \cdot \spacegrad \psi \\
\zcap \cdot \spacegrad \psi \\
\end{bmatrix}
=
\begin{bmatrix}
\cos\phi & \sin\phi & 0 \\
- \sin\phi & \cos\phi & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
\PDi{x}{\psi} \\
\PDi{y}{\psi} \\
\PDi{z}{\psi}
\end{bmatrix}
\end{dmath}

The \( x, y \) partials on the RHS can be expanded by chain rule

\begin{dmath}\label{eqn:emtProblemSet2Problem3:140}
\begin{aligned}
\PD{x}{\psi} &= \PD{\rho}{\psi}\PD{x}{\rho} + \PD{\phi}{\psi} \PD{x}{\phi} \\
\PD{y}{\psi} &= \PD{\rho}{\psi}\PD{y}{\rho} + \PD{\phi}{\psi} \PD{y}{\phi},
\end{aligned}
\end{dmath}

or, in matrix form

\begin{dmath}\label{eqn:emtProblemSet2Problem3:160}
\begin{bmatrix}
\PDi{x}{\psi} \\
\PDi{y}{\psi} \\
\PDi{z}{\psi}
\end{bmatrix}
=
\begin{bmatrix}
\PDi{x}{\rho} & \PDi{x}{\phi} & 0 \\
\PDi{y}{\rho} & \PDi{y}{\phi} & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
\PDi{\rho}{\psi} \\
\PDi{\phi}{\psi} \\
\PDi{z}{\psi}
\end{bmatrix}.
\end{dmath}

The partials of \( \rho \) can be computed from \( \rho^2 = x^2 + y^2 \), and are

\begin{dmath}\label{eqn:emtProblemSet2Problem3:180}
\begin{aligned}
2 \rho \PD{x}{\rho} &= 2 x \\
2 \rho \PD{y}{\rho} &= 2 y,
\end{aligned}
\end{dmath}

or
\begin{dmath}\label{eqn:emtProblemSet2Problem3:200}
\begin{aligned}
\PD{x}{\rho} &= \cos\phi \\
\PD{y}{\rho} &= \sin\phi.
\end{aligned}
\end{dmath}

We can compute the partials with respect to \( \phi \) from
\begin{dmath}\label{eqn:emtProblemSet2Problem3:300}
\begin{aligned}
\cos\phi &= \frac{x}{\sqrt{x^2 + y^2}} \\
\sin\phi &= \frac{y}{\sqrt{x^2 + y^2}}.
\end{aligned}
\end{dmath}

For example

\begin{dmath}\label{eqn:emtProblemSet2Problem3:220}
-\sin \phi \PD{x}{\phi}
= \inv{\sqrt{x^2 + y^2}} + \frac{x (-1/2) 2 x}{\lr{x^2 + y^2}^{3/2}}
= \frac{x^2 + y^2 - x^2}{\lr{x^2 + y^2}^{3/2}}
= \frac{y^2}{\lr{x^2 + y^2}^{3/2}}.
= \frac{y^2}{\rho^3}
= \frac{\sin^2\phi}{\rho}
\end{dmath}

Similarly
\begin{dmath}\label{eqn:emtProblemSet2Problem3:240}
\cos \phi \PD{y}{\phi}
= \frac{x^2}{\rho^3}
= \frac{\cos^2\phi}{\rho}
\end{dmath}

In terms of \( \rho, \phi \), these are
\begin{dmath}\label{eqn:emtProblemSet2Problem3:260}
\begin{aligned}
\PD{x}{\phi} &= -\frac{\sin\phi}{\rho} \\
\PD{y}{\phi} &= \frac{\cos\phi}{\rho},
\end{aligned}
\end{dmath}

so
\begin{dmath}\label{eqn:emtProblemSet2Problem3:280}
\begin{bmatrix}
\PDi{x}{\psi} \\
\PDi{y}{\psi} \\
\PDi{z}{\psi}
\end{bmatrix}
=
\begin{bmatrix}
\cos\phi & -\sin\phi/\rho & 0 \\
\sin\phi & \cos\phi/\rho & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
\PDi{\rho}{\psi} \\
\PDi{\phi}{\psi} \\
\PDi{z}{\psi}
\end{bmatrix}.
\end{dmath}

Substitution back into \cref{eqn:emtProblemSet2Problem3:120} gives

\begin{dmath}\label{eqn:emtProblemSet2Problem3:320}
\begin{bmatrix}
\rhocap \cdot \spacegrad \psi \\
\phicap \cdot \spacegrad \psi \\
\zcap \cdot \spacegrad \psi \\
\end{bmatrix}
=
\begin{bmatrix}
\cos\phi & \sin\phi & 0 \\
- \sin\phi & \cos\phi & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
\cos\phi & -\sin\phi/\rho & 0 \\
\sin\phi & \cos\phi/\rho & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
\PDi{\rho}{\psi} \\
\PDi{\phi}{\psi} \\
\PDi{z}{\psi}
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 & 0 \\
0 & \inv{\rho} & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
\PDi{\rho}{\psi} \\
\PDi{\phi}{\psi} \\
\PDi{z}{\psi}
\end{bmatrix}
=
\begin{bmatrix}
\PDi{\rho}{\psi} \\
\inv{\rho} \PDi{\phi}{\psi} \\
\PDi{z}{\psi}
\end{bmatrix}.
\end{dmath}

Finally, the gradient can be reassembled in terms of its projections onto each of the basis vectors in the cylindrical coordinate system

\begin{dmath}\label{eqn:emtProblemSet2Problem3:340}
\spacegrad \psi
=
\rhocap (\rhocap \cdot \spacegrad \psi)
+\phicap (\phicap \cdot \spacegrad \psi)
+\zcap (\zcap \cdot \spacegrad \psi),
\end{dmath}

or
%\begin{dmath}\label{eqn:emtProblemSet2Problem3:360}
\boxedEquation{eqn:emtProblemSet2Problem3:380}{
\spacegrad \psi
=
\rhocap \PD{\rho}{\psi}
+\frac{\phicap }{\rho}\PD{\phi}{\psi}
+\zcap \PD{z}{\psi}.
}
%\end{dmath}

}
