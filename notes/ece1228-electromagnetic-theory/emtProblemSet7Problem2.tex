%
% Copyright © 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeproblem{Spherical wave solutions.}{emt:problemSet7:2}{ 
Suppose under some circumstances (e.g. \(\mathrm{TE}^r\)
or \(\mathrm{TM}^r\) modes), the partial differential equations
for the wavefunction \( \psi \)
can further be simplified to

\begin{dmath}\label{eqn:emtproblemSet7Problem2:20}
\spacegrad^2 \psi(r, \theta, \phi) = - \beta^2 \psi(r, \theta, \phi).
\end{dmath}

Using 
separation of variables

\begin{dmath}\label{eqn:emtproblemSet7Problem2:40}
\psi(r, \theta, \phi) = R(r) T(\theta) P(\phi),
\end{dmath}

find the differential equations governing the
behaviour of \( R, T, P \).  Comment on the differential equations found and their possible solutions.
\paragraph{Remarks}: To have a more uniform answer, making it easier to mark the questions, use the
following conventions (notations) in your answer. 


\begin{itemize}
\item Use \( -m^2 \) as the constant of separation for the differential equation governing \( P(\phi) \).
\item Use \( -n(n+1) \) as the constant of separation for the differential equation governing \( T(\theta) \).
\item Show that \( R(r) \) follows the differential equation associated with spherical Bessel or Hankel functions. 
\end{itemize}

} % makeproblem

\makeanswer{emt:problemSet7:2}{ 

The Laplacian in spherical coordinates is

\begin{dmath}\label{eqn:emtproblemSet7Problem2:60}
\spacegrad^2 \psi
= 
  \inv{r^2} \partial_r \lr{ r^2 \partial_r \psi } 
+ \inv{r^2 S_\theta} \partial_\theta \lr{ S_\theta \partial_\theta \psi } 
+ \inv{r^2 S_\theta^2} \partial_{\phi\phi} \psi,
\end{dmath}

where I've written \( S_\theta = \sin\theta \) for brevity.  Substituting \cref{eqn:emtproblemSet7Problem2:40} into \cref{eqn:emtproblemSet7Problem2:20} gives

\begin{dmath}\label{eqn:emtproblemSet7Problem2:80}
0 
= \spacegrad^2 \psi + \beta^2 \psi
=
  \inv{r^2} \partial_r \lr{ r^2 \partial_r (R T P) } 
+ \inv{r^2 S_\theta} \partial_\theta \lr{ S_\theta \partial_\theta (R T P) } 
+ \inv{r^2 S_\theta^2} \partial_{\phi\phi} (R T P)
+ \beta^2 (R T P)
=
  T P \inv{r^2} \lr{ r^2 R' }'
+ R P \inv{r^2 S_\theta} \lr{ S_\theta T' }'
+ R T \inv{r^2 S_\theta^2} P''
+ \beta^2 (R T P).
\end{dmath}

Here primes denote differentiation by the respective coordinates.  Multiplying by \( r^2 S_\theta^2/(R T P) \) this is

\begin{dmath}\label{eqn:emtproblemSet7Problem2:100}
0 = 
  S_\theta^2 \lr{ \inv{R} \lr{ r^2 R' }' + r^2 \beta^2 }
+ \frac{S_\theta}{ T} \lr{ S_\theta T' }'
+ \inv{P} P''.
\end{dmath}

\paragraph{Solution for the \( \phi \) dependent function.}

The last term is separable, so we can equate

\begin{dmath}\label{eqn:emtproblemSet7Problem2:120}
\inv{P} P'' = -m^2,
\end{dmath}

which has exponential (or trigonometric) solutions

%\begin{dmath}\label{eqn:emtproblemSet7Problem2:440}
\boxedEquation{eqn:emtproblemSet7Problem2:460}{
P(\phi) = a e^{j m \phi} + b e^{-j m \phi}.
}
%\end{dmath}

\paragraph{Equation for the \( \theta \) dependent function.}

Utilizing this separation constant and dividing \cref{eqn:emtproblemSet7Problem2:100} through by \( S_\theta^2 \) gives

\begin{dmath}\label{eqn:emtproblemSet7Problem2:140}
0 = 
  \inv{R} \lr{ \lr{ r^2 R' }' + r^2 \beta^2 }
+ \frac{1}{ T S_\theta^2} \lr{ S_\theta T' }' - \frac{m^2}{S_\theta^2}.
\end{dmath}

This is once again separable.  Let

\begin{dmath}\label{eqn:emtproblemSet7Problem2:160}
\frac{1}{ T S_\theta^2} \lr{ S_\theta T' }' - \frac{m^2}{S_\theta^2} = - n(n+1),
\end{dmath}

or
\begin{dmath}\label{eqn:emtproblemSet7Problem2:420}
0 = \lr{ S_\theta T' }' + \lr{ n(n+1)S_\theta^2 - m^2 } T.
\end{dmath}

Let's defer considering the nature of the solutions to this equation temporarily.

\paragraph{Solution for the \( r \) dependent function.}

The separation constant also 
fixes the radial equation.  That radial equation, after multiplication by \( R \) is

\begin{dmath}\label{eqn:emtproblemSet7Problem2:180}
0 = \lr{ r^2 R' }' + \lr{ r^2 \beta^2 - n(n+1)} R,
\end{dmath}

or
\begin{dmath}\label{eqn:emtproblemSet7Problem2:200}
0 = r^2 R'' + 2 r R' + \lr{ r^2 \beta^2 - n(n+1) } R.
\end{dmath}

After a variable substitution, \( z = r \beta \), this is

%\begin{dmath}\label{eqn:emtproblemSet7Problem2:220}
\boxedEquation{eqn:emtproblemSet7Problem2:260}{
0 = z^2 \frac{d^2 R}{dz^2} + 2 z \frac{d R}{dz} + \lr{ z^2 - n(n+1) } R,
}
%\end{dmath}

which is the differential equation solved by spherical Bessel functions \( j_n(z), y_n(z) \).  This equation can be put into the standard Bessel equation form with a multiplicative transformation.  The standard Bessel equation is

\begin{dmath}\label{eqn:emtproblemSet7Problem2:240}
0 = z^2 \frac{d^2 y}{dz^2} + z \frac{d y}{dz} + \lr{ z^2 - \alpha^2 } y,
\end{dmath}

Let \( R = q y \), so that 
\( R' = q' y + q y' \) and \( R'' = q'' y + 2 q' y' + q y'' \), let \( z^2 - n(n+1) = \mu \), and substitute these into \cref{eqn:emtproblemSet7Problem2:200}.  This gives

\begin{dmath}\label{eqn:emtproblemSet7Problem2:280}
0 
= 
z^2 \lr{ q'' y + 2 q' y' + q y'' } + 2 z \lr{ q' y + q y' } + \mu q y
=
q \lr{ 
z^2 y'' + z \frac{ 2 z q' + 2 q }{q} y' + \frac{ z^2 q'' + 2 z q' + \mu q }{q} y
}
\end{dmath}

We want
\begin{dmath}\label{eqn:emtproblemSet7Problem2:300}
2 z \frac{q'}{q} + 2 = 1,
\end{dmath}

which has solution

\begin{dmath}\label{eqn:emtproblemSet7Problem2:320}
q = z^{-1/2}.
\end{dmath}

We also have

\begin{dmath}\label{eqn:emtproblemSet7Problem2:340}
z^2 q'' /q + 2 z q'/q
= 
z^2 (-1/2)(-3/2) z^{-5/2} / z^{-1/2} + 2 z (-1/2) z^{-3/2}/z^{-1/2}
=
\frac{3}{4}
- 1
=
-\inv{4},
\end{dmath}

which gives

\begin{dmath}\label{eqn:emtproblemSet7Problem2:360}
0 
= z^2 y'' + z y' + \lr{ z^2 - n(n+1) - \frac{1}{4} } y.
\end{dmath}

Note that
\begin{dmath}\label{eqn:emtproblemSet7Problem2:380}
n(n+1) + \inv{4}
=
\inv{4} \lr{ 4 n^2 + 4 n + 1 }
=
\inv{4} \lr{ 2 n + 1 }^2
=
\lr{ n + \inv{2} }^2,
\end{dmath}

so the radial equation has the general solution

%\begin{dmath}\label{eqn:emtproblemSet7Problem2:400}
\boxedEquation{eqn:emtproblemSet7Problem2:400}{
R( r) 
= 
A \frac{Y_{n+ 1/2}(\beta r)}{\sqrt{\beta r}}
+
B \frac{J_{n+ 1/2}(\beta r)}{\sqrt{\beta r}}.
}
%\end{dmath}

\paragraph{Nature of solution for the \(\theta\) dependent equation.}

To determine the nature of the solution of the \( \theta \) dependent equation \cref{eqn:emtproblemSet7Problem2:420}, it seems natural to make a change of variables \( x = \sin\theta \).  The derivative operator becomes

\begin{dmath}\label{eqn:emtproblemSet7Problem2:480}
\frac{d}{d\theta} 
= 
\frac{dx}{d\theta} \frac{d}{dx} 
=
\cos\theta
\frac{d}{dx} 
=
\sqrt{ 1 - x^2 }
\frac{d}{dx},
\end{dmath}

so the differential equation becomes

\begin{dmath}\label{eqn:emtproblemSet7Problem2:500}
0 
= 
\frac{d}{d\theta} \lr{ x \frac{d}{d\theta} T }
+ \lr{ n(n+1) x^2 - m^2 } T
= 
\sqrt{1 - x^2} \frac{d}{dx} \lr{ x \sqrt{ 1 - x^2} \frac{d}{dx} T }
+ \lr{ n(n+1) x^2 - m^2 } T.
\end{dmath}

Note that 

\begin{dmath}\label{eqn:emtproblemSet7Problem2:520}
\frac{d}{dx} \lr{ x \sqrt{ 1 - x^2} }
=
\sqrt{ 1 - x^2} 
+ \frac{-x^2}{\sqrt{1 - x^2}}
=
\frac{1 - 2 x^2}{\sqrt{1 - x^2}},
\end{dmath}

so

\begin{dmath}\label{eqn:emtproblemSet7Problem2:540}
0 
= 
x (1-x^2) T''
+
\lr{ 1 - 2 x^2 } T' 
+ 
\lr{ n(n+1) x^2 - m^2 } T.
\end{dmath}

Digging out my old differential equations text \citep{boyce1969elementary}, I see that this equation has three regular singular points (\(x_0 \in \setlr{ 0, 1, -1 }\)), and admits a power series solution around each such point of the form

\begin{dmath}\label{eqn:emtproblemSet7Problem2:560}
T(x) = (x - x_0)^r \sum_{n=0}^\infty a_n (x - x_0)^n.
\end{dmath}

The power \( r \), called the exponent of the singularity, is determined after substitution by the lowest power term, and recurrence relations for the \( a_n \) coefficients can be determined after that.
}
