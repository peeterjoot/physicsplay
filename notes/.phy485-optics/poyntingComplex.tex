%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
% pick one:
%\input{../assignment.tex}
%\input{../blogpost.tex}
%\renewcommand{\basename}{poyntingComplex}
%\renewcommand{\dirname}{notes/blogit/}
%\newcommand{\keywords}{Poynting vector, complex, phasor, Jones vector, rotation, ellipse}
% initial create: Thu Aug 2

%\input{../peeter_prologue_print2.tex}

%\beginArtNoToc

%\generatetitle{Complex form of Poynting relationship}
%\generatetitle{Some worked problems from ``Modern Optics'', the vectorial nature of light}
\label{chap:poyntingComplex}

\makeoproblem{Average Poynting flux for complex 2D fields}{poyntingComplex:pr4}
{\citep{fowles1989introduction} problem 2.4}
{

Given a complex field phasor representation of the form

\begin{dmath}\label{eqn:poyntingComplex:10}
\tilde{\BE} = \BE_0 e^{i (\Bk \cdot \Bx - \omega t)}
\end{dmath}
\begin{dmath}\label{eqn:poyntingComplex:30}
\tilde{\BH} = \BH_0 e^{i (\Bk \cdot \Bx - \omega t)}.
\end{dmath}

Here we allow the components of \(\BE_0\) and \(\BH_0\) to be complex.  As usual our fields are defined as the real parts of the phasors

\begin{dmath}\label{eqn:poyntingComplex:50}
\BE = \Real( \tilde{\BE} )
\end{dmath}
\begin{dmath}\label{eqn:poyntingComplex:70}
\BH = \Real( \tilde{\BH} ).
\end{dmath}

Show that the average Poynting vector has the value

\begin{dmath}\label{eqn:poyntingComplex:90}
\expectation{ \BS } = \expectation{ \BE \cross \BH } = \inv{2} \Real( \BE_0 \cross \BH_0^\conj ).
\end{dmath}
} % makeoproblem

\makeanswer{poyntingComplex:pr4}{
This is a problem from \citep{fowles1989introduction}, something that I'd tried back when reading \citep{jackson1975cew} but in a way that involved Geometric Algebra and the covariant representation of the energy momentum tensor.  Let's try this with plain old complex vector algebra instead.

While the text works with two dimensional quantities in the \(x,y\) plane, I found this problem easier when tackled in three dimensions.  Suppose we write the complex phasor components as

\begin{dmath}\label{eqn:poyntingComplex:110}
\BE_0 = \sum_k (\BE_{kr} + i \BE_{ki}) \Be_k = \sum_k \Abs{\BE_k} e^{i \phi_k} \Be_k
\end{dmath}
\begin{dmath}\label{eqn:poyntingComplex:130}
\BH_0 = \sum_k (\BH_{kr} + i \BH_{ki}) \Be_k = \sum_k \Abs{\BH_k} e^{i \psi_k} \Be_k,
\end{dmath}

and also write \(\phi_k' = \phi_k + \Bk \cdot \Bx\), and \(\psi_k' = \psi_k + \Bk \cdot \Bx\), then our (real) fields are

\begin{dmath}\label{eqn:poyntingComplex:150}
\BE = \sum_k \Abs{\BE_k} \cos(\phi_k' - \omega t) \Be_k
\end{dmath}
\begin{dmath}\label{eqn:poyntingComplex:170}
\BH = \sum_k \Abs{\BH_k} \cos(\psi_k' - \omega t) \Be_k,
\end{dmath}

and our Poynting vector before averaging (in these units) is

\begin{dmath}\label{eqn:poyntingComplex:190}
\BE \cross \BH = \sum_{klm} \Abs{\BE_k}
\Abs{\BH_l}
\cos(\phi_k' - \omega t)
\cos(\psi_l' - \omega t) \epsilon_{klm} \Be_m.
\end{dmath}

We are tasked with computing the average of cosines

\begin{dmath}\label{eqn:poyntingComplex:210}
\expectation{ \cos(a - \omega t) \cos(b - \omega t) }
=
\inv{T} \int_0^T
\cos(a - \omega t) \cos(b - \omega t) dt
=
\inv{\omega T} \int_0^T
\cos(a - \omega t) \cos(b - \omega t) \omega dt
=
\inv{2 \pi} \int_0^{2 \pi}
\cos(a - u) \cos(b - u) du
=
\inv{4 \pi} \int_0^{2 \pi}
\cos(a + b - 2 u) + \cos(a - b) du
=
\inv{2} \cos(a - b).
\end{dmath}

So, our average Poynting vector is
\begin{dmath}\label{eqn:poyntingComplex:230}
\expectation{\BE \cross \BH} = \inv{2} \sum_{klm} \Abs{\BE_k}
\Abs{\BH_l}
\cos(\phi_k - \psi_l)
\epsilon_{klm} \Be_m.
\end{dmath}

We have only to compare this to the desired expression

\begin{dmath}\label{eqn:poyntingComplex:250}
\inv{2} \Real( \BE_0 \cross \BH_0^\conj )
= \inv{2}
\sum_{klm} \Real\left(
\Abs{\BE_k} e^{i\phi_k}
\Abs{\BH_l} e^{-i\psi_l}
\right)
\epsilon_{klm} \Be_m
= \inv{2}
\sum_{klm}
\Abs{\BE_k}
\Abs{\BH_l}
\cos( \phi_k - \psi_l )
\epsilon_{klm} \Be_m.
\end{dmath}

This proves the desired result.
} % makeanswer

\makeoproblem{Complex form of electric wave}
{poyntingComplex:pr5}
{\citep{fowles1989introduction} problem 2.5}
{
Show that the real electric wave

\begin{dmath}\label{eqn:poyntingComplex:270}
\BE = E_0 \left( \icap \cos( k z - \omega t ) + \jCap b \cos( k z - \omega t + \phi) \right)
\end{dmath}

is equivalent to the complex expression
\begin{dmath}\label{eqn:poyntingComplex:100}
\BE = E_0 \left( \icap + \jCap b e^{i\phi} \right) e^{i ( k z - \omega t)}.
\end{dmath}
} % makeoproblem

\makeanswer{poyntingComplex:pr5}{
This clearly follows by inspection (only stated this problem to reference in the next.)
} % makeanswer

\makeoproblem{Some polarization plots}
{poyntingComplex:pr6}
{\citep{fowles1989introduction} problem 2.6}
{

For a field specified by \eqnref{eqn:poyntingComplex:100}, sketch diagrams to show the type of polarization for the following parameters

\begin{enumerate}
\item \(\phi = 0, b = 1\)
\item \(\phi = 0, b = 2\)
\item \(\phi = \pi/2, b = -1\)
\item \(\phi = \pi/4, b = 1\)
\end{enumerate}
} % makeoproblem

\makeanswer{poyntingComplex:pr6}{

The electric fields, with \(\psi = k z - \omega t\), are

\begin{enumerate}
\item
\begin{dmath}\label{eqn:poyntingComplex:290}
\Real\left(
E_0 ( \icap + \jCap ) e^{i \psi}
\right)
=
E_0 (\icap + \jCap) \cos\psi
\end{dmath}
\item
\begin{dmath}\label{eqn:poyntingComplex:310}
\Real\left(
E_0 ( \icap + 2 \jCap ) e^{i \psi}
\right)
=
E_0 (\icap + 2 \jCap) \cos\psi
\end{dmath}
\item
\begin{dmath}\label{eqn:poyntingComplex:330}
\Real\left(
E_0 ( \icap - i \jCap ) e^{i \psi}
\right)
=
E_0
\left(
\icap \cos\psi
+\jCap \sin\psi
\right)
\end{dmath}
\item
\begin{dmath}\label{eqn:poyntingComplex:350}
\Real\left(
E_0 \left( \icap - \inv{\sqrt{2}} \jCap (1 + i) \right) e^{i \psi}
\right)
=
E_0
\left(
\icap \cos\psi
+\frac{\jCap}{\sqrt{2}}
\left(
\cos\psi
-\sin\psi
\right)
\right)
\end{dmath}
\end{enumerate}

We have linear \cref{fig:modernOptics:modernOpticsFigProblemCh2Pr6a}, linear \cref{fig:modernOptics:modernOpticsFigProblemCh2Pr6b}, circular \cref{fig:modernOptics:modernOpticsFigProblemCh2Pr6c} and elliptical \cref{fig:modernOptics:modernOpticsFigProblemCh2Pr6d} polarization respectively.

\imageFigure{../../figures/phy485/modernOpticsFigProblemCh2Pr6a}{Linear polarization at right angle}{fig:modernOptics:modernOpticsFigProblemCh2Pr6a}{0.2}
\imageFigure{../../figures/phy485/modernOpticsFigProblemCh2Pr6b}{Linear polarization at angle}{fig:modernOptics:modernOpticsFigProblemCh2Pr6b}{0.2}
\imageFigure{../../figures/phy485/modernOpticsFigProblemCh2Pr6c}{Circular polarization}{fig:modernOptics:modernOpticsFigProblemCh2Pr6c}{0.2}
\imageFigure{../../figures/phy485/modernOpticsFigProblemCh2Pr6d}{Elliptical polarization}{fig:modernOptics:modernOpticsFigProblemCh2Pr6d}{0.2}
} % makeanswer

\makeoproblem{Geometry of general Jones vector}
{poyntingComplex:pr8}
{\citep{fowles1989introduction} problem 2.8}
{
The general case is represented by the Jones vector

\begin{dmath}\label{eqn:poyntingComplex:370}
\begin{bmatrix}
A \\
B e^{i\Delta}
\end{bmatrix}.
\end{dmath}

Show that this represents elliptically polarized light in which the major axis of the ellipse makes an angle

\begin{dmath}\label{eqn:poyntingComplex:390}
\inv{2} \tan^{-1} \left( \frac{2 A B \cos \Delta }{A^2 - B^2} \right),
\end{dmath}

with the \(x\) axis.
} % makeoproblem

\makeanswer{poyntingComplex:pr8}{

Prior to attempting the problem as stated, let's explore the algebra of a parametric representation of an ellipse, rotated at an angle \(\theta\) as in \cref{fig:2dRotationOfEllipse:2dRotationOfEllipseFig2}.  The equation of the ellipse in the rotated coordinates is

\imageFigure{../../figures/phy485/2dRotationOfEllipseFig2}{Rotated ellipse}{fig:2dRotationOfEllipse:2dRotationOfEllipseFig2}{0.2}

\begin{dmath}\label{eqn:poyntingComplex:410}
\begin{bmatrix}
x' \\
y'
\end{bmatrix}
=
\begin{bmatrix}
a \cos u \\
b \sin u
\end{bmatrix},
\end{dmath}

which is easily seen to have the required form

\begin{dmath}\label{eqn:poyntingComplex:430}
\left( \frac{x'}{a} \right)^2
+\left( \frac{y'}{b} \right)^2 = 1.
\end{dmath}

We'd like to express \(x'\) and \(y'\) in the ``fixed'' frame.  Consider \cref{fig:2dRotationOfCoordinates:2dRotationOfCoordinatesFig1} where our coordinate conventions are illustrated.  With

\imageFigure{../../figures/phy485/2dRotationOfCoordinatesFig1}{2d rotation of frame}{fig:2dRotationOfCoordinates:2dRotationOfCoordinatesFig1}{0.2}

\begin{dmath}\label{eqn:poyntingComplex:450}
\begin{bmatrix}
\xcap' \\
\ycap'
\end{bmatrix}
=
\begin{bmatrix}
\xcap e^{\xcap \ycap \theta} \\
\ycap e^{\xcap \ycap \theta}
\end{bmatrix}
=
\begin{bmatrix}
\xcap \cos \theta + \ycap \sin\theta \\
\ycap \cos \theta - \xcap \sin\theta
\end{bmatrix},
\end{dmath}

and \(x \xcap + y\ycap = x' \xcap + y' \ycap\) we find

\begin{dmath}\label{eqn:poyntingComplex:470}
\begin{bmatrix}
x' \\
y'
\end{bmatrix}
=
\begin{bmatrix}
\cos \theta & \sin\theta \\
-\sin\theta & \cos\theta
\end{bmatrix}
\begin{bmatrix}
x \\
y
\end{bmatrix},
\end{dmath}

so that the equation of the ellipse can be stated as
\begin{dmath}\label{eqn:poyntingComplex:490}
\begin{bmatrix}
\cos \theta & \sin\theta \\
-\sin\theta & \cos\theta
\end{bmatrix}
\begin{bmatrix}
x \\
y
\end{bmatrix}
=
\begin{bmatrix}
a \cos u \\
b \sin u
\end{bmatrix},
\end{dmath}

or

\begin{dmath}\label{eqn:poyntingComplex:510}
\begin{bmatrix}
x \\
y
\end{bmatrix}
=
\begin{bmatrix}
\cos \theta & -\sin\theta \\
\sin\theta & \cos\theta
\end{bmatrix}
\begin{bmatrix}
a \cos u \\
b \sin u
\end{bmatrix}
=
\begin{bmatrix}
a \cos \theta \cos u - b \sin \theta \sin u \\
a \sin \theta \cos u + b \cos \theta \sin u
\end{bmatrix}.
\end{dmath}

Observing that

\begin{dmath}\label{eqn:poyntingComplex:530}
\cos u + \alpha \sin u = \Real\left( (1 + i \alpha) e^{-i u} \right)
\end{dmath}

we have, with \(\atan2 = \atan2(x, y)\) a Jones vector representation of our rotated ellipse

\begin{dmath}\label{eqn:poyntingComplex:550}
\begin{bmatrix}
x \\
y
\end{bmatrix}
=
\Real
\begin{bmatrix}
( a \cos \theta - i b \sin\theta ) e^{-iu} \\
( a \sin \theta + i b \cos\theta ) e^{-iu}
\end{bmatrix}
=
\Real
\begin{bmatrix}
\sqrt{ a^2 \cos^2 \theta + b^2 \sin^2 \theta } e^{i \atan2(a \cos\theta, -b\sin\theta) - i u} \\
\sqrt{ a^2 \sin^2 \theta + b^2 \cos^2 \theta } e^{i \atan2(a \sin\theta, b\cos\theta) - i u}
\end{bmatrix}.
\end{dmath}

Since we can absorb a constant phase factor into our \(-iu\) argument, we can write this as

\begin{dmath}\label{eqn:poyntingComplex:570}
\begin{bmatrix}
x \\
y
\end{bmatrix}
=
\Real
\left(
\begin{bmatrix}
\sqrt{ a^2 \cos^2 \theta + b^2 \sin^2 \theta }  \\
\sqrt{ a^2 \sin^2 \theta + b^2 \cos^2 \theta } e^{i \atan2(a \sin\theta, b\cos\theta) -i \atan2(a \cos\theta, -b\sin\theta)}
\end{bmatrix} e^{-i u'}
\right).
\end{dmath}

This has the required form once we make the identifications

\begin{dmath}\label{eqn:poyntingComplex:590}
A = \sqrt{ a^2 \cos^2 \theta + b^2 \sin^2 \theta }
\end{dmath}
\begin{dmath}\label{eqn:poyntingComplex:610}
B = \sqrt{ a^2 \sin^2 \theta + b^2 \cos^2 \theta }
\end{dmath}
\begin{dmath}\label{eqn:poyntingComplex:630}
\Delta =
\atan2(a \sin\theta, b\cos\theta) - \atan2(a \cos\theta, -b\sin\theta).
\end{dmath}

What isn't obvious is that we can do this for any \(A\), \(B\), and \(\Delta\).  Portions of this problem I tried in \nbref{ellipticalPolarizationRotationToStdForm.cdf} starting from the elliptic equation derived in \S 8.1.3 of \citep{hecht1998hecht}.  I'd used Mathematica since on paper I found the rotation angle that eliminated the cross terms to always be 45 degrees, but this turns out to have been because I'd first used a change of variables that scaled the equation.  Here's the whole procedure without any such scaling to arrive at the desired result for this problem.  Our starting point is the Jones specified field, again as above I've using \(-iu = i (k z - \omega t)\)

\begin{dmath}\label{eqn:poyntingComplex:650}
\BE =
\Real\left(
\begin{bmatrix}
A \\
B e^{i \Delta}
\end{bmatrix}
e^{-i u}
\right)
=
\begin{bmatrix}
A \cos u \\
B \cos ( \Delta - u )
\end{bmatrix}
e^{-i u}
\end{dmath}

We need our cosine angle addition formula

\begin{dmath}\label{eqn:poyntingComplex:670}
\cos( a + b ) = \Real \left(
(\cos a + i \sin a)
(\cos b + i \sin b)
\right)
=
\cos a \cos b - \sin a \sin b.
\end{dmath}

Using this and writing \(\BE = (x, y)\) we have

\begin{dmath}\label{eqn:poyntingComplex:690}
x = A \cos u
\end{dmath}
\begin{dmath}\label{eqn:poyntingComplex:710}
y = B ( \cos \Delta \cos u + \sin \Delta \sin u ).
\end{dmath}

Subtracting \(x \cos \Delta/A\) from \(y/B\) we have

\begin{dmath}\label{eqn:poyntingComplex:730}
\frac{y}{B} - \frac{x}{A} \cos \Delta = \sin \Delta \sin u.
\end{dmath}

Squaring this and using \(\sin^2 u = 1 - \cos^2 u\), and \eqnref{eqn:poyntingComplex:690} we have

\begin{dmath}\label{eqn:poyntingComplex:750}
\left( \frac{y}{B} - \frac{x}{A} \cos \Delta \right)^2 = \sin^2 \Delta \left( 1 - \frac{x^2}{A^2} \right),
\end{dmath}

which expands and simplifies to

\begin{dmath}\label{eqn:poyntingComplex:770}
\left( \frac{x}{A} \right)^2
+\left( \frac{y}{B} \right)^2
- 2
\left( \frac{x}{A} \right)
\left( \frac{y}{B} \right)
\cos \Delta = \sin^2 \Delta,
\end{dmath}

which is an equation of a rotated ellipse as desired.  Let's figure out the angle of rotation required to kill the cross terms.  Writing \(a = 1/A\), \(b = 1/B\) and rotating our primed coordinate frame by \(\theta\) degrees

\begin{dmath}\label{eqn:poyntingComplex:470b}
\begin{bmatrix}
x \\
y
\end{bmatrix}
=
\begin{bmatrix}
\cos \theta & -\sin\theta \\
\sin\theta & \cos\theta
\end{bmatrix}
\begin{bmatrix}
x' \\
y'
\end{bmatrix},
\end{dmath}

we have

\begin{dmath}\label{eqn:poyntingComplex:790}
\sin^2 \Delta =
a^2 (x' \cos \theta - y'\sin\theta)^2
+
b^2 ( x' \sin\theta + y' \cos\theta)^2
- 2 a b
(x' \cos \theta - y'\sin\theta)
( x'\sin\theta + y'\cos\theta)
\cos \Delta
=
(x')^2 ( a^2 \cos^2 \theta + b^2 \sin^2 \theta - 2 a b \cos \theta \sin \theta \cos \Delta )
+(y')^2 ( a^2 \sin^2 \theta + b^2 \cos^2 \theta + 2 a b \cos \theta \sin \theta \cos \Delta )
+ 2 x' y' ( (b^2 -a^2) \cos \theta \sin\theta + a b (\sin^2 \theta - \cos^2 \theta) \cos \Delta ).
\end{dmath}

To kill off the cross term we require
\begin{dmath}\label{eqn:poyntingComplex:810}
0 =
(b^2 -a^2) \cos \theta \sin\theta + a b (\sin^2 \theta - \cos^2 \theta) \cos \Delta
=
\inv{2} (b^2 -a^2) \sin (2 \theta) - a b \cos (2 \theta) \cos \Delta,
\end{dmath}

or
\begin{dmath}\label{eqn:poyntingComplex:830}
\tan (2 \theta) = \frac{2 a b \cos \Delta}{b^2 - a^2} =
\frac{2 A B \cos \Delta}{A^2 - B^2}.
\end{dmath}

This yields \eqnref{eqn:poyntingComplex:390} as desired.  We also end up with expressions for our major and minor axis lengths, which are respectively for \(\sin \Delta \ne 0\)

\begin{dmath}\label{eqn:poyntingComplex:850}
\sin\Delta/
\sqrt{ b^2 + (a^2 - b^2) \cos^2 \theta - a b \sin (2 \theta) \cos \Delta }
\end{dmath}
\begin{dmath}\label{eqn:poyntingComplex:870}
\sin\Delta/
\sqrt{ b^2 + (a^2 - b^2)\sin^2 \theta + a b \sin (2 \theta) \cos \Delta },
\end{dmath}

which completes the task of determining the geometry of the elliptic parameterization we see results from the general Jones vector description.
} % makeanswer

%\vcsinfo
%\EndArticle
