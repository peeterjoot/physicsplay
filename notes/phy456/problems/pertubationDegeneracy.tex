%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%\usepackage{easybmat}
\label{chap:pertubationDegeneracy}

%\blogpage{http://sites.google.com/site/peeterjoot/math2011/pertubationDegeneracy.pdf}
%\date{Nov 7, 2011}

\section{Motivation}

In class it was mentioned that to deal with perturbation around a degenerate energy eigenvalue, we needed to diagonalize the perturbing Hamiltonian.  I did not follow those arguments completely, and I had like to revisit those here.

\section{A four state Hamiltonian}

Problem set 3, problem 1, was to calculate the energy eigenvalues for the following Hamiltonian

\begin{equation}\label{eqn:pertubationDegeneracy:10}
\begin{aligned}
H &= H_0 + \lambda H' \\
H_0 &=
\begin{bmatrix}
a & 0 & 0 & 0 \\
0 & b & 0 & 0 \\
0 & 0 & c & 0 \\
0 & 0 & 0 & c 
\end{bmatrix} \\
H' &=
\begin{bmatrix}
\alpha 		& 0 		& \nu 		& \eta \\
0 		& \beta 	& 0 		& \mu \\
\nu^\conj 	& 0 		& \gamma 	& 0 \\
\eta^\conj 	& \mu^\conj 	& 0 		& \delta
\end{bmatrix}
\end{aligned}
\end{equation}

This is more complicated that the two state problem that are solved exactly in \S 13.1.1 in the text \citep{desai2009quantum}, but differs from the (possibly) infinite dimensional problem that was covered in class.  Unfortunately, the solution provided to this problem did not provide the illumination I expected, so let us do it again, calculating the perturbed energy eigenvalues for the degenerate levels, from scratch.

Can we follow the approach used in the text for the two (only) state problem.  For the two state problem, it was assumed that the perturbed solution could be expressed as a superposition of the two states that formed the basis for the unperturbed Hilbert space.  That is

\begin{equation}\label{eqn:pertubationDegeneracy:30}
\ket{\psi} = m \ket{1} + n \ket{2}
\end{equation}

For the two state problem, assuming that the perturbed energy eigenvalue is \(E\), and the unperturbed energy eigenvalue is \(E^0\) we find

\begin{equation}\label{eqn:pertubationDegeneracy:510}
\begin{aligned}
0 
&= (H - E) \ket{\psi} \\
&= (H_0 + \lambda H') \ket{\psi} - E \ket{\psi} \\
&= 
(H_0 + \lambda H') 
(m \ket{1} + n \ket{2})
-E 
(m \ket{1} + n \ket{2})
\\
&=
\lambda H' (m \ket{1} + n \ket{2}) 
-E^0 
(m \ket{1} + n \ket{2}) \\
&=
(-E^0 + \lambda H')
\begin{bmatrix}
\ket{1} & \ket{2} 
\end{bmatrix}
\begin{bmatrix}
m \\
n
\end{bmatrix}
\end{aligned}
\end{equation}

Left multiplying by the brakets we find

\begin{equation}\label{eqn:pertubationDegeneracy:530}
\begin{aligned}
0 &= 
\begin{bmatrix}
\bra{1} \\
\bra{2} 
\end{bmatrix}
(H - E)\ket{\psi} \\
&=
\left(
(E^0 - E)I + \lambda
\begin{bmatrix}
\bra{1} H' \ket{1} & \bra{1} H' \ket{2} \\
\bra{2} H' \ket{1} & \bra{2} H' \ket{2} 
\end{bmatrix}
\right)
\begin{bmatrix}
m \\
n
\end{bmatrix}
\end{aligned}
\end{equation}

Or

\begin{equation}\label{eqn:pertubationDegeneracy:50}
\left( (E^0 - E)I + \lambda \begin{bmatrix} H_{ij}' \end{bmatrix} \right)
\begin{bmatrix}
m \\
n
\end{bmatrix}
= 0.
\end{equation}

Observe that there was no assumption about the dimensionality of \(H_0\) and \(H'\) here, just that the two degenerate energy levels had eigenvalues \(E^0\) and a pair of eigenkets \(\ket{1}\) and \(\ket{2}\) such that \(H_0 \ket{i} = E^0 \ket{i}, i \in [1,2]\).  It is clear that we can use a similar argument for any degeneracy degree.  It is also clear how to proceed, since we have what almost amounts to a characteristic equation for the degenerate subspace of Hilbert space for the problem.

Because \(H'\) is Hermitian, a diagonalization

\begin{equation}\label{eqn:pertubationDegeneracy:70}
\begin{aligned}
H' &= U^\conj D U \\
D &= 
\begin{bmatrix}
{\mathcal{H}'}_i \delta_{ij}
\end{bmatrix} 
\end{aligned}
\end{equation}

can be found.  To solve for \(E\) we can take the determinant of the matrix factor of \eqnref{eqn:pertubationDegeneracy:50}, and because \(I = U^\conj U\) we have

\begin{equation}\label{eqn:pertubationDegeneracy:550}
\begin{aligned}
0 &=
\begin{vmatrix}
(E^0 -E) U^\conj I U + \lambda U^\conj D U 
\end{vmatrix} \\
&=
\begin{vmatrix}
U^\conj
\end{vmatrix}
\begin{vmatrix}
(E^0 -E)I + \lambda D 
\end{vmatrix}
\begin{vmatrix}
U
\end{vmatrix} \\
&=
\begin{vmatrix}
E^0 -E + \lambda {\mathcal{H}'}_1 & 0 \\
0 & E^0 -E + \lambda {\mathcal{H}'}_2
\end{vmatrix} \\
&=
(E^0 -E + \lambda {\mathcal{H}'}_1)(E^0 -E + \lambda {\mathcal{H}'}_2)
\end{aligned}
\end{equation}

So our energy eigenvalues associated with the perturbed state are (exactly) 

\begin{equation}\label{eqn:pertubationDegeneracy:90}
E = E^0 + \lambda {\mathcal{H}'}_1, E^0 + \lambda {\mathcal{H}'}_2.
\end{equation}

It is a bit curious seeming that only the energy eigenvalues associated with the degeneracy play any part in this result, but there is some intuitive comfort in this idea.  Without the perturbation, we can not do an energy measurement that would distinguish one or the other of the eigenkets for the degenerate energy level, so it does not seem unreasonable that a perturbed energy level close to the original can be formed by superposition of these two states, and thus the perturbed energy eigenvalue for the new system would then be related to only those degenerate levels.

Observe that in the problem set three problem we had a diagonal initial Hamiltonian \(H_0\), that does not have an impact on the argument above, since that portion of the Hamiltonian only has a diagonal contribution to the result found in \eqnref{eqn:pertubationDegeneracy:50}, since the identity \(H_0 \ket{i} = c \ket{i}, i \in [3,4]\) removes any requirement to know the specifics of that portion of the matrix element of \(H_0\).

\section{Generalizing slightly}

Let us work with a system that has kets using an explicit degeneracy index

\begin{equation}\label{eqn:pertubationDegeneracy:110}
H_0 \ket{m \alpha_m} = E_m^0 \ket{m \alpha_m}, \qquad \alpha_m = 1, \cdots, \gamma_m, m \in [1, N]
\end{equation}

\paragraph{Example:}

\begin{equation}\label{eqn:pertubationDegeneracy:130}
\begin{aligned}
\ket{m \alpha_m} \in 
&\ket{11} \\
&\ket{21}, \ket{22} \\
&\ket{31} \\
&\ket{41}, \ket{42}, \ket{43}.
\end{aligned}
\end{equation}

Again we seek to find the energy eigenvalues of the new system

\begin{equation}\label{eqn:pertubationDegeneracy:150}
H = H_0 + \lambda H'.
\end{equation}

For any \(m\) with associated with a degeneracy (\(\gamma_m > 1\)) we can calculate the subspace diagonalization

\begin{equation}\label{eqn:pertubationDegeneracy:170}
\begin{bmatrix}
\bra{m i} H' \ket{m j}
\end{bmatrix}
= U_m D_m U_m^\dagger,
\end{equation}

where

\begin{equation}\label{eqn:pertubationDegeneracy:190}
U_m U_m^\dagger = 1,
\end{equation}

and \(D_m\) is diagonal

\begin{equation}\label{eqn:pertubationDegeneracy:210}
D_m = 
\begin{bmatrix}
\delta_{ij} \mathcal{H}_{m,i}'
\end{bmatrix}.
\end{equation}

This is not a diagonalizing transformation in the usual sense.  Putting it together into block matrix form, we can write

\begin{equation}\label{eqn:pertubationDegeneracy:230}
U = 
\begin{bmatrix}
U_1 &   	&  	 & \\
    & U_2 	&  	 & \\
    &     	& \ddots & \\
    &     	&        & U_N \\
\end{bmatrix}
\end{equation}

and find that a similarity transformation using this change of basis matrix puts all the block matrices along the diagonal into diagonal form, but leaves the rest possibly non-zero

\begin{equation}\label{eqn:pertubationDegeneracy:250}
U^\dagger
\begin{bmatrix}
\bra{m \alpha_{m_i}} H' \ket{m j} \ket{m \alpha_{m_j}}
\end{bmatrix}
U
=
\begin{bmatrix}
D_1 & x 	& x	 & x \\
 x  & D_2 	& x	 & x \\
 x  & x   	& \ddots & x \\
 x  & x   	& x      & D_N \\
\end{bmatrix}
\end{equation}

\paragraph{A five level system with two pairs of degenerate levels}

Let us do this explicitly using a specific degeneracy example, supposing that we have a non-degenerate ground state, and two pairs doubly degenerate next energy levels.  That is

\begin{equation}\label{eqn:pertubationDegeneracy:270}
\begin{aligned}
\ket{m \alpha_m} \in 
&\ket{11} \\
&\ket{21}, \ket{22} \\
&\ket{31}, \ket{32} 
\end{aligned}
\end{equation}

Our change of basis matrix is
\begin{equation}\label{eqn:pertubationDegeneracy:290}
U = 
\left[
\begin{BMAT}(rc){c:c:c}{c:c:c}
1 & 
\begin{BMAT}(rc){cc}{c}
0 & 0
\end{BMAT}
&
\begin{BMAT}(rc){cc}{c}
0 & 0
\end{BMAT} \\
\begin{BMAT}(rc){c}{cc}
0 \\
0
\end{BMAT} 
& U_2
&
\begin{BMAT}(rc){cc}{cc}
0 & 0 \\
0 & 0
\end{BMAT} \\
\begin{BMAT}(rc){c}{cc}
0 \\
0
\end{BMAT}
&
\begin{BMAT}(rc){cc}{cc}
0 & 0 \\
0 & 0
\end{BMAT} 
&
U_3
\end{BMAT} 
\right]
\end{equation}

We would like to calculate

\begin{equation}\label{eqn:pertubationDegeneracy:310}
U^\dagger H' U
\end{equation}

Let us write this putting row and column range subscripts on our matrices to explicitly block them into multiplication compatible sized pieces

\begin{equation}\label{eqn:pertubationDegeneracy:330}
\begin{aligned}
U &= 
\begin{bmatrix}
I_{11,11} & 0_{11, 23} & 0_{11,45} \\
0_{23,11} & U_{23, 23} & 0_{23,45} \\
0_{45,11} & 0_{45, 23} & U_{45,45} 
\end{bmatrix} \\
H' &= 
\begin{bmatrix}
{H'}_{11,11} & {H'}_{11, 23} & {H'}_{11,45} \\
{H'}_{23,11} & {H'}_{23, 23} & {H'}_{23,45} \\
{H'}_{45,11} & {H'}_{45, 23} & {H'}_{45,45} 
\end{bmatrix} \\
\end{aligned}
\end{equation}

The change of basis calculation then becomes
\begin{equation}\label{eqn:pertubationDegeneracy:570}
\begin{aligned}
U^\dagger H' U
&=
\begin{bmatrix}
I_{11,11} & 0_{11, 23} & 0_{11,45} \\
0_{23,11} & U_{23, 23}^\dagger & 0_{23,45} \\
0_{45,11} & 0_{45, 23} & U_{45,45}^\dagger
\end{bmatrix}
\begin{bmatrix}
{H'}_{11,11} & {H'}_{11, 23} & {H'}_{11,45} \\
{H'}_{23,11} & {H'}_{23, 23} & {H'}_{23,45} \\
{H'}_{45,11} & {H'}_{45, 23} & {H'}_{45,45} 
\end{bmatrix} 
\begin{bmatrix}
I_{11,11} & 0_{11, 23} & 0_{11,45} \\
0_{23,11} & U_{23, 23} & 0_{23,45} \\
0_{45,11} & 0_{45, 23} & U_{45,45} 
\end{bmatrix} \\
&=
\begin{bmatrix}
I_{11,11} & 0_{11, 23} & 0_{11,45} \\
0_{23,11} & U_{23, 23}^\dagger & 0_{23,45} \\
0_{45,11} & 0_{45, 23} & U_{45,45}^\dagger
\end{bmatrix}
\begin{bmatrix}
{H'}_{11,11} & {H'}_{11, 23} U_{23, 23} & {H'}_{11,45} U_{45, 45} \\
{H'}_{23,11} & {H'}_{23, 23} U_{23, 23} & {H'}_{23,45} U_{45, 45} \\
{H'}_{45,11} & {H'}_{45, 23} U_{23, 23} & {H'}_{45,45} U_{45, 45} 
\end{bmatrix} \\
&=
\begin{bmatrix}
\myBoxed{{H'}_{11,11}} & {H'}_{11, 23} U_{23, 23} & {H'}_{11,45} U_{45, 45} \\
U_{23, 23}^\dagger {H'}_{23,11} & \myBoxed{U_{23, 23}^\dagger {H'}_{23, 23} U_{23, 23}} & U_{23, 23}^\dagger {H'}_{23,45} U_{45, 45} \\
U_{45, 45}^\dagger {H'}_{45,11} & U_{45, 45}^\dagger {H'}_{45, 23} U_{23, 23} & \myBoxed{U_{45, 45}^\dagger {H'}_{45,45} U_{45, 45} }
\end{bmatrix} 
\end{aligned}
\end{equation}

We see that we end up with explicitly diagonal matrices along the diagonal blocks, but products that are otherwise everywhere else.

In the new basis our kets become

\begin{equation}\label{eqn:pertubationDegeneracy:350}
\ket{m \alpha_m'} = U^\dagger \ket{m \alpha_m}
\end{equation}

Suppose we calculate this change of basis representation for \(\ket{21}\) (we have implicitly assumed above that our original basis had the ordering \(\{ \ket{11} \ket{21}, \ket{22}, \ket{31}, \ket{32} \}\)).  We find

\begin{equation}\label{eqn:pertubationDegeneracy:590}
\begin{aligned}
\ket{21'} 
&= U^\conj \ket{21} \\
&=
\begin{bmatrix}
1 & 0 & 0 \\
0 & U_2^\conj & 0 \\
0 & 0 & U_3^\conj 
\end{bmatrix}
\left[
\begin{BMAT}(rc){c}{c:cc:cc}
0 \\
1 \\
0 \\
0 \\
0 \\
\end{BMAT}
\right]
\end{aligned}
\end{equation}

With 
\begin{equation}\label{eqn:pertubationDegeneracy:370}
\begin{aligned}
U_2
&=
\begin{bmatrix}
U_{2,11} & U_{2,12} \\
U_{2,21} & U_{2,22}
\end{bmatrix} \\
U_2^\dagger 
&=
\begin{bmatrix}
U_{2,11}^\conj & U_{2,21}^\conj \\
U_{2,12}^\conj & U_{2,22}^\conj
\end{bmatrix}
\end{aligned}
\end{equation}

We find
\begin{equation}\label{eqn:pertubationDegeneracy:390}
\begin{aligned}
\ket{21'} 
&= U^\conj \ket{21'} \\
&=
\begin{bmatrix}
0 \\
U_{2,11}^\conj  \\
U_{2,12}^\conj  \\
0  \\
0
\end{bmatrix}
&=
U_{2,11}^\conj \ket{21} + 
U_{2,12}^\conj \ket{22}
\end{aligned}
\end{equation}

\paragraph{Energy eigenvalues of the unperturbed Hamiltonian in the new basis}

Generalizing this, it is clear that for a given degeneracy level, the transformed kets in the new basis are superposition of only the kets associated with that degenerate level (and the kets for the non-degenerate levels are left as is).

Even better, we have for all \(\ket{m \alpha_m'} = U^\dagger \ket{m \alpha_m}\) that \(\ket{m \alpha_m'}\) remain eigenkets of the unperturbed Hamiltonian.  We see that by computing the matrix element of our Hamiltonian in the full basis.

Writing

\begin{equation}\label{eqn:pertubationDegeneracy:410}
F = U^\dagger H' U,
\end{equation}

or
\begin{equation}\label{eqn:pertubationDegeneracy:430}
H' = U F U^\dagger,
\end{equation}

where \(F\) has been shown to have diagonal block diagonals, we can write

\begin{equation}\label{eqn:pertubationDegeneracy:610}
\begin{aligned}
H 
&= H_0 + \lambda U F U^\dagger \\
&= U U^\dagger H_0 U U^\dagger + \lambda U F U^\dagger \\
&= U \Bigl( U^\dagger H_0 U + \lambda F \Bigr) U^\dagger 
\end{aligned}
\end{equation}

So in the \(\ket{m \alpha_m'}\) basis, our Hamiltonian's matrix element is

\begin{equation}\label{eqn:pertubationDegeneracy:470}
H \rightarrow U^\dagger H_0 U + \lambda F 
\end{equation}

When \(\lambda = 0\), application of this Hamiltonian to the new basis kets gives

\begin{equation}\label{eqn:pertubationDegeneracy:630}
\begin{aligned}
H_0 
\ket{m \alpha'} 
&=
U^\dagger H_0 U 
U^\dagger
\ket{m \alpha}  \\
&=
U^\dagger H_0
\ket{m \alpha}  \\
&=
U^\dagger \mathcal{H}_m^0
\ket{m \alpha}  \\
&=
\mathcal{H}_m^0
\left(
U^\dagger 
\ket{m \alpha}\right)  \\
\end{aligned}
\end{equation}

But this is just

\begin{equation}\label{eqn:pertubationDegeneracy:490}
H_0 \ket{m \alpha'} = \mathcal{H}_m^0 \ket{m \alpha'},
\end{equation}

a statement that the \(\ket{m \alpha'}\) are still the energy eigenkets for the unperturbed system.  This matches our expectations since we have seen that these differ from the original basis elements only for degenerate energy levels, and that these new basis elements are superpositions of only the kets for their respective degeneracy levels.

%\section{Repeating the perturbation argument using this diagonal block diagonalizing basis}
%

